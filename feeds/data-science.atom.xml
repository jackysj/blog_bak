<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom"><title>Jacky MSC - Data Science</title><link href="//jacky-sj/" rel="alternate"></link><link href="//jacky-sj/feeds/data-science.atom.xml" rel="self"></link><id>//jacky-sj/</id><updated>2017-03-29T20:30:00+08:00</updated><entry><title>数据科学20：文本挖掘2</title><link href="//jacky-sj/text-mining-2.html" rel="alternate"></link><published>2014-06-26T15:02:00+08:00</published><updated>2017-03-29T20:30:00+08:00</updated><author><name>Jacky Gong</name></author><id>tag:jacky-sj,2014-06-26:/text-mining-2.html</id><summary type="html">&lt;p&gt;文本挖掘简介 2&lt;/p&gt;</summary><content type="html">&lt;p&gt;&lt;em&gt;“文章原创，转载请注明出处”&lt;/em&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;h2&gt;一、对词条-文档矩阵的操作&lt;/h2&gt;
&lt;hr&gt;
&lt;p&gt;在'tm'包中，提供了一些常用的函数，可以对得到的Document Term
Matrix进行一些操作。当然，我们也可以使用自己的方式，对该矩阵进行一些探索，比如，我们先来看看词条的频数：&lt;/p&gt;
&lt;h3&gt;1.1 词条频数&lt;/h3&gt;
&lt;hr&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="code-line"&gt;&lt;span&gt;&lt;/span&gt;freq &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="kp"&gt;colSums&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kp"&gt;as.matrix&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;dtm&lt;span class="p"&gt;))&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;span class="kp"&gt;length&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;freq&lt;span class="p"&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;span class="c1"&gt;## [1] 780&lt;/span&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;如果我们想看看，哪些频数是大于等于30的，我们可以：&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="code-line"&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kp"&gt;names&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;freq&lt;span class="p"&gt;[&lt;/span&gt;freq &lt;span class="o"&gt;&amp;gt;=&lt;/span&gt; &lt;span class="m"&gt;30&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;span class="c1"&gt;## [1] &amp;quot;market&amp;quot; &amp;quot;mln&amp;quot;    &amp;quot;oil&amp;quot;    &amp;quot;opec&amp;quot;   &amp;quot;price&amp;quot;  &amp;quot;said&amp;quot;&lt;/span&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;但其实，在'tm'包中有自带的函数可以解决：&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="code-line"&gt;&lt;span&gt;&lt;/span&gt;findFreqTerms&lt;span class="p"&gt;(&lt;/span&gt;dtm&lt;span class="p"&gt;,&lt;/span&gt; lowfreq &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="m"&gt;30&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;span class="c1"&gt;## [1] &amp;quot;market&amp;quot; &amp;quot;mln&amp;quot;    &amp;quot;oil&amp;quot;    &amp;quot;opec&amp;quot;   &amp;quot;price&amp;quot;  &amp;quot;said&amp;quot;&lt;/span&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;如果得到了每个词条的频数，我们可以列一个表查看一些其它的东西：&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="code-line"&gt;&lt;span&gt;&lt;/span&gt;ord &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="kp"&gt;order&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;freq&lt;span class="p"&gt;,&lt;/span&gt; decreasing &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kc"&gt;TRUE&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;span class="c1"&gt;## 查看频数排在前十的词条及其频数&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;span class="kp"&gt;head&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;freq&lt;span class="p"&gt;[&lt;/span&gt;ord&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="m"&gt;10&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;span class="c1"&gt;##    oil   said  price   opec    mln market barrel   last    bpd   dlrs&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;span class="c1"&gt;##     86     73     63     47     31     30     26     24     23     23&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;span class="c1"&gt;## 查看频数的频数&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;span class="kp"&gt;tail&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kp"&gt;table&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;freq&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="m"&gt;10&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;span class="c1"&gt;## freq&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;span class="c1"&gt;## 21 23 24 26 30 31 47 63 73 86&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;span class="c1"&gt;##  2  2  1  1  1  1  1  1  1  1&lt;/span&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;1.2 相关性&lt;/h3&gt;
&lt;hr&gt;
&lt;p&gt;除了词条的频数，我们大都还会对词条之间的相关性感兴趣。如何计算，其实很简单：&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="code-line"&gt;&lt;span&gt;&lt;/span&gt;corr &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; cor&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kp"&gt;as.matrix&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;dtm&lt;span class="p"&gt;))&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;corr&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="m"&gt;5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="m"&gt;5&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;span class="c1"&gt;##           abdul     abil      abl   abroad   accept&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;span class="c1"&gt;## abdul   1.00000 -0.08812 -0.05263 -0.05263 -0.05263&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;span class="c1"&gt;## abil   -0.08812  1.00000 -0.08812  0.79309 -0.08812&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;span class="c1"&gt;## abl    -0.05263 -0.08812  1.00000 -0.05263 -0.05263&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;span class="c1"&gt;## abroad -0.05263  0.79309 -0.05263  1.00000 -0.05263&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;span class="c1"&gt;## accept -0.05263 -0.08812 -0.05263 -0.05263  1.00000&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;span class="kp"&gt;dim&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;corr&lt;span class="p"&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;span class="c1"&gt;## [1] 780 780&lt;/span&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;比如我们想知道，与词条'oil'相关性超过0.8的词条有哪些：&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="code-line"&gt;&lt;span&gt;&lt;/span&gt;op &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="kp"&gt;options&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;span class="kp"&gt;options&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;digits &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="m"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;name &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="kp"&gt;setdiff&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kp"&gt;names&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;corr&lt;span class="p"&gt;[,&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;oil&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;corr&lt;span class="p"&gt;[,&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;oil&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="m"&gt;0.8&lt;/span&gt;&lt;span class="p"&gt;]),&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;oil&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;value &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; corr&lt;span class="p"&gt;[&lt;/span&gt;name&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;oil&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;span class="kt"&gt;matrix&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="kt"&gt;matrix&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;value&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="kp"&gt;order&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;value&lt;span class="p"&gt;,&lt;/span&gt; decreasing &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kc"&gt;TRUE&lt;/span&gt;&lt;span class="p"&gt;)])&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;span class="kp"&gt;rownames&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;matrix&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kp"&gt;names&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;value&lt;span class="p"&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;span class="kp"&gt;colnames&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;matrix&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;oil&amp;quot;&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;span class="kt"&gt;matrix&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;span class="c1"&gt;##       oil&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;span class="c1"&gt;## name 0.87&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;span class="c1"&gt;## opec 0.81&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;span class="c1"&gt;## tri  0.81&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;span class="c1"&gt;## want 0.81&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;span class="kp"&gt;options&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;op&lt;span class="p"&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;但其实，'tm'包中提供了现成函数：&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="code-line"&gt;&lt;span&gt;&lt;/span&gt;findAssocs&lt;span class="p"&gt;(&lt;/span&gt;dtm&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;oil&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="m"&gt;0.8&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;span class="c1"&gt;##       oil&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;span class="c1"&gt;## opec 0.87&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;span class="c1"&gt;## name 0.81&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;span class="c1"&gt;## tri  0.81&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;span class="c1"&gt;## want 0.81&lt;/span&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;可以看到，这一个函数实现了上面我们那一长串的功能。&lt;strong&gt;但是，我觉得，提供的现成函数有好处，但还是需要自己想想如何实现这个现成的函数。这不仅对概念理解有帮助，也对程序编写以及了解别人写的函数有更加深刻的理解。&lt;/strong&gt;&lt;/p&gt;
&lt;h3&gt;1.3 删减稀疏条目&lt;/h3&gt;
&lt;hr&gt;
&lt;p&gt;大部分时候，Document Term
Matrix是一个很大的矩阵，而且是行数远小于列数。也就是说，这个矩阵实际上是很稀疏的，不妨来看看我们这个只有20个文档的矩阵，稀疏程度如何：&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="code-line"&gt;&lt;span&gt;&lt;/span&gt;Sparse &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="kp"&gt;length&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kp"&gt;which&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;matrix&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;dtm&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;Sparse&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;span class="c1"&gt;## [1] 14030&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;Non &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="kp"&gt;length&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kp"&gt;which&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;matrix&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;dtm&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;!=&lt;/span&gt; &lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;Non&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;span class="c1"&gt;## [1] 1570&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;span class="kp"&gt;sprintf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;%d%%&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kp"&gt;round&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;Sparse&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;Non &lt;span class="o"&gt;+&lt;/span&gt; Sparse&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="m"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="m"&gt;100&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;span class="c1"&gt;## [1] &amp;quot;90%&amp;quot;&lt;/span&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;可以看到，矩阵中等于零的数目是14030，不为零的为1570，稀疏程度达到了90%，显然是非常稀疏的。当然，其实这个可以不用自己算的：&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="code-line"&gt;&lt;span&gt;&lt;/span&gt;dtm&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;span class="c1"&gt;## &amp;lt;&amp;lt;DocumentTermMatrix (documents: 20, terms: 780)&amp;gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;span class="c1"&gt;## Non-/sparse entries: 1570/14030&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;span class="c1"&gt;## Sparsity           : 90%&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;span class="c1"&gt;## Maximal term length: 13&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;span class="c1"&gt;## Weighting          : term frequency (tf)&lt;/span&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;上面的输出，前两个就知道它的意思了。那么另外两个呢？“Maximal term
length”，顾名思义，就是最长的那个词条的长度。不妨来看一下：&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="code-line"&gt;&lt;span&gt;&lt;/span&gt;name &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="kp"&gt;colnames&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kp"&gt;as.matrix&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;dtm&lt;span class="p"&gt;))&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;name.length &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="kp"&gt;sapply&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;name&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kp"&gt;nchar&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;max.name &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; name&lt;span class="p"&gt;[&lt;/span&gt;name.length &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="kp"&gt;max&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;name.length&lt;span class="p"&gt;)]&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;max.value &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; name.length&lt;span class="p"&gt;[&lt;/span&gt;max.name&lt;span class="p"&gt;]&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;max.value&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;span class="c1"&gt;## responsibilit&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;span class="c1"&gt;##            13&lt;/span&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;可以看到是吻合的。至于最后一个“Weighting”，是指Document Term
Matrix中的每一条目的值是如何计算的。这里用的是“term
frequency”，就是词条频率，简写为“tf”。除了这个，还有一些其它计算方法，比如：tf-idf，即term
frequency-inverse document frequency。这个以后再说。&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;&lt;strong&gt;回到主题：&lt;/strong&gt;计算出了稀疏条目的比例，证实了矩阵的确是很稀疏的，那么下面就是要去删除一些条目。有些条目在很少的文档中出现，甚至只在一篇文档中出现了。一般来说，删除这样的条目不会对矩阵的信息继承带来显著的影响。&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="code-line"&gt;&lt;span&gt;&lt;/span&gt;remove.sparseterms &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="kr"&gt;function&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;dtm&lt;span class="p"&gt;,&lt;/span&gt; per&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;    dtm.Matrix &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="kp"&gt;as.matrix&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;dtm&lt;span class="p"&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;    term.per &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="kp"&gt;apply&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;dtm.Matrix&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="m"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kr"&gt;function&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;item&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="kp"&gt;length&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kp"&gt;which&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;item &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="kp"&gt;length&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;item&lt;span class="p"&gt;))&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;    name &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="kp"&gt;names&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;term.per&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="kp"&gt;which&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;term.per &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; per&lt;span class="p"&gt;)])&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;    &lt;span class="kr"&gt;return&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;dtm.Matrix&lt;span class="p"&gt;[,&lt;/span&gt; name&lt;span class="p"&gt;])&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;remove.sparseterms&lt;span class="p"&gt;(&lt;/span&gt;dtm&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="m"&gt;0.4&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;span class="c1"&gt;##      Terms&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;span class="c1"&gt;## Docs  barrel oil one price reuter said&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;span class="c1"&gt;##   127      2   5   0     5      1    3&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;span class="c1"&gt;##   144      0  12   1     6      2   11&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;span class="c1"&gt;##   191      1   2   0     2      1    1&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;span class="c1"&gt;##   194      1   1   1     2      1    1&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;span class="c1"&gt;##   211      0   1   0     0      1    3&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;span class="c1"&gt;##   236      4   7   1     8      1   10&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;span class="c1"&gt;##   237      0   4   1     1      1    1&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;span class="c1"&gt;##   242      0   3   2     2      1    3&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;span class="c1"&gt;##   246      1   5   1     2      1    5&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;span class="c1"&gt;##   248      3   9   1    10      1    7&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;span class="c1"&gt;##   273      3   5   1     5      1    8&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;span class="c1"&gt;##   349      0   4   0     1      1    1&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;span class="c1"&gt;##   352      1   5   0     5      1    2&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;span class="c1"&gt;##   353      1   4   1     2      1    1&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;span class="c1"&gt;##   368      0   3   0     0      1    3&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;span class="c1"&gt;##   489      3   4   2     3      1    2&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;span class="c1"&gt;##   502      3   5   2     3      1    2&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;span class="c1"&gt;##   543      1   3   1     3      1    4&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;span class="c1"&gt;##   704      0   3   4     3      1    4&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;span class="c1"&gt;##   708      2   1   0     0      1    1&lt;/span&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;这边的计算就是：检查词条的稀疏程度是否低于给定的系数&lt;code&gt;per&lt;/code&gt;，如果是，就保留该词条；如果不是，则舍弃。&lt;/p&gt;
&lt;p&gt;当然，在'tm'包中也有自带的函数可以解决：&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="code-line"&gt;&lt;span&gt;&lt;/span&gt;rsterms &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; removeSparseTerms&lt;span class="p"&gt;(&lt;/span&gt;dtm&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="m"&gt;0.4&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;inspect&lt;span class="p"&gt;(&lt;/span&gt;rsterms&lt;span class="p"&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;span class="c1"&gt;## &amp;lt;&amp;lt;DocumentTermMatrix (documents: 20, terms: 6)&amp;gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;span class="c1"&gt;## Non-/sparse entries: 103/17&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;span class="c1"&gt;## Sparsity           : 14%&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;span class="c1"&gt;## Maximal term length: 6&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;span class="c1"&gt;## Weighting          : term frequency (tf)&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;span class="c1"&gt;##&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;span class="c1"&gt;##      Terms&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;span class="c1"&gt;## Docs  barrel oil one price reuter said&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;span class="c1"&gt;##   127      2   5   0     5      1    3&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;span class="c1"&gt;##   144      0  12   1     6      2   11&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;span class="c1"&gt;##   191      1   2   0     2      1    1&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;span class="c1"&gt;##   194      1   1   1     2      1    1&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;span class="c1"&gt;##   211      0   1   0     0      1    3&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;span class="c1"&gt;##   236      4   7   1     8      1   10&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;span class="c1"&gt;##   237      0   4   1     1      1    1&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;span class="c1"&gt;##   242      0   3   2     2      1    3&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;span class="c1"&gt;##   246      1   5   1     2      1    5&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;span class="c1"&gt;##   248      3   9   1    10      1    7&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;span class="c1"&gt;##   273      3   5   1     5      1    8&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;span class="c1"&gt;##   349      0   4   0     1      1    1&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;span class="c1"&gt;##   352      1   5   0     5      1    2&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;span class="c1"&gt;##   353      1   4   1     2      1    1&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;span class="c1"&gt;##   368      0   3   0     0      1    3&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;span class="c1"&gt;##   489      3   4   2     3      1    2&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;span class="c1"&gt;##   502      3   5   2     3      1    2&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;span class="c1"&gt;##   543      1   3   1     3      1    4&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;span class="c1"&gt;##   704      0   3   4     3      1    4&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;span class="c1"&gt;##   708      2   1   0     0      1    1&lt;/span&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;与之前的结果相同。&lt;/p&gt;
&lt;h2&gt;二、相关的绘图&lt;/h2&gt;
&lt;hr&gt;
&lt;p&gt;介绍完Document Term
Matrix之后，其实已经可以开始使用模型去处理了。之前介绍过聚类、分类啊等等的内容，有了这个矩阵之后，其实都可以去做了。不过，在建立模型之前，我想先说说有关绘图的问题。&lt;/p&gt;
&lt;p&gt;我们前面算了很多的量，比如频数啊、相关系数啊等等。但其实，我们大多时候需要用图形将它们展示出来。在R中，我们可以使用&lt;code&gt;Rgraphviz&lt;/code&gt;包来绘制词条之间的关系图：&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="code-line"&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;require&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;Rgraphviz&lt;span class="p"&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;plot&lt;span class="p"&gt;(&lt;/span&gt;dtm&lt;span class="p"&gt;,&lt;/span&gt; terms &lt;span class="o"&gt;=&lt;/span&gt; findFreqTerms&lt;span class="p"&gt;(&lt;/span&gt;dtm&lt;span class="p"&gt;,&lt;/span&gt; lowfreq &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="m"&gt;20&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;img alt="plot of chunk TM2.2.1" src="/images/article/a42/TM2.2.11.png"&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="code-line"&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;## 指定相关性必须在0.5之上才可连线&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;plot&lt;span class="p"&gt;(&lt;/span&gt;dtm&lt;span class="p"&gt;,&lt;/span&gt; terms &lt;span class="o"&gt;=&lt;/span&gt; findFreqTerms&lt;span class="p"&gt;(&lt;/span&gt;dtm&lt;span class="p"&gt;,&lt;/span&gt; lowfreq &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="m"&gt;20&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; corThreshold &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="m"&gt;0.5&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;img alt="plot of chunk TM2.2.1" src="/images/article/a42/TM2.2.12.png"&gt;&lt;/p&gt;
&lt;p&gt;在默认不指定&lt;code&gt;terms&lt;/code&gt;和&lt;code&gt;corThreshold&lt;/code&gt;参数的情况下，&lt;code&gt;plot&lt;/code&gt;函数会绘制随机20个词条，相关性至少0.7的图形。&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;当然，我们还可以绘制熟悉的频数直方图：&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="code-line"&gt;&lt;span&gt;&lt;/span&gt;freq &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="kp"&gt;sort&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kp"&gt;colSums&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kp"&gt;as.matrix&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;dtm&lt;span class="p"&gt;)),&lt;/span&gt; decreasing &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kc"&gt;TRUE&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;tf &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="kt"&gt;data.frame&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;term &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kp"&gt;names&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;freq&lt;span class="p"&gt;),&lt;/span&gt; freq &lt;span class="o"&gt;=&lt;/span&gt; freq&lt;span class="p"&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;g &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; ggplot&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kp"&gt;subset&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;tf&lt;span class="p"&gt;,&lt;/span&gt; freq &lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="m"&gt;20&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; aes&lt;span class="p"&gt;(&lt;/span&gt;term&lt;span class="p"&gt;,&lt;/span&gt; freq&lt;span class="p"&gt;))&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;g &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; g &lt;span class="o"&gt;+&lt;/span&gt; geom_bar&lt;span class="p"&gt;(&lt;/span&gt;stat &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;identity&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; aes&lt;span class="p"&gt;(&lt;/span&gt;fill &lt;span class="o"&gt;=&lt;/span&gt; freq&lt;span class="p"&gt;))&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;span class="kp"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;g&lt;span class="p"&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;img alt="plot of chunk TM2.2.2" src="/images/article/a42/TM2.2.2.png"&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;另外一个比较流行好看的图，应该就是文本云(wordcloud)了，可以使用&lt;code&gt;wordcloud&lt;/code&gt;包实现：&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="code-line"&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;require&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;wordcloud&lt;span class="p"&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;wordcloud&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kp"&gt;names&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;freq&lt;span class="p"&gt;),&lt;/span&gt; freq&lt;span class="p"&gt;,&lt;/span&gt; min.freq &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="m"&gt;5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; max.words &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="m"&gt;80&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;img alt="plot of chunk TM2.2.3" src="/images/article/a42/TM2.2.31.png"&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="code-line"&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;## 添加颜色&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;span class="kn"&gt;require&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;RColorBrewer&lt;span class="p"&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;wordcloud&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kp"&gt;names&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;freq&lt;span class="p"&gt;),&lt;/span&gt; freq&lt;span class="p"&gt;,&lt;/span&gt; min.freq &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="m"&gt;5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; max.words &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="m"&gt;80&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; colors &lt;span class="o"&gt;=&lt;/span&gt; brewer.pal&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="m"&gt;8&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;    &lt;span class="s"&gt;&amp;quot;Paired&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;img alt="plot of chunk TM2.2.3" src="/images/article/a42/TM2.2.32.png"&gt;&lt;/p&gt;
&lt;p&gt;当然，&lt;code&gt;wordcloud()&lt;/code&gt;函数提供了很多选项，可以自行查看，我就不多讲了。&lt;/p&gt;</content><category term="data science"></category><category term="r"></category><category term="machine learning"></category><category term="text mining"></category></entry><entry><title>数据科学19：文本挖掘1-更新</title><link href="//jacky-sj/text-mining-1-update.html" rel="alternate"></link><published>2014-06-25T19:21:00+08:00</published><updated>2017-03-29T20:30:00+08:00</updated><author><name>Jacky Gong</name></author><id>tag:jacky-sj,2014-06-25:/text-mining-1-update.html</id><summary type="html">&lt;p&gt;文本挖掘简介 1 - 代码重新实现&lt;/p&gt;</summary><content type="html">&lt;p&gt;&lt;em&gt;“文章原创，转载请注明出处”&lt;/em&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;前几天，R中的’tm’包从0.5-10更新到了0.6版本。其中更新了不少的东西，对于上一篇中的代码，已经是不能够正确运行了。所以这里需要先更新一下上一篇中的一些代码，正好可以回顾一些之前的流程。&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="code-line"&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;## Load Packages needed&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;span class="kn"&gt;require&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;tm&lt;span class="p"&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;span class="kn"&gt;require&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;SnowballC&lt;span class="p"&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;span class="kn"&gt;require&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;ggplot2&lt;span class="p"&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;span class="c1"&gt;## Loading Corpus 这里直接读成文本格式&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;xml.path &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="kp"&gt;system.file&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;texts&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;crude&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; package &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;tm&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;docs &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; Corpus&lt;span class="p"&gt;(&lt;/span&gt;DirSource&lt;span class="p"&gt;(&lt;/span&gt;xml.path&lt;span class="p"&gt;),&lt;/span&gt; readerControl &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kt"&gt;list&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;reader &lt;span class="o"&gt;=&lt;/span&gt; readReut21578XMLasPlain&lt;span class="p"&gt;))&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;span class="c1"&gt;## 查看&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;docs&lt;span class="p"&gt;[[&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]]&lt;/span&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="code-line"&gt;&lt;span&gt;&lt;/span&gt;## &amp;lt;&amp;lt;PlainTextDocument (metadata: 15)&amp;gt;&amp;gt;&lt;/span&gt;
&lt;span class="code-line"&gt;## Diamond Shamrock Corp said that&lt;/span&gt;
&lt;span class="code-line"&gt;## effective today it had cut its contract prices for crude oil by&lt;/span&gt;
&lt;span class="code-line"&gt;## 1.50 dlrs a barrel.&lt;/span&gt;
&lt;span class="code-line"&gt;##     The reduction brings its posted price for West Texas&lt;/span&gt;
&lt;span class="code-line"&gt;## Intermediate to 16.00 dlrs a barrel, the copany said.&lt;/span&gt;
&lt;span class="code-line"&gt;##     &amp;quot;The price reduction today was made in the light of falling&lt;/span&gt;
&lt;span class="code-line"&gt;## oil product prices and a weak crude oil market,&amp;quot; a company&lt;/span&gt;
&lt;span class="code-line"&gt;## spokeswoman said.&lt;/span&gt;
&lt;span class="code-line"&gt;##     Diamond is the latest in a line of U.S. oil companies that&lt;/span&gt;
&lt;span class="code-line"&gt;## have cut its contract, or posted, prices over the last two days&lt;/span&gt;
&lt;span class="code-line"&gt;## citing weak oil markets.&lt;/span&gt;
&lt;span class="code-line"&gt;##  Reuter&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="code-line"&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;## 去除特殊字符 上一篇中的代码已不能胜任&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;span class="c1"&gt;## 因为上一篇中的代码会修改Corpus中每个文档的class&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;span class="c1"&gt;## 所以这里需要使用一个新的函数&amp;#39;content_transformer&amp;#39;来保证class还是TextDoument&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;removeSpecialCharacter &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="kr"&gt;function&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;x&lt;span class="p"&gt;,&lt;/span&gt; pattern&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;    &lt;span class="kp"&gt;gsub&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;pattern&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;quot; &amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; x&lt;span class="p"&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;docs &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; tm_map&lt;span class="p"&gt;(&lt;/span&gt;docs&lt;span class="p"&gt;,&lt;/span&gt; content_transformer&lt;span class="p"&gt;(&lt;/span&gt;removeSpecialCharacter&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;[@/-]&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;docs&lt;span class="p"&gt;[[&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]]&lt;/span&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="code-line"&gt;&lt;span&gt;&lt;/span&gt;## &amp;lt;&amp;lt;PlainTextDocument (metadata: 15)&amp;gt;&amp;gt;&lt;/span&gt;
&lt;span class="code-line"&gt;## Diamond Shamrock Corp said that&lt;/span&gt;
&lt;span class="code-line"&gt;## effective today it had cut its contract prices for crude oil by&lt;/span&gt;
&lt;span class="code-line"&gt;## 1.50 dlrs a barrel.&lt;/span&gt;
&lt;span class="code-line"&gt;##     The reduction brings its posted price for West Texas&lt;/span&gt;
&lt;span class="code-line"&gt;## Intermediate to 16.00 dlrs a barrel, the copany said.&lt;/span&gt;
&lt;span class="code-line"&gt;##     &amp;quot;The price reduction today was made in the light of falling&lt;/span&gt;
&lt;span class="code-line"&gt;## oil product prices and a weak crude oil market,&amp;quot; a company&lt;/span&gt;
&lt;span class="code-line"&gt;## spokeswoman said.&lt;/span&gt;
&lt;span class="code-line"&gt;##     Diamond is the latest in a line of U.S. oil companies that&lt;/span&gt;
&lt;span class="code-line"&gt;## have cut its contract, or posted, prices over the last two days&lt;/span&gt;
&lt;span class="code-line"&gt;## citing weak oil markets.&lt;/span&gt;
&lt;span class="code-line"&gt;##  Reuter&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="code-line"&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;## 转换成小写字母 与上面问题类似，需要添加&amp;#39;content_transformer&amp;#39;函数&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;docs &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; tm_map&lt;span class="p"&gt;(&lt;/span&gt;docs&lt;span class="p"&gt;,&lt;/span&gt; content_transformer&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kp"&gt;tolower&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;docs&lt;span class="p"&gt;[[&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]]&lt;/span&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="code-line"&gt;&lt;span&gt;&lt;/span&gt;## &amp;lt;&amp;lt;PlainTextDocument (metadata: 15)&amp;gt;&amp;gt;&lt;/span&gt;
&lt;span class="code-line"&gt;## diamond shamrock corp said that&lt;/span&gt;
&lt;span class="code-line"&gt;## effective today it had cut its contract prices for crude oil by&lt;/span&gt;
&lt;span class="code-line"&gt;## 1.50 dlrs a barrel.&lt;/span&gt;
&lt;span class="code-line"&gt;##     the reduction brings its posted price for west texas&lt;/span&gt;
&lt;span class="code-line"&gt;## intermediate to 16.00 dlrs a barrel, the copany said.&lt;/span&gt;
&lt;span class="code-line"&gt;##     &amp;quot;the price reduction today was made in the light of falling&lt;/span&gt;
&lt;span class="code-line"&gt;## oil product prices and a weak crude oil market,&amp;quot; a company&lt;/span&gt;
&lt;span class="code-line"&gt;## spokeswoman said.&lt;/span&gt;
&lt;span class="code-line"&gt;##     diamond is the latest in a line of u.s. oil companies that&lt;/span&gt;
&lt;span class="code-line"&gt;## have cut its contract, or posted, prices over the last two days&lt;/span&gt;
&lt;span class="code-line"&gt;## citing weak oil markets.&lt;/span&gt;
&lt;span class="code-line"&gt;##  reuter&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="code-line"&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;## 去除数字&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;docs &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; tm_map&lt;span class="p"&gt;(&lt;/span&gt;docs&lt;span class="p"&gt;,&lt;/span&gt; removeNumbers&lt;span class="p"&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;docs&lt;span class="p"&gt;[[&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]]&lt;/span&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="code-line"&gt;&lt;span&gt;&lt;/span&gt;## &amp;lt;&amp;lt;PlainTextDocument (metadata: 15)&amp;gt;&amp;gt;&lt;/span&gt;
&lt;span class="code-line"&gt;## diamond shamrock corp said that&lt;/span&gt;
&lt;span class="code-line"&gt;## effective today it had cut its contract prices for crude oil by&lt;/span&gt;
&lt;span class="code-line"&gt;## . dlrs a barrel.&lt;/span&gt;
&lt;span class="code-line"&gt;##     the reduction brings its posted price for west texas&lt;/span&gt;
&lt;span class="code-line"&gt;## intermediate to . dlrs a barrel, the copany said.&lt;/span&gt;
&lt;span class="code-line"&gt;##     &amp;quot;the price reduction today was made in the light of falling&lt;/span&gt;
&lt;span class="code-line"&gt;## oil product prices and a weak crude oil market,&amp;quot; a company&lt;/span&gt;
&lt;span class="code-line"&gt;## spokeswoman said.&lt;/span&gt;
&lt;span class="code-line"&gt;##     diamond is the latest in a line of u.s. oil companies that&lt;/span&gt;
&lt;span class="code-line"&gt;## have cut its contract, or posted, prices over the last two days&lt;/span&gt;
&lt;span class="code-line"&gt;## citing weak oil markets.&lt;/span&gt;
&lt;span class="code-line"&gt;##  reuter&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="code-line"&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;## 去除停止词&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;docs &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; tm_map&lt;span class="p"&gt;(&lt;/span&gt;docs&lt;span class="p"&gt;,&lt;/span&gt; removeWords&lt;span class="p"&gt;,&lt;/span&gt; stopwords&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;english&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;docs&lt;span class="p"&gt;[[&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]]&lt;/span&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="code-line"&gt;&lt;span&gt;&lt;/span&gt;## &amp;lt;&amp;lt;PlainTextDocument (metadata: 15)&amp;gt;&amp;gt;&lt;/span&gt;
&lt;span class="code-line"&gt;## diamond shamrock corp said&lt;/span&gt;
&lt;span class="code-line"&gt;## effective today   cut  contract prices  crude oil&lt;/span&gt;
&lt;span class="code-line"&gt;## . dlrs  barrel.&lt;/span&gt;
&lt;span class="code-line"&gt;##      reduction brings  posted price  west texas&lt;/span&gt;
&lt;span class="code-line"&gt;## intermediate  . dlrs  barrel,  copany said.&lt;/span&gt;
&lt;span class="code-line"&gt;##     &amp;quot; price reduction today  made   light  falling&lt;/span&gt;
&lt;span class="code-line"&gt;## oil product prices   weak crude oil market,&amp;quot;  company&lt;/span&gt;
&lt;span class="code-line"&gt;## spokeswoman said.&lt;/span&gt;
&lt;span class="code-line"&gt;##     diamond   latest   line  u.s. oil companies&lt;/span&gt;
&lt;span class="code-line"&gt;##  cut  contract,  posted, prices   last two days&lt;/span&gt;
&lt;span class="code-line"&gt;## citing weak oil markets.&lt;/span&gt;
&lt;span class="code-line"&gt;##  reuter&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="code-line"&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;## 去除标点符号&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;docs &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; tm_map&lt;span class="p"&gt;(&lt;/span&gt;docs&lt;span class="p"&gt;,&lt;/span&gt; removePunctuation&lt;span class="p"&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;docs&lt;span class="p"&gt;[[&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]]&lt;/span&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="code-line"&gt;&lt;span&gt;&lt;/span&gt;## &amp;lt;&amp;lt;PlainTextDocument (metadata: 15)&amp;gt;&amp;gt;&lt;/span&gt;
&lt;span class="code-line"&gt;## diamond shamrock corp said&lt;/span&gt;
&lt;span class="code-line"&gt;## effective today   cut  contract prices  crude oil&lt;/span&gt;
&lt;span class="code-line"&gt;##  dlrs  barrel&lt;/span&gt;
&lt;span class="code-line"&gt;##      reduction brings  posted price  west texas&lt;/span&gt;
&lt;span class="code-line"&gt;## intermediate   dlrs  barrel  copany said&lt;/span&gt;
&lt;span class="code-line"&gt;##      price reduction today  made   light  falling&lt;/span&gt;
&lt;span class="code-line"&gt;## oil product prices   weak crude oil market  company&lt;/span&gt;
&lt;span class="code-line"&gt;## spokeswoman said&lt;/span&gt;
&lt;span class="code-line"&gt;##     diamond   latest   line  us oil companies&lt;/span&gt;
&lt;span class="code-line"&gt;##  cut  contract  posted prices   last two days&lt;/span&gt;
&lt;span class="code-line"&gt;## citing weak oil markets&lt;/span&gt;
&lt;span class="code-line"&gt;##  reuter&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="code-line"&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;## 去除多余的空格&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;docs &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; tm_map&lt;span class="p"&gt;(&lt;/span&gt;docs&lt;span class="p"&gt;,&lt;/span&gt; stripWhitespace&lt;span class="p"&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;docs&lt;span class="p"&gt;[[&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]]&lt;/span&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="code-line"&gt;&lt;span&gt;&lt;/span&gt;## &amp;lt;&amp;lt;PlainTextDocument (metadata: 15)&amp;gt;&amp;gt;&lt;/span&gt;
&lt;span class="code-line"&gt;## diamond shamrock corp said effective today cut contract prices crude oil dlrs barrel reduction brings posted price west texas intermediate dlrs barrel copany said price reduction today made light falling oil product prices weak crude oil market company spokeswoman said diamond latest line us oil companies cut contract posted prices last two days citing weak oil markets reuter&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="code-line"&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;## 词干化&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;docs &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; tm_map&lt;span class="p"&gt;(&lt;/span&gt;docs&lt;span class="p"&gt;,&lt;/span&gt; stemDocument&lt;span class="p"&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;docs&lt;span class="p"&gt;[[&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]]&lt;/span&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="code-line"&gt;&lt;span&gt;&lt;/span&gt;## &amp;lt;&amp;lt;PlainTextDocument (metadata: 15)&amp;gt;&amp;gt;&lt;/span&gt;
&lt;span class="code-line"&gt;## diamond shamrock corp said effect today cut contract price crude oil dlrs barrel reduct bring post price west texa intermedi dlrs barrel copani said price reduct today made light fall oil product price weak crude oil market compani spokeswoman said diamond latest line us oil compani cut contract post price last two day cite weak oil market reuter&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="code-line"&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;## 创建Document Term Matrix&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;dtm &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; DocumentTermMatrix&lt;span class="p"&gt;(&lt;/span&gt;docs&lt;span class="p"&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;dtm&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="code-line"&gt;&lt;span&gt;&lt;/span&gt;## &amp;lt;&amp;lt;DocumentTermMatrix (documents: 20, terms: 780)&amp;gt;&amp;gt;&lt;/span&gt;
&lt;span class="code-line"&gt;## Non-/sparse entries: 1570/14030&lt;/span&gt;
&lt;span class="code-line"&gt;## Sparsity           : 90%&lt;/span&gt;
&lt;span class="code-line"&gt;## Maximal term length: 13&lt;/span&gt;
&lt;span class="code-line"&gt;## Weighting          : term frequency (tf)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="code-line"&gt;&lt;span&gt;&lt;/span&gt;inspect&lt;span class="p"&gt;(&lt;/span&gt;dtm&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="m"&gt;5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="m"&gt;10&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="code-line"&gt;&lt;span&gt;&lt;/span&gt;## &amp;lt;&amp;lt;DocumentTermMatrix (documents: 5, terms: 10)&amp;gt;&amp;gt;&lt;/span&gt;
&lt;span class="code-line"&gt;## Non-/sparse entries: 2/48&lt;/span&gt;
&lt;span class="code-line"&gt;## Sparsity           : 96%&lt;/span&gt;
&lt;span class="code-line"&gt;## Maximal term length: 7&lt;/span&gt;
&lt;span class="code-line"&gt;## Weighting          : term frequency (tf)&lt;/span&gt;
&lt;span class="code-line"&gt;##&lt;/span&gt;
&lt;span class="code-line"&gt;##      Terms&lt;/span&gt;
&lt;span class="code-line"&gt;## Docs  abdul abil abl abroad accept accord across activ add address&lt;/span&gt;
&lt;span class="code-line"&gt;##   127     0    0   0      0      0      0      0     0   0       0&lt;/span&gt;
&lt;span class="code-line"&gt;##   144     0    2   0      0      0      0      0     0   0       4&lt;/span&gt;
&lt;span class="code-line"&gt;##   191     0    0   0      0      0      0      0     0   0       0&lt;/span&gt;
&lt;span class="code-line"&gt;##   194     0    0   0      0      0      0      0     0   0       0&lt;/span&gt;
&lt;span class="code-line"&gt;##   211     0    0   0      0      0      0      0     0   0       0&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;到这里，就已经完成了上一篇所做的事情了。留意一下，也可以发现，'tm'包更新过之后，处理的结果与之前有一些不同，可以自己动手试试看，看看哪里不一样？&lt;/p&gt;</content><category term="data science"></category><category term="r"></category><category term="machine learning"></category><category term="text mining"></category></entry><entry><title>数据科学18：文本挖掘1</title><link href="//jacky-sj/text-mining-1.html" rel="alternate"></link><published>2014-06-18T15:08:00+08:00</published><updated>2017-03-29T20:30:00+08:00</updated><author><name>Jacky Gong</name></author><id>tag:jacky-sj,2014-06-18:/text-mining-1.html</id><summary type="html">&lt;p&gt;文本挖掘简介 1&lt;/p&gt;</summary><content type="html">&lt;p&gt;&lt;em&gt;“文章原创，转载请注明出处”&lt;/em&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;&lt;strong&gt;文本挖掘&lt;/strong&gt;，也称为文本数据挖掘，意思就如字面，对文本数据进行挖掘分析。文本挖掘一般包含：&lt;em&gt;文本分类&lt;/em&gt;、&lt;em&gt;文本聚类&lt;/em&gt;、&lt;em&gt;概念实体挖掘&lt;/em&gt;、&lt;em&gt;自然语言处理&lt;/em&gt;等等。接下来，我打算用一个简单的例子，介绍一下R语言文本挖掘的一般过程，顺便介绍一些文本挖掘中的概念。&lt;/p&gt;
&lt;p&gt;这边主要使用R中的&lt;code&gt;tm&lt;/code&gt;包进行文本挖掘，首先加载Package：&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="code-line"&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;require&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;tm&lt;span class="p"&gt;)&lt;/span&gt;  &lt;span class="c1"&gt;## R中处理文本挖掘的框架包&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;span class="kn"&gt;require&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;ggplot2&lt;span class="p"&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;1. 载入Corpus&lt;/h3&gt;
&lt;hr&gt;
&lt;p&gt;&lt;strong&gt;Corpus&lt;/strong&gt;（语料库），指一系列文档的集合，是&lt;code&gt;tm&lt;/code&gt;包管理文件的数据结构。通常，我们需要将一批文档导入成Corpus结构的数据，然后才能进行进一步的处理分析。&lt;/p&gt;
&lt;p&gt;文档的格式有非常多的格式，&lt;code&gt;tm&lt;/code&gt;包支持的格式其实只占很少的一部分，大致有：text, PDF, Mircosoft Word和XML。所以，如果需要处理的文档，其格式不在这里面的话，就需要对格式进行一些转换。个人建议，将文档格式转换成text或者XML会比较容易处理。我们可以查看一下，&lt;code&gt;tm&lt;/code&gt;包支持的文档格式：&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="code-line"&gt;&lt;span&gt;&lt;/span&gt;getReaders&lt;span class="p"&gt;()&lt;/span&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="code-line"&gt;&lt;span&gt;&lt;/span&gt;## [1] &amp;quot;readDOC&amp;quot;                 &amp;quot;readPDF&amp;quot;&lt;/span&gt;
&lt;span class="code-line"&gt;## [3] &amp;quot;readReut21578XML&amp;quot;        &amp;quot;readReut21578XMLasPlain&amp;quot;&lt;/span&gt;
&lt;span class="code-line"&gt;## [5] &amp;quot;readPlain&amp;quot;               &amp;quot;readRCV1&amp;quot;&lt;/span&gt;
&lt;span class="code-line"&gt;## [7] &amp;quot;readRCV1asPlain&amp;quot;         &amp;quot;readTabular&amp;quot;&lt;/span&gt;
&lt;span class="code-line"&gt;## [9] &amp;quot;readXML&amp;quot;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;在&lt;code&gt;tm&lt;/code&gt;包中，Corpus可以分为两种。一种是Volatile Corpus，这种数据结构是作为R对象保存在内存中,使用&lt;code&gt;VCorpus()&lt;/code&gt;或者&lt;code&gt;Corpus()&lt;/code&gt;函数；另一种就是Permanent Corpus，作为R的外部保存，使用&lt;code&gt;PCorpus()&lt;/code&gt;函数。显然，如何选择取决于内存大小以及运算速率的要求了。&lt;/p&gt;
&lt;p&gt;我们这里使用&lt;code&gt;tm&lt;/code&gt;包自带的XML文档数据进行演示：&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="code-line"&gt;&lt;span&gt;&lt;/span&gt;xml &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="kp"&gt;system.file&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;texts&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;crude&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; package &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;tm&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;  &lt;span class="c1"&gt;## 数据所在的目录&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;docs &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; Corpus&lt;span class="p"&gt;(&lt;/span&gt;DirSource&lt;span class="p"&gt;(&lt;/span&gt;xml&lt;span class="p"&gt;),&lt;/span&gt; readerControl &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kt"&gt;list&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;reader &lt;span class="o"&gt;=&lt;/span&gt; readReut21578XML&lt;span class="p"&gt;))&lt;/span&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;这里使用的数据源是&lt;code&gt;DirSource&lt;/code&gt;，当然也可以从其他的数据源导入，可以使用&lt;code&gt;getSources()&lt;/code&gt;查看：&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="code-line"&gt;&lt;span&gt;&lt;/span&gt;getSources&lt;span class="p"&gt;()&lt;/span&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="code-line"&gt;&lt;span&gt;&lt;/span&gt;## [1] &amp;quot;DataframeSource&amp;quot; &amp;quot;DirSource&amp;quot;       &amp;quot;ReutersSource&amp;quot;   &amp;quot;URISource&amp;quot;&lt;/span&gt;
&lt;span class="code-line"&gt;## [5] &amp;quot;VectorSource&amp;quot;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;如果读取的是其他格式的，就需要指定一些其他的参数，用&lt;code&gt;path&lt;/code&gt;表示数据所在的目录：&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="code-line"&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;## txt&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;docs &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; Corpus&lt;span class="p"&gt;(&lt;/span&gt;DirSource&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;path&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;span class="c1"&gt;## PDF&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;docs &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; Corpus&lt;span class="p"&gt;(&lt;/span&gt;DirSource&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;path&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; readerControl &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kt"&gt;list&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;reader &lt;span class="o"&gt;=&lt;/span&gt; readPDF&lt;span class="p"&gt;))&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;span class="c1"&gt;## 其它的类似&lt;/span&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;2. 查看Corpus&lt;/h3&gt;
&lt;hr&gt;
&lt;p&gt;将数据导入成Corpus之后，我们就需要查看Corpus。&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="code-line"&gt;&lt;span&gt;&lt;/span&gt;docs  &lt;span class="c1"&gt;## 只显示了Corpus中含有的文档数据数量&lt;/span&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="code-line"&gt;&lt;span&gt;&lt;/span&gt;## A corpus with 20 text documents&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="code-line"&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kp"&gt;names&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;docs&lt;span class="p"&gt;)[&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="m"&gt;3&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;  &lt;span class="c1"&gt;## 显示前3个文档的名称&lt;/span&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="code-line"&gt;&lt;span&gt;&lt;/span&gt;## [1] &amp;quot;reut-00001.xml&amp;quot; &amp;quot;reut-00002.xml&amp;quot; &amp;quot;reut-00004.xml&amp;quot;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="code-line"&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kp"&gt;summary&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;docs&lt;span class="p"&gt;)&lt;/span&gt;  &lt;span class="c1"&gt;## 显示更多的meta data，但不显示源信息&lt;/span&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="code-line"&gt;&lt;span&gt;&lt;/span&gt;## A corpus with 20 text documents&lt;/span&gt;
&lt;span class="code-line"&gt;##&lt;/span&gt;
&lt;span class="code-line"&gt;## The metadata consists of 2 tag-value pairs and a data frame&lt;/span&gt;
&lt;span class="code-line"&gt;## Available tags are:&lt;/span&gt;
&lt;span class="code-line"&gt;##   create_date creator&lt;/span&gt;
&lt;span class="code-line"&gt;## Available variables in the data frame are:&lt;/span&gt;
&lt;span class="code-line"&gt;##   MetaID&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="code-line"&gt;&lt;span&gt;&lt;/span&gt;inspect&lt;span class="p"&gt;(&lt;/span&gt;docs&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;  &lt;span class="c1"&gt;## 提取第一篇文档的完整信息、&lt;/span&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="code-line"&gt;&lt;span&gt;&lt;/span&gt;## A corpus with 1 text document&lt;/span&gt;
&lt;span class="code-line"&gt;##&lt;/span&gt;
&lt;span class="code-line"&gt;## The metadata consists of 2 tag-value pairs and a data frame&lt;/span&gt;
&lt;span class="code-line"&gt;## Available tags are:&lt;/span&gt;
&lt;span class="code-line"&gt;##   create_date creator&lt;/span&gt;
&lt;span class="code-line"&gt;## Available variables in the data frame are:&lt;/span&gt;
&lt;span class="code-line"&gt;##   MetaID&lt;/span&gt;
&lt;span class="code-line"&gt;##&lt;/span&gt;
&lt;span class="code-line"&gt;## $`reut-00001.xml`&lt;/span&gt;
&lt;span class="code-line"&gt;## $doc&lt;/span&gt;
&lt;span class="code-line"&gt;## $file&lt;/span&gt;
&lt;span class="code-line"&gt;## [1] &amp;quot;&lt;span class="nt"&gt;&amp;lt;buffer&amp;gt;&lt;/span&gt;&amp;quot;&lt;/span&gt;
&lt;span class="code-line"&gt;##&lt;/span&gt;
&lt;span class="code-line"&gt;## $version&lt;/span&gt;
&lt;span class="code-line"&gt;## [1] &amp;quot;1.0&amp;quot;&lt;/span&gt;
&lt;span class="code-line"&gt;##&lt;/span&gt;
&lt;span class="code-line"&gt;## $children&lt;/span&gt;
&lt;span class="code-line"&gt;## $children$REUTERS&lt;/span&gt;
&lt;span class="code-line"&gt;## &lt;span class="nt"&gt;&amp;lt;REUTERS&lt;/span&gt; &lt;span class="na"&gt;TOPICS=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;YES&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;LEWISSPLIT=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;TRAIN&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;CGISPLIT=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;TRAINING-SET&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;OLDID=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;5670&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;NEWID=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;127&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;##  &lt;span class="nt"&gt;&amp;lt;DATE&amp;gt;&lt;/span&gt;26-FEB-1987 17:00:56.04&lt;span class="nt"&gt;&amp;lt;/DATE&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;##  &lt;span class="nt"&gt;&amp;lt;TOPICS&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;##   &lt;span class="nt"&gt;&amp;lt;D&amp;gt;&lt;/span&gt;crude&lt;span class="nt"&gt;&amp;lt;/D&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;##  &lt;span class="nt"&gt;&amp;lt;/TOPICS&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;##  &lt;span class="nt"&gt;&amp;lt;PLACES&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;##   &lt;span class="nt"&gt;&amp;lt;D&amp;gt;&lt;/span&gt;usa&lt;span class="nt"&gt;&amp;lt;/D&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;##  &lt;span class="nt"&gt;&amp;lt;/PLACES&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;##  &lt;span class="nt"&gt;&amp;lt;PEOPLE/&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;##  &lt;span class="nt"&gt;&amp;lt;ORGS/&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;##  &lt;span class="nt"&gt;&amp;lt;EXCHANGES/&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;##  &lt;span class="nt"&gt;&amp;lt;COMPANIES/&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;##  &lt;span class="nt"&gt;&amp;lt;UNKNOWN&amp;gt;&lt;/span&gt;Y&lt;/span&gt;
&lt;span class="code-line"&gt;##    f0119 reute&lt;/span&gt;
&lt;span class="code-line"&gt;## u f BC-DIAMOND-SHAMROCK-(DIA   02-26 0097&lt;span class="nt"&gt;&amp;lt;/UNKNOWN&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;##  &lt;span class="nt"&gt;&amp;lt;TEXT&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;##   &lt;span class="nt"&gt;&amp;lt;TITLE&amp;gt;&lt;/span&gt;DIAMOND SHAMROCK (DIA) CUTS CRUDE PRICES&lt;span class="nt"&gt;&amp;lt;/TITLE&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;##   &lt;span class="nt"&gt;&amp;lt;DATELINE&amp;gt;&lt;/span&gt;NEW YORK, FEB 26 -&lt;span class="nt"&gt;&amp;lt;/DATELINE&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;##   &lt;span class="nt"&gt;&amp;lt;BODY&amp;gt;&lt;/span&gt;Diamond Shamrock Corp said that&lt;/span&gt;
&lt;span class="code-line"&gt;## effective today it had cut its contract prices for crude oil by&lt;/span&gt;
&lt;span class="code-line"&gt;## 1.50 dlrs a barrel.&lt;/span&gt;
&lt;span class="code-line"&gt;##     The reduction brings its posted price for West Texas&lt;/span&gt;
&lt;span class="code-line"&gt;## Intermediate to 16.00 dlrs a barrel, the copany said.&lt;/span&gt;
&lt;span class="code-line"&gt;##     &lt;span class="ni"&gt;&amp;amp;quot;&lt;/span&gt;The price reduction today was made in the light of falling&lt;/span&gt;
&lt;span class="code-line"&gt;## oil product prices and a weak crude oil market,&lt;span class="ni"&gt;&amp;amp;quot;&lt;/span&gt; a company&lt;/span&gt;
&lt;span class="code-line"&gt;## spokeswoman said.&lt;/span&gt;
&lt;span class="code-line"&gt;##     Diamond is the latest in a line of U.S. oil companies that&lt;/span&gt;
&lt;span class="code-line"&gt;## have cut its contract, or posted, prices over the last two days&lt;/span&gt;
&lt;span class="code-line"&gt;## citing weak oil markets.&lt;/span&gt;
&lt;span class="code-line"&gt;##  Reuter&lt;span class="nt"&gt;&amp;lt;/BODY&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;##  &lt;span class="nt"&gt;&amp;lt;/TEXT&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;## &lt;span class="nt"&gt;&amp;lt;/REUTERS&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;##&lt;/span&gt;
&lt;span class="code-line"&gt;##&lt;/span&gt;
&lt;span class="code-line"&gt;## attr(,&amp;quot;class&amp;quot;)&lt;/span&gt;
&lt;span class="code-line"&gt;## [1] &amp;quot;XMLDocumentContent&amp;quot;&lt;/span&gt;
&lt;span class="code-line"&gt;##&lt;/span&gt;
&lt;span class="code-line"&gt;## $dtd&lt;/span&gt;
&lt;span class="code-line"&gt;## $external&lt;/span&gt;
&lt;span class="code-line"&gt;## NULL&lt;/span&gt;
&lt;span class="code-line"&gt;##&lt;/span&gt;
&lt;span class="code-line"&gt;## $internal&lt;/span&gt;
&lt;span class="code-line"&gt;## NULL&lt;/span&gt;
&lt;span class="code-line"&gt;##&lt;/span&gt;
&lt;span class="code-line"&gt;## attr(,&amp;quot;class&amp;quot;)&lt;/span&gt;
&lt;span class="code-line"&gt;## [1] &amp;quot;DTDList&amp;quot;&lt;/span&gt;
&lt;span class="code-line"&gt;##&lt;/span&gt;
&lt;span class="code-line"&gt;## attr(,&amp;quot;Author&amp;quot;)&lt;/span&gt;
&lt;span class="code-line"&gt;## character(0)&lt;/span&gt;
&lt;span class="code-line"&gt;## attr(,&amp;quot;DateTimeStamp&amp;quot;)&lt;/span&gt;
&lt;span class="code-line"&gt;## [1] &amp;quot;1987-02-26 17:00:56 GMT&amp;quot;&lt;/span&gt;
&lt;span class="code-line"&gt;## attr(,&amp;quot;Description&amp;quot;)&lt;/span&gt;
&lt;span class="code-line"&gt;## [1] &amp;quot;&amp;quot;&lt;/span&gt;
&lt;span class="code-line"&gt;## attr(,&amp;quot;Heading&amp;quot;)&lt;/span&gt;
&lt;span class="code-line"&gt;## [1] &amp;quot;DIAMOND SHAMROCK (DIA) CUTS CRUDE PRICES&amp;quot;&lt;/span&gt;
&lt;span class="code-line"&gt;## attr(,&amp;quot;ID&amp;quot;)&lt;/span&gt;
&lt;span class="code-line"&gt;## [1] &amp;quot;127&amp;quot;&lt;/span&gt;
&lt;span class="code-line"&gt;## attr(,&amp;quot;Language&amp;quot;)&lt;/span&gt;
&lt;span class="code-line"&gt;## [1] &amp;quot;en&amp;quot;&lt;/span&gt;
&lt;span class="code-line"&gt;## attr(,&amp;quot;LocalMetaData&amp;quot;)&lt;/span&gt;
&lt;span class="code-line"&gt;## attr(,&amp;quot;LocalMetaData&amp;quot;)$TOPICS&lt;/span&gt;
&lt;span class="code-line"&gt;## [1] &amp;quot;YES&amp;quot;&lt;/span&gt;
&lt;span class="code-line"&gt;##&lt;/span&gt;
&lt;span class="code-line"&gt;## attr(,&amp;quot;LocalMetaData&amp;quot;)$LEWISSPLIT&lt;/span&gt;
&lt;span class="code-line"&gt;## [1] &amp;quot;TRAIN&amp;quot;&lt;/span&gt;
&lt;span class="code-line"&gt;##&lt;/span&gt;
&lt;span class="code-line"&gt;## attr(,&amp;quot;LocalMetaData&amp;quot;)$CGISPLIT&lt;/span&gt;
&lt;span class="code-line"&gt;## [1] &amp;quot;TRAINING-SET&amp;quot;&lt;/span&gt;
&lt;span class="code-line"&gt;##&lt;/span&gt;
&lt;span class="code-line"&gt;## attr(,&amp;quot;LocalMetaData&amp;quot;)$OLDID&lt;/span&gt;
&lt;span class="code-line"&gt;## [1] &amp;quot;5670&amp;quot;&lt;/span&gt;
&lt;span class="code-line"&gt;##&lt;/span&gt;
&lt;span class="code-line"&gt;## attr(,&amp;quot;LocalMetaData&amp;quot;)$Topics&lt;/span&gt;
&lt;span class="code-line"&gt;## [1] &amp;quot;crude&amp;quot;&lt;/span&gt;
&lt;span class="code-line"&gt;##&lt;/span&gt;
&lt;span class="code-line"&gt;## attr(,&amp;quot;LocalMetaData&amp;quot;)$Places&lt;/span&gt;
&lt;span class="code-line"&gt;## [1] &amp;quot;usa&amp;quot;&lt;/span&gt;
&lt;span class="code-line"&gt;##&lt;/span&gt;
&lt;span class="code-line"&gt;## attr(,&amp;quot;LocalMetaData&amp;quot;)$People&lt;/span&gt;
&lt;span class="code-line"&gt;## character(0)&lt;/span&gt;
&lt;span class="code-line"&gt;##&lt;/span&gt;
&lt;span class="code-line"&gt;## attr(,&amp;quot;LocalMetaData&amp;quot;)$Orgs&lt;/span&gt;
&lt;span class="code-line"&gt;## character(0)&lt;/span&gt;
&lt;span class="code-line"&gt;##&lt;/span&gt;
&lt;span class="code-line"&gt;## attr(,&amp;quot;LocalMetaData&amp;quot;)$Exchanges&lt;/span&gt;
&lt;span class="code-line"&gt;## character(0)&lt;/span&gt;
&lt;span class="code-line"&gt;##&lt;/span&gt;
&lt;span class="code-line"&gt;## attr(,&amp;quot;Origin&amp;quot;)&lt;/span&gt;
&lt;span class="code-line"&gt;## [1] &amp;quot;Reuters-21578 XML&amp;quot;&lt;/span&gt;
&lt;span class="code-line"&gt;## attr(,&amp;quot;class&amp;quot;)&lt;/span&gt;
&lt;span class="code-line"&gt;## [1] &amp;quot;Reuters21578Document&amp;quot; &amp;quot;TextDocument&amp;quot;         &amp;quot;XMLDocument&amp;quot;&lt;/span&gt;
&lt;span class="code-line"&gt;## [4] &amp;quot;XMLAbstractDocument&amp;quot;  &amp;quot;oldClass&amp;quot;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="code-line"&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;## inspect(docs) 可以提取所有文档的完整信息，不过数据量会很大&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;docs&lt;span class="p"&gt;[[&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]]&lt;/span&gt;  &lt;span class="c1"&gt;## 提取第一个文档&lt;/span&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="code-line"&gt;&lt;span&gt;&lt;/span&gt;## $doc&lt;/span&gt;
&lt;span class="code-line"&gt;## $file&lt;/span&gt;
&lt;span class="code-line"&gt;## [1] &amp;quot;&lt;span class="nt"&gt;&amp;lt;buffer&amp;gt;&lt;/span&gt;&amp;quot;&lt;/span&gt;
&lt;span class="code-line"&gt;##&lt;/span&gt;
&lt;span class="code-line"&gt;## $version&lt;/span&gt;
&lt;span class="code-line"&gt;## [1] &amp;quot;1.0&amp;quot;&lt;/span&gt;
&lt;span class="code-line"&gt;##&lt;/span&gt;
&lt;span class="code-line"&gt;## $children&lt;/span&gt;
&lt;span class="code-line"&gt;## $children$REUTERS&lt;/span&gt;
&lt;span class="code-line"&gt;## &lt;span class="nt"&gt;&amp;lt;REUTERS&lt;/span&gt; &lt;span class="na"&gt;TOPICS=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;YES&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;LEWISSPLIT=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;TRAIN&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;CGISPLIT=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;TRAINING-SET&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;OLDID=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;5670&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;NEWID=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;127&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;##  &lt;span class="nt"&gt;&amp;lt;DATE&amp;gt;&lt;/span&gt;26-FEB-1987 17:00:56.04&lt;span class="nt"&gt;&amp;lt;/DATE&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;##  &lt;span class="nt"&gt;&amp;lt;TOPICS&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;##   &lt;span class="nt"&gt;&amp;lt;D&amp;gt;&lt;/span&gt;crude&lt;span class="nt"&gt;&amp;lt;/D&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;##  &lt;span class="nt"&gt;&amp;lt;/TOPICS&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;##  &lt;span class="nt"&gt;&amp;lt;PLACES&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;##   &lt;span class="nt"&gt;&amp;lt;D&amp;gt;&lt;/span&gt;usa&lt;span class="nt"&gt;&amp;lt;/D&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;##  &lt;span class="nt"&gt;&amp;lt;/PLACES&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;##  &lt;span class="nt"&gt;&amp;lt;PEOPLE/&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;##  &lt;span class="nt"&gt;&amp;lt;ORGS/&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;##  &lt;span class="nt"&gt;&amp;lt;EXCHANGES/&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;##  &lt;span class="nt"&gt;&amp;lt;COMPANIES/&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;##  &lt;span class="nt"&gt;&amp;lt;UNKNOWN&amp;gt;&lt;/span&gt;Y&lt;/span&gt;
&lt;span class="code-line"&gt;##    f0119 reute&lt;/span&gt;
&lt;span class="code-line"&gt;## u f BC-DIAMOND-SHAMROCK-(DIA   02-26 0097&lt;span class="nt"&gt;&amp;lt;/UNKNOWN&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;##  &lt;span class="nt"&gt;&amp;lt;TEXT&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;##   &lt;span class="nt"&gt;&amp;lt;TITLE&amp;gt;&lt;/span&gt;DIAMOND SHAMROCK (DIA) CUTS CRUDE PRICES&lt;span class="nt"&gt;&amp;lt;/TITLE&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;##   &lt;span class="nt"&gt;&amp;lt;DATELINE&amp;gt;&lt;/span&gt;NEW YORK, FEB 26 -&lt;span class="nt"&gt;&amp;lt;/DATELINE&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;##   &lt;span class="nt"&gt;&amp;lt;BODY&amp;gt;&lt;/span&gt;Diamond Shamrock Corp said that&lt;/span&gt;
&lt;span class="code-line"&gt;## effective today it had cut its contract prices for crude oil by&lt;/span&gt;
&lt;span class="code-line"&gt;## 1.50 dlrs a barrel.&lt;/span&gt;
&lt;span class="code-line"&gt;##     The reduction brings its posted price for West Texas&lt;/span&gt;
&lt;span class="code-line"&gt;## Intermediate to 16.00 dlrs a barrel, the copany said.&lt;/span&gt;
&lt;span class="code-line"&gt;##     &lt;span class="ni"&gt;&amp;amp;quot;&lt;/span&gt;The price reduction today was made in the light of falling&lt;/span&gt;
&lt;span class="code-line"&gt;## oil product prices and a weak crude oil market,&lt;span class="ni"&gt;&amp;amp;quot;&lt;/span&gt; a company&lt;/span&gt;
&lt;span class="code-line"&gt;## spokeswoman said.&lt;/span&gt;
&lt;span class="code-line"&gt;##     Diamond is the latest in a line of U.S. oil companies that&lt;/span&gt;
&lt;span class="code-line"&gt;## have cut its contract, or posted, prices over the last two days&lt;/span&gt;
&lt;span class="code-line"&gt;## citing weak oil markets.&lt;/span&gt;
&lt;span class="code-line"&gt;##  Reuter&lt;span class="nt"&gt;&amp;lt;/BODY&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;##  &lt;span class="nt"&gt;&amp;lt;/TEXT&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;## &lt;span class="nt"&gt;&amp;lt;/REUTERS&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;##&lt;/span&gt;
&lt;span class="code-line"&gt;##&lt;/span&gt;
&lt;span class="code-line"&gt;## attr(,&amp;quot;class&amp;quot;)&lt;/span&gt;
&lt;span class="code-line"&gt;## [1] &amp;quot;XMLDocumentContent&amp;quot;&lt;/span&gt;
&lt;span class="code-line"&gt;##&lt;/span&gt;
&lt;span class="code-line"&gt;## $dtd&lt;/span&gt;
&lt;span class="code-line"&gt;## $external&lt;/span&gt;
&lt;span class="code-line"&gt;## NULL&lt;/span&gt;
&lt;span class="code-line"&gt;##&lt;/span&gt;
&lt;span class="code-line"&gt;## $internal&lt;/span&gt;
&lt;span class="code-line"&gt;## NULL&lt;/span&gt;
&lt;span class="code-line"&gt;##&lt;/span&gt;
&lt;span class="code-line"&gt;## attr(,&amp;quot;class&amp;quot;)&lt;/span&gt;
&lt;span class="code-line"&gt;## [1] &amp;quot;DTDList&amp;quot;&lt;/span&gt;
&lt;span class="code-line"&gt;##&lt;/span&gt;
&lt;span class="code-line"&gt;## attr(,&amp;quot;Author&amp;quot;)&lt;/span&gt;
&lt;span class="code-line"&gt;## character(0)&lt;/span&gt;
&lt;span class="code-line"&gt;## attr(,&amp;quot;DateTimeStamp&amp;quot;)&lt;/span&gt;
&lt;span class="code-line"&gt;## [1] &amp;quot;1987-02-26 17:00:56 GMT&amp;quot;&lt;/span&gt;
&lt;span class="code-line"&gt;## attr(,&amp;quot;Description&amp;quot;)&lt;/span&gt;
&lt;span class="code-line"&gt;## [1] &amp;quot;&amp;quot;&lt;/span&gt;
&lt;span class="code-line"&gt;## attr(,&amp;quot;Heading&amp;quot;)&lt;/span&gt;
&lt;span class="code-line"&gt;## [1] &amp;quot;DIAMOND SHAMROCK (DIA) CUTS CRUDE PRICES&amp;quot;&lt;/span&gt;
&lt;span class="code-line"&gt;## attr(,&amp;quot;ID&amp;quot;)&lt;/span&gt;
&lt;span class="code-line"&gt;## [1] &amp;quot;127&amp;quot;&lt;/span&gt;
&lt;span class="code-line"&gt;## attr(,&amp;quot;Language&amp;quot;)&lt;/span&gt;
&lt;span class="code-line"&gt;## [1] &amp;quot;en&amp;quot;&lt;/span&gt;
&lt;span class="code-line"&gt;## attr(,&amp;quot;LocalMetaData&amp;quot;)&lt;/span&gt;
&lt;span class="code-line"&gt;## attr(,&amp;quot;LocalMetaData&amp;quot;)$TOPICS&lt;/span&gt;
&lt;span class="code-line"&gt;## [1] &amp;quot;YES&amp;quot;&lt;/span&gt;
&lt;span class="code-line"&gt;##&lt;/span&gt;
&lt;span class="code-line"&gt;## attr(,&amp;quot;LocalMetaData&amp;quot;)$LEWISSPLIT&lt;/span&gt;
&lt;span class="code-line"&gt;## [1] &amp;quot;TRAIN&amp;quot;&lt;/span&gt;
&lt;span class="code-line"&gt;##&lt;/span&gt;
&lt;span class="code-line"&gt;## attr(,&amp;quot;LocalMetaData&amp;quot;)$CGISPLIT&lt;/span&gt;
&lt;span class="code-line"&gt;## [1] &amp;quot;TRAINING-SET&amp;quot;&lt;/span&gt;
&lt;span class="code-line"&gt;##&lt;/span&gt;
&lt;span class="code-line"&gt;## attr(,&amp;quot;LocalMetaData&amp;quot;)$OLDID&lt;/span&gt;
&lt;span class="code-line"&gt;## [1] &amp;quot;5670&amp;quot;&lt;/span&gt;
&lt;span class="code-line"&gt;##&lt;/span&gt;
&lt;span class="code-line"&gt;## attr(,&amp;quot;LocalMetaData&amp;quot;)$Topics&lt;/span&gt;
&lt;span class="code-line"&gt;## [1] &amp;quot;crude&amp;quot;&lt;/span&gt;
&lt;span class="code-line"&gt;##&lt;/span&gt;
&lt;span class="code-line"&gt;## attr(,&amp;quot;LocalMetaData&amp;quot;)$Places&lt;/span&gt;
&lt;span class="code-line"&gt;## [1] &amp;quot;usa&amp;quot;&lt;/span&gt;
&lt;span class="code-line"&gt;##&lt;/span&gt;
&lt;span class="code-line"&gt;## attr(,&amp;quot;LocalMetaData&amp;quot;)$People&lt;/span&gt;
&lt;span class="code-line"&gt;## character(0)&lt;/span&gt;
&lt;span class="code-line"&gt;##&lt;/span&gt;
&lt;span class="code-line"&gt;## attr(,&amp;quot;LocalMetaData&amp;quot;)$Orgs&lt;/span&gt;
&lt;span class="code-line"&gt;## character(0)&lt;/span&gt;
&lt;span class="code-line"&gt;##&lt;/span&gt;
&lt;span class="code-line"&gt;## attr(,&amp;quot;LocalMetaData&amp;quot;)$Exchanges&lt;/span&gt;
&lt;span class="code-line"&gt;## character(0)&lt;/span&gt;
&lt;span class="code-line"&gt;##&lt;/span&gt;
&lt;span class="code-line"&gt;## attr(,&amp;quot;Origin&amp;quot;)&lt;/span&gt;
&lt;span class="code-line"&gt;## [1] &amp;quot;Reuters-21578 XML&amp;quot;&lt;/span&gt;
&lt;span class="code-line"&gt;## attr(,&amp;quot;class&amp;quot;)&lt;/span&gt;
&lt;span class="code-line"&gt;## [1] &amp;quot;Reuters21578Document&amp;quot; &amp;quot;TextDocument&amp;quot;         &amp;quot;XMLDocument&amp;quot;&lt;/span&gt;
&lt;span class="code-line"&gt;## [4] &amp;quot;XMLAbstractDocument&amp;quot;  &amp;quot;oldClass&amp;quot;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="code-line"&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;## docs[[&amp;#39;reut-00001.xml&amp;#39;]] 同样可以提取第一个文档&lt;/span&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;3. 信息转化&lt;/h3&gt;
&lt;hr&gt;
&lt;p&gt;创建好Corpus后，就需要对其进行一些修改，比如去除标点、停止词等等。这里就需要使用到一个函数&lt;code&gt;tm_map()&lt;/code&gt;，其可以将转化函数作用到每一个文档数据上。&lt;/p&gt;
&lt;h4&gt;1. 转化为纯文本&lt;/h4&gt;
&lt;p&gt;如果Corpus中存储的是非纯文本的数据，比如XML格式的数据，那么就需要先将这些数据转换成纯文本格式:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="code-line"&gt;&lt;span&gt;&lt;/span&gt;docs &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; tm_map&lt;span class="p"&gt;(&lt;/span&gt;docs&lt;span class="p"&gt;,&lt;/span&gt; as.PlainTextDocument&lt;span class="p"&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;docs&lt;span class="p"&gt;[[&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]]&lt;/span&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="code-line"&gt;&lt;span&gt;&lt;/span&gt;## DIAMOND SHAMROCK (DIA) CUTS CRUDE PRICES&lt;/span&gt;
&lt;span class="code-line"&gt;## NEW YORK, FEB 26 -&lt;/span&gt;
&lt;span class="code-line"&gt;## Diamond Shamrock Corp said that&lt;/span&gt;
&lt;span class="code-line"&gt;## effective today it had cut its contract prices for crude oil by&lt;/span&gt;
&lt;span class="code-line"&gt;## 1.50 dlrs a barrel.&lt;/span&gt;
&lt;span class="code-line"&gt;##     The reduction brings its posted price for West Texas&lt;/span&gt;
&lt;span class="code-line"&gt;## Intermediate to 16.00 dlrs a barrel, the copany said.&lt;/span&gt;
&lt;span class="code-line"&gt;##     &amp;quot;The price reduction today was made in the light of falling&lt;/span&gt;
&lt;span class="code-line"&gt;## oil product prices and a weak crude oil market,&amp;quot; a company&lt;/span&gt;
&lt;span class="code-line"&gt;## spokeswoman said.&lt;/span&gt;
&lt;span class="code-line"&gt;##     Diamond is the latest in a line of U.S. oil companies that&lt;/span&gt;
&lt;span class="code-line"&gt;## have cut its contract, or posted, prices over the last two days&lt;/span&gt;
&lt;span class="code-line"&gt;## citing weak oil markets.&lt;/span&gt;
&lt;span class="code-line"&gt;##  Reuter&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h4&gt;2. 去除特殊字符&lt;/h4&gt;
&lt;p&gt;在文档数据中，可能会存在这样的字符："/"、"@"、"-"等等。大部分时候，我们需要将其去除掉：&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="code-line"&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kr"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;i &lt;span class="kr"&gt;in&lt;/span&gt; &lt;span class="kp"&gt;seq&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;docs&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;    docs&lt;span class="p"&gt;[[&lt;/span&gt;i&lt;span class="p"&gt;]]&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="kp"&gt;gsub&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;/&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;quot; &amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; docs&lt;span class="p"&gt;[[&lt;/span&gt;i&lt;span class="p"&gt;]])&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;    docs&lt;span class="p"&gt;[[&lt;/span&gt;i&lt;span class="p"&gt;]]&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="kp"&gt;gsub&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;@&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;quot; &amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; docs&lt;span class="p"&gt;[[&lt;/span&gt;i&lt;span class="p"&gt;]])&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;    docs&lt;span class="p"&gt;[[&lt;/span&gt;i&lt;span class="p"&gt;]]&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="kp"&gt;gsub&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;-&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;quot; &amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; docs&lt;span class="p"&gt;[[&lt;/span&gt;i&lt;span class="p"&gt;]])&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;如果存在更复杂的替换，可以使用正则表达式去解决，这里不做介绍。&lt;/p&gt;
&lt;h4&gt;3. 转换成小写&lt;/h4&gt;
&lt;p&gt;顾名思义，就是将所有的数据转换成小写字母，这样以便更加容易分析。&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="code-line"&gt;&lt;span&gt;&lt;/span&gt;docs &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; tm_map&lt;span class="p"&gt;(&lt;/span&gt;docs&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kp"&gt;tolower&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;docs&lt;span class="p"&gt;[[&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]]&lt;/span&gt;  &lt;span class="c1"&gt;## 查看效果&lt;/span&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="code-line"&gt;&lt;span&gt;&lt;/span&gt;## diamond shamrock (dia) cuts crude prices&lt;/span&gt;
&lt;span class="code-line"&gt;## new york, feb 26&lt;/span&gt;
&lt;span class="code-line"&gt;## diamond shamrock corp said that&lt;/span&gt;
&lt;span class="code-line"&gt;## effective today it had cut its contract prices for crude oil by&lt;/span&gt;
&lt;span class="code-line"&gt;## 1.50 dlrs a barrel.&lt;/span&gt;
&lt;span class="code-line"&gt;##     the reduction brings its posted price for west texas&lt;/span&gt;
&lt;span class="code-line"&gt;## intermediate to 16.00 dlrs a barrel, the copany said.&lt;/span&gt;
&lt;span class="code-line"&gt;##     &amp;quot;the price reduction today was made in the light of falling&lt;/span&gt;
&lt;span class="code-line"&gt;## oil product prices and a weak crude oil market,&amp;quot; a company&lt;/span&gt;
&lt;span class="code-line"&gt;## spokeswoman said.&lt;/span&gt;
&lt;span class="code-line"&gt;##     diamond is the latest in a line of u.s. oil companies that&lt;/span&gt;
&lt;span class="code-line"&gt;## have cut its contract, or posted, prices over the last two days&lt;/span&gt;
&lt;span class="code-line"&gt;## citing weak oil markets.&lt;/span&gt;
&lt;span class="code-line"&gt;##  reuter&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h4&gt;4. 去除数字&lt;/h4&gt;
&lt;p&gt;有些时候，我们需要将文档中的数字去除掉：&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="code-line"&gt;&lt;span&gt;&lt;/span&gt;docs &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; tm_map&lt;span class="p"&gt;(&lt;/span&gt;docs&lt;span class="p"&gt;,&lt;/span&gt; removeNumbers&lt;span class="p"&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;docs&lt;span class="p"&gt;[[&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]]&lt;/span&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="code-line"&gt;&lt;span&gt;&lt;/span&gt;## diamond shamrock (dia) cuts crude prices&lt;/span&gt;
&lt;span class="code-line"&gt;## new york, feb&lt;/span&gt;
&lt;span class="code-line"&gt;## diamond shamrock corp said that&lt;/span&gt;
&lt;span class="code-line"&gt;## effective today it had cut its contract prices for crude oil by&lt;/span&gt;
&lt;span class="code-line"&gt;## . dlrs a barrel.&lt;/span&gt;
&lt;span class="code-line"&gt;##     the reduction brings its posted price for west texas&lt;/span&gt;
&lt;span class="code-line"&gt;## intermediate to . dlrs a barrel, the copany said.&lt;/span&gt;
&lt;span class="code-line"&gt;##     &amp;quot;the price reduction today was made in the light of falling&lt;/span&gt;
&lt;span class="code-line"&gt;## oil product prices and a weak crude oil market,&amp;quot; a company&lt;/span&gt;
&lt;span class="code-line"&gt;## spokeswoman said.&lt;/span&gt;
&lt;span class="code-line"&gt;##     diamond is the latest in a line of u.s. oil companies that&lt;/span&gt;
&lt;span class="code-line"&gt;## have cut its contract, or posted, prices over the last two days&lt;/span&gt;
&lt;span class="code-line"&gt;## citing weak oil markets.&lt;/span&gt;
&lt;span class="code-line"&gt;##  reuter&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h4&gt;5. 去除停止词&lt;/h4&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="code-line"&gt;&lt;span&gt;&lt;/span&gt;docs &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; tm_map&lt;span class="p"&gt;(&lt;/span&gt;docs&lt;span class="p"&gt;,&lt;/span&gt; removeWords&lt;span class="p"&gt;,&lt;/span&gt; stopwords&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;english&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;docs&lt;span class="p"&gt;[[&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]]&lt;/span&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="code-line"&gt;&lt;span&gt;&lt;/span&gt;## diamond shamrock (dia) cuts crude prices&lt;/span&gt;
&lt;span class="code-line"&gt;## new york, feb&lt;/span&gt;
&lt;span class="code-line"&gt;## diamond shamrock corp said&lt;/span&gt;
&lt;span class="code-line"&gt;## effective today   cut  contract prices  crude oil&lt;/span&gt;
&lt;span class="code-line"&gt;## . dlrs  barrel.&lt;/span&gt;
&lt;span class="code-line"&gt;##      reduction brings  posted price  west texas&lt;/span&gt;
&lt;span class="code-line"&gt;## intermediate  . dlrs  barrel,  copany said.&lt;/span&gt;
&lt;span class="code-line"&gt;##     &amp;quot; price reduction today  made   light  falling&lt;/span&gt;
&lt;span class="code-line"&gt;## oil product prices   weak crude oil market,&amp;quot;  company&lt;/span&gt;
&lt;span class="code-line"&gt;## spokeswoman said.&lt;/span&gt;
&lt;span class="code-line"&gt;##     diamond   latest   line  u.s. oil companies&lt;/span&gt;
&lt;span class="code-line"&gt;##  cut  contract,  posted, prices   last two days&lt;/span&gt;
&lt;span class="code-line"&gt;## citing weak oil markets.&lt;/span&gt;
&lt;span class="code-line"&gt;##  reuter&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h4&gt;6. 去除标点&lt;/h4&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="code-line"&gt;&lt;span&gt;&lt;/span&gt;docs &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; tm_map&lt;span class="p"&gt;(&lt;/span&gt;docs&lt;span class="p"&gt;,&lt;/span&gt; removePunctuation&lt;span class="p"&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;docs&lt;span class="p"&gt;[[&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]]&lt;/span&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="code-line"&gt;&lt;span&gt;&lt;/span&gt;## diamond shamrock dia cuts crude prices&lt;/span&gt;
&lt;span class="code-line"&gt;## new york feb&lt;/span&gt;
&lt;span class="code-line"&gt;## diamond shamrock corp said&lt;/span&gt;
&lt;span class="code-line"&gt;## effective today   cut  contract prices  crude oil&lt;/span&gt;
&lt;span class="code-line"&gt;##  dlrs  barrel&lt;/span&gt;
&lt;span class="code-line"&gt;##      reduction brings  posted price  west texas&lt;/span&gt;
&lt;span class="code-line"&gt;## intermediate   dlrs  barrel  copany said&lt;/span&gt;
&lt;span class="code-line"&gt;##      price reduction today  made   light  falling&lt;/span&gt;
&lt;span class="code-line"&gt;## oil product prices   weak crude oil market  company&lt;/span&gt;
&lt;span class="code-line"&gt;## spokeswoman said&lt;/span&gt;
&lt;span class="code-line"&gt;##     diamond   latest   line  us oil companies&lt;/span&gt;
&lt;span class="code-line"&gt;##  cut  contract  posted prices   last two days&lt;/span&gt;
&lt;span class="code-line"&gt;## citing weak oil markets&lt;/span&gt;
&lt;span class="code-line"&gt;##  reuter&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h4&gt;7. 去除多余的空格&lt;/h4&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="code-line"&gt;&lt;span&gt;&lt;/span&gt;docs &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; tm_map&lt;span class="p"&gt;(&lt;/span&gt;docs&lt;span class="p"&gt;,&lt;/span&gt; stripWhitespace&lt;span class="p"&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;docs&lt;span class="p"&gt;[[&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]]&lt;/span&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="code-line"&gt;&lt;span&gt;&lt;/span&gt;## diamond shamrock dia cuts crude prices&lt;/span&gt;
&lt;span class="code-line"&gt;## new york feb&lt;/span&gt;
&lt;span class="code-line"&gt;## diamond shamrock corp said effective today cut contract prices crude oil dlrs barrel reduction brings posted price west texas intermediate dlrs barrel copany said price reduction today made light falling oil product prices weak crude oil market company spokeswoman said diamond latest line us oil companies cut contract posted prices last two days citing weak oil markets reuter&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h4&gt;8. Stemming(词干化)&lt;/h4&gt;
&lt;p&gt;首先介绍一下什么是Stemming，我们知道在英文中一个单词会存在很多形式，比如说复数形式、过去分词等等。但其实它们外表看起来虽不一样，但实际上是一样的。所以在处理分析的时候，就需要将这些单词都转换成其本身。在R中可以使用&lt;code&gt;SnowballC&lt;/code&gt;这个包来处理Stemming，举个例子：&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="code-line"&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;require&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;SnowballC&lt;span class="p"&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="code-line"&gt;&lt;span&gt;&lt;/span&gt;## Loading required package: SnowballC&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="code-line"&gt;&lt;span&gt;&lt;/span&gt;exam &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="kt"&gt;c&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;prices, price, doing&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;stemDocument&lt;span class="p"&gt;(&lt;/span&gt;exam&lt;span class="p"&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="code-line"&gt;&lt;span&gt;&lt;/span&gt;## [1] &amp;quot;prices, price, do&amp;quot;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;对于我们的例子：&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="code-line"&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;require&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;SnowballC&lt;span class="p"&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;docs &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; tm_map&lt;span class="p"&gt;(&lt;/span&gt;docs&lt;span class="p"&gt;,&lt;/span&gt; stemDocument&lt;span class="p"&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;docs&lt;span class="p"&gt;[[&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]]&lt;/span&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="code-line"&gt;&lt;span&gt;&lt;/span&gt;## diamond shamrock dia cut crude price&lt;/span&gt;
&lt;span class="code-line"&gt;## new york feb&lt;/span&gt;
&lt;span class="code-line"&gt;## diamond shamrock corp said effect today cut contract price crude oil dlrs barrel reduct bring post price west texa intermedi dlrs barrel copani said price reduct today made light fall oil product price weak crude oil market compani spokeswoman said diamond latest line us oil compani cut contract post price last two day cite weak oil market reuter&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;4. 创建词条-文档关系矩阵&lt;/h3&gt;
&lt;hr&gt;
&lt;p&gt;文本挖掘中，词条-文档关系矩阵是构建模型的基础，后续分析建模都是建立在这个矩阵之上的。首先来了解一下这个矩阵，举个例子：&lt;/p&gt;
&lt;p&gt;我们有两篇文档，内容分别为：text mining 和 data mining and text mining。 那么对应的矩阵为：&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="code-line"&gt;&lt;span&gt;&lt;/span&gt;d.Exam &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="kt"&gt;c&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;text mining&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;data mining and text mining&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;doc.Exam &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; Corpus&lt;span class="p"&gt;(&lt;/span&gt;VectorSource&lt;span class="p"&gt;(&lt;/span&gt;d.Exam&lt;span class="p"&gt;))&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;dtm.Exam &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; DocumentTermMatrix&lt;span class="p"&gt;(&lt;/span&gt;doc.Exam&lt;span class="p"&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;inspect&lt;span class="p"&gt;(&lt;/span&gt;dtm.Exam&lt;span class="p"&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="code-line"&gt;&lt;span&gt;&lt;/span&gt;## A document-term matrix (2 documents, 4 terms)&lt;/span&gt;
&lt;span class="code-line"&gt;##&lt;/span&gt;
&lt;span class="code-line"&gt;## Non-/sparse entries: 6/2&lt;/span&gt;
&lt;span class="code-line"&gt;## Sparsity           : 25%&lt;/span&gt;
&lt;span class="code-line"&gt;## Maximal term length: 6&lt;/span&gt;
&lt;span class="code-line"&gt;## Weighting          : term frequency (tf)&lt;/span&gt;
&lt;span class="code-line"&gt;##&lt;/span&gt;
&lt;span class="code-line"&gt;##     Terms&lt;/span&gt;
&lt;span class="code-line"&gt;## Docs and data mining text&lt;/span&gt;
&lt;span class="code-line"&gt;##    1   0    0      1    1&lt;/span&gt;
&lt;span class="code-line"&gt;##    2   1    1      2    1&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;可以看到，词条-文档关系矩阵其实就是将文档作为列，词条作为行，矩阵的每个位置就是对应的词条在对应的文档中出现的次数。&lt;/p&gt;
&lt;p&gt;对于我们的例子，可以这样来生产词条-文档矩阵：&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="code-line"&gt;&lt;span&gt;&lt;/span&gt;dtm &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; DocumentTermMatrix&lt;span class="p"&gt;(&lt;/span&gt;docs&lt;span class="p"&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;inspect&lt;span class="p"&gt;(&lt;/span&gt;dtm&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="m"&gt;5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="m"&gt;10&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="code-line"&gt;&lt;span&gt;&lt;/span&gt;## A document-term matrix (5 documents, 10 terms)&lt;/span&gt;
&lt;span class="code-line"&gt;##&lt;/span&gt;
&lt;span class="code-line"&gt;## Non-/sparse entries: 1/49&lt;/span&gt;
&lt;span class="code-line"&gt;## Sparsity           : 98%&lt;/span&gt;
&lt;span class="code-line"&gt;## Maximal term length: 6&lt;/span&gt;
&lt;span class="code-line"&gt;## Weighting          : term frequency (tf)&lt;/span&gt;
&lt;span class="code-line"&gt;##&lt;/span&gt;
&lt;span class="code-line"&gt;##      Terms&lt;/span&gt;
&lt;span class="code-line"&gt;## Docs  abdul abil abl abroad abu accept accord across activ add&lt;/span&gt;
&lt;span class="code-line"&gt;##   127     0    0   0      0   0      0      0      0     0   0&lt;/span&gt;
&lt;span class="code-line"&gt;##   144     0    2   0      0   0      0      0      0     0   0&lt;/span&gt;
&lt;span class="code-line"&gt;##   191     0    0   0      0   0      0      0      0     0   0&lt;/span&gt;
&lt;span class="code-line"&gt;##   194     0    0   0      0   0      0      0      0     0   0&lt;/span&gt;
&lt;span class="code-line"&gt;##   211     0    0   0      0   0      0      0      0     0   0&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;到这里，我们就已经生成了词条-文档矩阵。下一次，就来看看如何对这个矩阵进行一些操作，以及如何利用这个矩阵进行后续的建模分析。&lt;/p&gt;</content><category term="data science"></category><category term="r"></category><category term="machine learning"></category><category term="text mining"></category></entry><entry><title>因子分析2</title><link href="//jacky-sj/factor-analysis-2.html" rel="alternate"></link><published>2014-05-19T15:00:00+08:00</published><updated>2017-03-29T20:30:00+08:00</updated><author><name>Jacky Gong</name></author><id>tag:jacky-sj,2014-05-19:/factor-analysis-2.html</id><summary type="html">&lt;p&gt;因子分析简介 2&lt;/p&gt;</summary><content type="html">&lt;p&gt;&lt;em&gt;“文章原创，转载请注明出处”&lt;/em&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;这两天来了个同学，大家聚了聚，我也乘机休息了两天（好奢侈！）。这两天属于什么都没有写，就翻看了两本书。一本是二月河的&lt;a href="http://www.amazon.cn/gp/product/B0032K0X6Q/ref=olp_product_details?ie=UTF8&amp;amp;me=&amp;amp;seller="&gt;康熙大帝&lt;/a&gt;，另外一本是&lt;a href="http://www.ituring.com.cn/book/894"&gt;推荐系统实践&lt;/a&gt;，这本书的电子版，图灵正在打折，有兴趣可以买本看看。&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;好了，不废话了，下面就接着上一篇讲的继续！上一篇简单介绍了因子分析的一些概念，以及最基础的因子模型：&lt;strong&gt;正交因子模型&lt;/strong&gt;。那么这一篇，就来说说正交因子模型的&lt;strong&gt;参数估计问题&lt;/strong&gt;。&lt;/p&gt;
&lt;p&gt;对于一组p维样本，有n个观测值：&lt;span class="math"&gt;\(x_1, x_2, \dots, x_n\)&lt;/span&gt;，则其均值和协方差矩阵可以使用样本均值和样本协方差矩阵来估计：&lt;/p&gt;
&lt;div class="math"&gt;$$ \hat{\mu} = \overline{x} = \frac{1}{n} {\sum_{i=1}^{n} x_i} $$&lt;/div&gt;
&lt;div class="math"&gt;$$ \hat{\Sigma} = S = \frac{1}{n-1} {\sum_{i=1}^{n} (x_i-\overline{x})(x_i-\overline{x})'} $$&lt;/div&gt;
&lt;p&gt;在因子模型中，需要估计的有两个参数：&lt;strong&gt;因子载荷矩阵&lt;/strong&gt;&lt;span class="math"&gt;\(A=(a_{ij}:p \times m)\)&lt;/span&gt;以及&lt;strong&gt;特殊方差矩阵&lt;/strong&gt;&lt;span class="math"&gt;\(D = diag(\sigma_1^2, \sigma_2^2, \dots, \sigma_p^2)\)&lt;/span&gt;。&lt;/p&gt;
&lt;hr&gt;
&lt;h4&gt;1. 主成分法&lt;/h4&gt;
&lt;hr&gt;
&lt;p&gt;主成分法的思想取自于主成分分析，即是取出前m个成分作为主成分，然后以此来得到因子载荷矩阵的估计；然后再以协方差阵和因子载荷矩阵为条件，直接推出特殊方差矩阵。具体如下：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;求出协方差矩阵&lt;span class="math"&gt;\(S\)&lt;/span&gt;的特征值：&lt;span class="math"&gt;\(\hat{\lambda}_1 \geqslant \hat{\lambda}_2 \geqslant \dots \geqslant \hat{\lambda}_p \geqslant 0\)&lt;/span&gt;，其对应的特征向量为：&lt;span class="math"&gt;\(\hat{t}_1, \hat{t}_2, \dots, \hat{t}_p\)&lt;/span&gt;。&lt;/li&gt;
&lt;li&gt;选一个较小因子数&lt;span class="math"&gt;\(m\)&lt;/span&gt;，并且使得前m项累计贡献率 &lt;span class="math"&gt;\(\frac{\sum_{i=1}^{m} \hat{\lambda}_i}{\sum_{i=1}^{p} \hat{\lambda}_i}\)&lt;/span&gt; 高于设定值。&lt;/li&gt;
&lt;li&gt;将协方差矩阵&lt;span class="math"&gt;\(S\)&lt;/span&gt;做这样的近似：&lt;span class="math"&gt;\(S = \sum_{i=1}^{m} \hat{\lambda}_i + \sum_{i=m+1}^{p} \hat{\lambda}_i \approx \sum_{i=1}^{m} \hat{\lambda}_i + \hat{D} := \hat{A}\hat{A}' + \hat{D}\)&lt;/span&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;其中，&lt;span class="math"&gt;\(A = (\sqrt{\hat{\lambda}_1}t_1, \sqrt{\hat{\lambda}_2}t_2, \dots, \sqrt{\hat{\lambda}_m}t_m)\)&lt;/span&gt;, &lt;span class="math"&gt;\(\hat{D} = diag(\hat{\sigma}_1^2, \hat{\sigma}_2^2, \dots, \hat{\sigma}_p^2)\)&lt;/span&gt;, &lt;span class="math"&gt;\(\hat{\sigma}_i^2 = s_{ii} - \sum_{j=1}^{m} \hat{a}_{ij}^2\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;从上述的过程来看，我们是使用了一种近似的方法估计出了&lt;span class="math"&gt;\(A\)&lt;/span&gt;和&lt;span class="math"&gt;\(D\)&lt;/span&gt;，那么这就有一个&lt;strong&gt;残差矩阵&lt;/strong&gt;&lt;span class="math"&gt;\(S - (\hat{A}\hat{A}' + \hat{D})\)&lt;/span&gt;，显然这个矩阵的对角线元素为0。既然是一种近似，那么，如果这个残差矩阵的非对角线元素都非常小的时候，我们就可以认为取&lt;span class="math"&gt;\(m\)&lt;/span&gt;个因子的模型就可以很好地解释或者是拟合原始的数据了。&lt;/p&gt;
&lt;hr&gt;
&lt;h4&gt;2. 主因子法&lt;/h4&gt;
&lt;hr&gt;
&lt;p&gt;对于因子模型，我们先对原始向量进行标准化，则有：&lt;span class="math"&gt;\( R = AA' + D\)&lt;/span&gt;。取&lt;strong&gt;约相关矩阵&lt;/strong&gt;&lt;span class="math"&gt;\(R^* = R - D = AA'\)&lt;/span&gt;，假设特殊方差&lt;span class="math"&gt;\(\sigma_i^2\)&lt;/span&gt;的一个估计值&lt;span class="math"&gt;\(\hat{\sigma}^2\)&lt;/span&gt;为初始估计，则有约相关矩阵的估计值为：&lt;/p&gt;
&lt;p&gt;&lt;img alt="eq2_1" src="/images/article/a35/eq2_1.png"&gt;&lt;/p&gt;
&lt;p&gt;其中 &lt;span class="math"&gt;\(\hat{R}\)&lt;/span&gt; 为样本相关矩阵，&lt;span class="math"&gt;\( \hat{D} = diag(\hat{\sigma^2_1},\hat{\sigma_2^2}, \dots, \hat{\sigma_p^2})\)&lt;/span&gt;, &lt;span class="math"&gt;\(\hat{h_i^2} = 1 - \hat{\sigma_i^2}\)&lt;/span&gt; 为 &lt;span class="math"&gt;\(h_i^2\)&lt;/span&gt; 的初始估计。&lt;/p&gt;
&lt;p&gt;计算 &lt;span class="math"&gt;\(\hat{R}^*\)&lt;/span&gt; 的特征值，取足够小，但累计贡献率达到要求的m：&lt;span class="math"&gt;\(\hat{\lambda^*_1} \geqslant \hat{\lambda^*_2} \geqslant \dots \geqslant \hat{\lambda^*_m} &amp;gt; 0\)&lt;/span&gt;，其对应的特征向量为：&lt;span class="math"&gt;\(\hat{t^*_1}, \hat{t^*_2}, \dots, \hat{t^*_m}\)&lt;/span&gt;，则得到 &lt;span class="math"&gt;\(A\)&lt;/span&gt; 的估计值：&lt;/p&gt;
&lt;div class="math"&gt;$$ \hat{A} = (\sqrt{\hat{\lambda^*_1}}t^*_1, \sqrt{\hat{\lambda^*_2}}t^*_2, \dots, \sqrt{\hat{\lambda^*_m}}t^*_m ) $$&lt;/div&gt;
&lt;p&gt;那么 &lt;span class="math"&gt;\(\sigma^2_i\)&lt;/span&gt; 的最终估计为：&lt;span class="math"&gt;\( \hat{\sigma_i^2} = 1-\hat{h_i^2} = 1 - \sum_{j=1}^{m} \hat{a_{ij}^2}\)&lt;/span&gt;。&lt;/p&gt;
&lt;p&gt;可以看到，这是一个可以迭代的过程，我们可以一直迭代，直到结果达到稳定为止！从过程来看，这里其实也是利用了主成分，因而，主因子法也是主成分法的一种修正！&lt;/p&gt;
&lt;p&gt;那么接下来的问题就是，这个特殊方差 &lt;span class="math"&gt;\(\sigma^2_i\)&lt;/span&gt; 的初始估计值应该如何取呢？最常用的取法：&lt;span class="math"&gt;\( \hat{\sigma_i^2} = 1/r^{ii}\)&lt;/span&gt;, 其中 &lt;span class="math"&gt;\( r^{ii}\)&lt;/span&gt; 为 &lt;span class="math"&gt;\(\hat{R}^{-1}\)&lt;/span&gt; 对角线元素的第 &lt;span class="math"&gt;\(i\)&lt;/span&gt; 个。&lt;/p&gt;
&lt;hr&gt;
&lt;h4&gt;3. 极大似然法&lt;/h4&gt;
&lt;hr&gt;
&lt;p&gt;使用极大似然估计，那么就肯定需要使用样本的分布，这里我们假定公共因子 &lt;span class="math"&gt;\(f \sim N_m(0, I)\)&lt;/span&gt;，特殊因子 &lt;span class="math"&gt;\( \varepsilon \sim N_p(0, D)\)&lt;/span&gt;，并且相互独立！这里的假设其实就是来源于模型的正交性假设，只不过是将正交性假设进一步限定，假设它们都是属于多元正态分布！&lt;/p&gt;
&lt;p&gt;有了上述假设，通过模型就可以知道 &lt;span class="math"&gt;\(x \sim N_p(\mu, \Sigma)\)&lt;/span&gt;，有了这个就可以计算样本的似然函数了，这里涉及到较为复杂的矩阵计算，不想多说，有兴趣的话可以查找一些资料；或者学习一下线性模型中关于矩阵求导的知识，然后自己推导一下。&lt;/p&gt;
&lt;p&gt;一般情况下，极大似然法使用得并不太多，因为这个方法是算不出显式解的，在没有限制条件的情况下，解也并不唯一确定！但是如果是在因子分部可以明显知道的情况下，使用这个方法就比较好了！&lt;/p&gt;
&lt;hr&gt;
&lt;h3&gt;总结&lt;/h3&gt;
&lt;hr&gt;
&lt;p&gt;到这边，对于基础的因子模型就介绍结束了。回顾一下，主要就是介绍了正交因子模型以及它的参数估计问题。但是，到这里，我们还没有说到模型中的公共因子如何解释这个问题！对于这个问题的解释，通常结合实际的问题，需要一定的专业知识和经验，然后才能给每个公共因子给出一个实际意义。而且，公共因子的解释，在很大程度上也依赖于因子模型中因子载荷矩阵的元素结构！这个时候就会牵扯出因子分析中其它的一些问题：&lt;strong&gt;因子旋转&lt;/strong&gt;和&lt;strong&gt;因子得分&lt;/strong&gt;。因为这两个问题涉及到一些比较复杂的数学知识，我不能够在清减数学的情况下说好它，如果单说怎么用，我觉得没有必要，所以暂时并不打算介绍这两个问题。有兴趣的，可以翻阅一些多元统计的书籍，一般都会有讲。&lt;/p&gt;
&lt;script type="text/javascript"&gt;if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var align = "center",
        indent = "0em",
        linebreak = "false";

    if (false) {
        align = (screen.width &lt; 768) ? "left" : align;
        indent = (screen.width &lt; 768) ? "0em" : indent;
        linebreak = (screen.width &lt; 768) ? 'true' : linebreak;
    }

    var mathjaxscript = document.createElement('script');
    var location_protocol = (false) ? 'https' : document.location.protocol;
    if (location_protocol !== 'http' &amp;&amp; location_protocol !== 'https') location_protocol = 'https:';
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = location_protocol + '//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML';
    mathjaxscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: '"+ align +"'," +
        "    displayIndent: '"+ indent +"'," +
        "    showMathMenu: true," +
        "    messageStyle: 'normal'," +
        "    tex2jax: { " +
        "        inlineMath: [ ['\\\\(','\\\\)'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'inherit ! important'} }," +
        "        linebreaks: { automatic: "+ linebreak +", width: '90% container' }," +
        "    }, " +
        "}); " +
        "if ('default' !== 'default') {" +
            "MathJax.Hub.Register.StartupHook('HTML-CSS Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax['HTML-CSS'].FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
            "MathJax.Hub.Register.StartupHook('SVG Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax.SVG.FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
        "}";
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
&lt;/script&gt;</content><category term="data science"></category><category term="r"></category><category term="machine learning"></category></entry><entry><title>因子分析1</title><link href="//jacky-sj/factor-analysis-1.html" rel="alternate"></link><published>2014-05-14T16:05:00+08:00</published><updated>2017-03-29T20:30:00+08:00</updated><author><name>Jacky Gong</name></author><id>tag:jacky-sj,2014-05-14:/factor-analysis-1.html</id><summary type="html">&lt;p&gt;因子分析简介 1&lt;/p&gt;</summary><content type="html">&lt;p&gt;&lt;em&gt;“文章原创，转载请注明出处”&lt;/em&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;&lt;em&gt;updata:&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;感谢谢老大的提醒，让我发觉，在机器学习下放置因子分析并不合适。详细情况参见文章的回复板块。&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;前一篇介绍的主成分分析(PCA)，是一种降维技术；这一篇介绍的因子分析也是一种降维的方法，不仅如此，还可以将因子分析看作是主成分分析的一种推广和发展。与之主成分分析相比较，因子分析更为灵活，对变量降维后的解释能够更加清楚。&lt;/p&gt;
&lt;p&gt;但因子分析和主成分分析有非常多的不同点。&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;主成分分析不能作为一个模型来描述，主成分是观测变量的线性组合；&lt;/li&gt;
&lt;li&gt;因子分析需要构造因子模型，观测的原始变量是因子的线性组合。&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h4&gt;初窥&lt;/h4&gt;
&lt;hr&gt;
&lt;p&gt;在介绍因子模型之前，可以先看看这个因子分析到底是要干什么，以及是怎么干的！&lt;/p&gt;
&lt;p&gt;在二维空间中，主成分分析，它想做的是寻找一组新的变量 &lt;span class="math"&gt;\(y_1,y_2\)&lt;/span&gt;，用它去替代原来的变量 &lt;span class="math"&gt;\(x_1,x_2\)&lt;/span&gt;，并且满足 &lt;span class="math"&gt;\(y_1\)&lt;/span&gt; 和 &lt;span class="math"&gt;\(y_2\)&lt;/span&gt; 这两个变量都是 &lt;span class="math"&gt;\(x_1,x_2\)&lt;/span&gt; 两个变量的线性组合！即：&lt;/p&gt;
&lt;p&gt;&lt;img alt="eq1" src="/images/article/a34/eq1.jpg"&gt;&lt;/p&gt;
&lt;p&gt;而在因子模型中，我们需要做的跟此不同。我们需要找到一组潜在变量(不可观测)，用这组潜在变量的线性组合去表示原始变量 &lt;span class="math"&gt;\(x_1,x_2\)&lt;/span&gt;。这里假设有1个潜在变量 &lt;span class="math"&gt;\(f_1\)&lt;/span&gt;，那么因子模型可以描述成：&lt;/p&gt;
&lt;p&gt;&lt;img alt="eq2" src="/images/article/a34/eq2.png"&gt;&lt;/p&gt;
&lt;p&gt;其中，&lt;span class="math"&gt;\(f_1\)&lt;/span&gt; 就是因子，称为&lt;strong&gt;公共因子&lt;/strong&gt;；&lt;span class="math"&gt;\(a_{ij}\)&lt;/span&gt; 称之为变量 &lt;span class="math"&gt;\(x_i\)&lt;/span&gt; 在因子 &lt;span class="math"&gt;\(f_j\)&lt;/span&gt; 上的&lt;strong&gt;载荷&lt;/strong&gt;；&lt;span class="math"&gt;\(\mu_i\)&lt;/span&gt; 是 &lt;span class="math"&gt;\(x_i\)&lt;/span&gt; 的均值；&lt;span class="math"&gt;\(\varepsilon_i\)&lt;/span&gt; 为特殊因子，即不能被公共因子解释的部分。&lt;/p&gt;
&lt;hr&gt;
&lt;h4&gt;正交因子模型&lt;/h4&gt;
&lt;hr&gt;
&lt;p&gt;首先看看最基础的因子模型，就是正交假设下的因子模型：&lt;/p&gt;
&lt;p&gt;&lt;img alt="eq3" src="/images/article/a34/eq3.png"&gt;&lt;/p&gt;
&lt;p&gt;在给出假定之前，我们先将上面式子转换成矩阵形式：&lt;/p&gt;
&lt;div class="math"&gt;$$ x = \mu + Af + \varepsilon $$&lt;/div&gt;
&lt;p&gt;其中，&lt;span class="math"&gt;\(x = (x_1, x_2, \dots, x_p)'\)&lt;/span&gt;，&lt;span class="math"&gt;\(\mu = (\mu_1, \mu_2, \dots, \mu_p)'\)&lt;/span&gt; 为均值向量，&lt;span class="math"&gt;\(\varepsilon = (\varepsilon_1, \varepsilon_2, \dots, \varepsilon_p)'\)&lt;/span&gt; 为特殊因子向量, &lt;span class="math"&gt;\(f = (f_1, f_2, \dots, f_p)'\)&lt;/span&gt; 为公共因子向量，$ A = (a_{ij}):p \times m $ 为载荷矩阵。那么我们就可以给出如下的正交假设：&lt;/p&gt;
&lt;p&gt;&lt;img alt="eq4" src="/images/article/a34/eq4.png"&gt;&lt;/p&gt;
&lt;p&gt;在这样的假定下，我们首先来计算一下，原始变量 &lt;span class="math"&gt;\(x\)&lt;/span&gt; 的协方差：&lt;/p&gt;
&lt;div class="math"&gt;$$ \Sigma = V(x) = V(Af+\varepsilon) = Cov(Af+\varepsilon,Af+\varepsilon) $$&lt;/div&gt;
&lt;p&gt;又：&lt;span class="math"&gt;\(Cov(Af+\varepsilon,Af+\varepsilon)=AV(f)A'+ACov(f,\varepsilon)+Cov(\varepsilon,f)A'+V(\varepsilon)\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;由于 &lt;span class="math"&gt;\(V(f) = I, Cov(f, \varepsilon) = Cov(\varepsilon, f) = 0\)&lt;/span&gt;，所以：&lt;/p&gt;
&lt;div class="math"&gt;$$ \Sigma = AA' + V(\varepsilon) = AA' + D $$&lt;/div&gt;
&lt;p&gt;&lt;strong&gt;显然，我们要处理正交因子模型，最重要的就是求解 &lt;span class="math"&gt;\(A,D\)&lt;/span&gt; 的估计值，那么这里就给出了这两个量与原始变量的协方差矩阵间的关系。&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;那么我们开始所说的，因子分析也是一种降维手段体现在哪里呢？&lt;/strong&gt;这个就体现在，公共因子的数量上，当公共因子的数量少于原始变量的数量时，使用因子去解释原始变量就达到了一种降维的目的！&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;&lt;strong&gt;&lt;em&gt;载荷矩阵&lt;/em&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;显然，载荷矩阵 &lt;span class="math"&gt;\(A\)&lt;/span&gt; 是我们关心的一个重点。首先，我们想弄明白 &lt;span class="math"&gt;\(A\)&lt;/span&gt; 中的元素 &lt;span class="math"&gt;\(a_{ij}\)&lt;/span&gt; 是否有什么具体的含义：&lt;/p&gt;
&lt;div class="math"&gt;$$Cov(x_i,f_j)=Cov(\sum_{k=1}^{m}a_{ik}f_k + \varepsilon_i, f_j) =a_{ij}Cov(f_j,f_j) = a_{ij} $$&lt;/div&gt;
&lt;p&gt;那么可以看到，&lt;span class="math"&gt;\(a_{ij}\)&lt;/span&gt; 是 &lt;span class="math"&gt;\(x_i\)&lt;/span&gt; 和 &lt;span class="math"&gt;\(f_j\)&lt;/span&gt; 之间的协方差函数。&lt;/p&gt;
&lt;p&gt;经过上面的计算，我们容易得到：&lt;/p&gt;
&lt;div class="math"&gt;$$V(x_i) = a_{i1}^2 + a_{i2}^2 + \dots + a_{1m}^2 + V(\varepsilon_i)$$&lt;/div&gt;
&lt;p&gt;记 &lt;span class="math"&gt;\(h_i^2 = \sum_{j=1}^{m}a_{ij}^2\)&lt;/span&gt;，那么上式可转化为：&lt;/p&gt;
&lt;div class="math"&gt;$$ (V(x_i) =) \sigma_{ii} = h_i^2 + \sigma_i^2, i=1,2,\dots,p$$&lt;/div&gt;
&lt;p&gt;这样就将 &lt;span class="math"&gt;\(x_i\)&lt;/span&gt; 的方差进行了一个分解，一部分由公共因子解释，即 &lt;span class="math"&gt;\(h_i^2\)&lt;/span&gt;，称为&lt;strong&gt;共性方差&lt;/strong&gt;；另一部分由特殊因子解释，即 &lt;span class="math"&gt;\(\sigma_i^2\)&lt;/span&gt;，称为&lt;strong&gt;特殊方差&lt;/strong&gt;。&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;至此，因子分析的基础模型就介绍完了，下面剩下的就是如何去进行参数的估计，这一般有三种方法：主成分法、主因子法以及极大似然法。下一篇，我们就来详细说说因子分析的参数估计问题。&lt;/p&gt;
&lt;script type="text/javascript"&gt;if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var align = "center",
        indent = "0em",
        linebreak = "false";

    if (false) {
        align = (screen.width &lt; 768) ? "left" : align;
        indent = (screen.width &lt; 768) ? "0em" : indent;
        linebreak = (screen.width &lt; 768) ? 'true' : linebreak;
    }

    var mathjaxscript = document.createElement('script');
    var location_protocol = (false) ? 'https' : document.location.protocol;
    if (location_protocol !== 'http' &amp;&amp; location_protocol !== 'https') location_protocol = 'https:';
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = location_protocol + '//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML';
    mathjaxscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: '"+ align +"'," +
        "    displayIndent: '"+ indent +"'," +
        "    showMathMenu: true," +
        "    messageStyle: 'normal'," +
        "    tex2jax: { " +
        "        inlineMath: [ ['\\\\(','\\\\)'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'inherit ! important'} }," +
        "        linebreaks: { automatic: "+ linebreak +", width: '90% container' }," +
        "    }, " +
        "}); " +
        "if ('default' !== 'default') {" +
            "MathJax.Hub.Register.StartupHook('HTML-CSS Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax['HTML-CSS'].FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
            "MathJax.Hub.Register.StartupHook('SVG Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax.SVG.FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
        "}";
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
&lt;/script&gt;</content><category term="data science"></category><category term="r"></category><category term="machine learning"></category></entry><entry><title>数据科学之机器学习15: 主成分分析</title><link href="//jacky-sj/pca.html" rel="alternate"></link><published>2014-05-11T11:35:00+08:00</published><updated>2017-03-29T20:30:00+08:00</updated><author><name>Jacky Gong</name></author><id>tag:jacky-sj,2014-05-11:/pca.html</id><summary type="html">&lt;p&gt;PCA 简介&lt;/p&gt;</summary><content type="html">&lt;p&gt;&lt;em&gt;“文章原创，转载请注明出处”&lt;/em&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;在之前&lt;a href="http://jackycode.github.io/blog/2014/04/02/linear-regression3/"&gt;线性回归3&lt;/a&gt;提到多重共线性问题，当时说了一些解决这个问题的办法，其中一种就是今天要说的&lt;strong&gt;主成分分析&lt;/strong&gt;。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;主成分分析&lt;/strong&gt;，Principal Components Analysis，简称PCA，是变量选择的一种方法。其一般的目的就是：变量的降维和主成分的解释！当主成分用于聚类或者回归，这个时候就是在做变量的降维；而当用来分析变量，尤其是使用前两个主成分进行散点图的绘制时，此时就是在对变量利用主成分做出一些解释。在了解主成分分析的原理之后，相信对这两个目的就可以很容易直观的理解了！&lt;/p&gt;
&lt;hr&gt;
&lt;h4&gt;一、原理初窥&lt;/h4&gt;
&lt;hr&gt;
&lt;p&gt;在用数学公式和概率统计知识推导其原理之前，不妨先直观地看看主成分分析到底是要干嘛，以及大致是怎么干的！&lt;/p&gt;
&lt;p&gt;我们就用两个变量来说这个问题，变量分别记作 &lt;span class="math"&gt;\(x_1,x_2\)&lt;/span&gt;。那么，我们先画个散点图吧，也许它们的散点图是这个样子的：&lt;/p&gt;
&lt;p&gt;&lt;img alt="img1" src="/images/article/a33/images1.jpg"&gt;&lt;/p&gt;
&lt;p&gt;我们可以看到，这两个变量明显呈现一种线性关系，如果在做线性回归时，将这两个变量都用作自变量，然后对某一个因变量进行线性拟合，那必定会存在一些问题。那么主成分分析是要做什么呢？其实主成分分析就是要寻找变量 &lt;span class="math"&gt;\(y_1,y_2\)&lt;/span&gt; 去替代 &lt;span class="math"&gt;\(x_1,x_2\)&lt;/span&gt;，而且满足 &lt;span class="math"&gt;\(y_1,y_2\)&lt;/span&gt; 几乎不相关，同时 &lt;span class="math"&gt;\(y_1,y_2\)&lt;/span&gt; 能够保留 &lt;span class="math"&gt;\(x_1,x_2\)&lt;/span&gt; 所包含的信息。&lt;/p&gt;
&lt;p&gt;那么主成分分析是如何做的呢？这个时候就需要考虑旋转坐标轴，当我们像下图那样旋转过坐标轴之后，上面提出的要求就得到了实现。&lt;/p&gt;
&lt;p&gt;&lt;img alt="img2" src="/images/article/a33/images2.jpg"&gt;&lt;/p&gt;
&lt;p&gt;从这张图我们就可以看出，数据投影到 &lt;span class="math"&gt;\(y_1,y_2\)&lt;/span&gt; 两轴后，数据基本不相关，而且在 &lt;span class="math"&gt;\(y_1\)&lt;/span&gt; 轴就保留了原本数据的大部分信息，&lt;span class="math"&gt;\(y_2\)&lt;/span&gt; 保留了数据的另外一部分信息。由此可见，数据越是集中在 &lt;span class="math"&gt;\(y_1\)&lt;/span&gt; 轴两侧，数据映射到 &lt;span class="math"&gt;\(y_1\)&lt;/span&gt; 轴后保留的信息就越多，而 &lt;span class="math"&gt;\(y_2\)&lt;/span&gt; 就越少。当 &lt;span class="math"&gt;\(y_2\)&lt;/span&gt; 含有的信息非常少，少到接近于0时，那么此时就到达了变量选择的目的，因为此时只要保留 &lt;span class="math"&gt;\(y_1\)&lt;/span&gt; 就可以了。&lt;/p&gt;
&lt;hr&gt;
&lt;h4&gt;二、原理&lt;/h4&gt;
&lt;hr&gt;
&lt;p&gt;我们将数据映射到 &lt;span class="math"&gt;\(y_1,y_2\)&lt;/span&gt; 轴，其实就是将原数据做个线性变换。利用上面的内容举个简单地例子就是：&lt;/p&gt;
&lt;p&gt;&lt;img align="center" src="/images/article/a33/eq1.jpg" /&gt;&lt;/p&gt;
&lt;p&gt;其中的系数满足：&lt;span class="math"&gt;\(a_{11}^2 + a_{21}^2=1,a_{12}^2 + a_{22}^2=1\)&lt;/span&gt;。这样就可以成功地将数据投影到 &lt;span class="math"&gt;\(y_1,y_2\)&lt;/span&gt; 轴。这里我们考虑更一般的情况，考虑 &lt;span class="math"&gt;\(p\)&lt;/span&gt; 维的情况：&lt;/p&gt;
&lt;p&gt;&lt;img align="center" src="/images/article/a33/eq2.jpg" /&gt;&lt;/p&gt;
&lt;p&gt;其中 &lt;span class="math"&gt;\(a_i=(a_{1i},a_{2i},\dots,a_{pi})', i=1,2,\dots,p\)&lt;/span&gt;，且满足 &lt;span class="math"&gt;\(a_i'a_1=1\)&lt;/span&gt;。&lt;/p&gt;
&lt;p&gt;下面要考虑的就是，如何选择 &lt;span class="math"&gt;\(a_1\)&lt;/span&gt;，使得 &lt;span class="math"&gt;\(V(y_1)\)&lt;/span&gt; 到达最大，找到之后，&lt;span class="math"&gt;\(y_1\)&lt;/span&gt; 就是&lt;strong&gt;第一主成分&lt;/strong&gt;。&lt;/p&gt;
&lt;p&gt;首先，&lt;span class="math"&gt;\(V(y_1)=a_1' \Sigma a_1\)&lt;/span&gt;，其中 &lt;span class="math"&gt;\(\Sigma=V(x)\)&lt;/span&gt; 为协方差矩阵。我们知道 &lt;span class="math"&gt;\(\Sigma\)&lt;/span&gt; 是非负定的，那么其所有的特征值必定都是大于等于0的，我们可以排个序：&lt;span class="math"&gt;\(\lambda _{ 1 }\geqslant \lambda _{ 2 }\geqslant \dots \geqslant \lambda_p \geqslant 0\)&lt;/span&gt;，其对应的特征向量记为：&lt;span class="math"&gt;\(t_1, t_2, \dots, t_p\)&lt;/span&gt;，显然这些特征向量是相互正交的。记 &lt;span class="math"&gt;\(T=(t_1, t_2, \dots, t_p)=(t_{ik}), \Lambda=diag(\lambda_1,\lambda_2,\dots,\lambda_p)\)&lt;/span&gt;。&lt;/p&gt;
&lt;p&gt;那么根据谱分解就有：&lt;span class="math"&gt;\(\Sigma=T \Lambda T'=\sum_{i=1}^{p}\lambda_it_it_i'\)&lt;/span&gt;。那么带入到 &lt;span class="math"&gt;\(V(y_1)\)&lt;/span&gt; 中就有：&lt;/p&gt;
&lt;div class="math"&gt;$$V(y_1)=\sum_{i=1}^{p} \lambda_i a_1' t_it_i' a_1 = \sum_{i=1}^{p} \lambda_i(a_1't_i)^2$$&lt;/div&gt;
&lt;p&gt;由于特征值中 &lt;span class="math"&gt;\(\lambda_1\)&lt;/span&gt; 是最大的，那么就有：&lt;/p&gt;
&lt;div class="math"&gt;$$V(y_1) \leqslant \lambda_1 \sum_{i=1}^{p} (a_1't_i)^2 = \lambda_1 \sum_{i=1}^{p} {a_1't_it_i'a_1} = \lambda_1 a_1' TT'a_1 = \lambda_1$$&lt;/div&gt;
&lt;p&gt;可以看到最终的结果是：&lt;span class="math"&gt;\(V(y_1) \leqslant \lambda_1\)&lt;/span&gt;。那么什么时候取等号呢？取 &lt;span class="math"&gt;\(a_1 = t_1\)&lt;/span&gt;，则有：&lt;/p&gt;
&lt;div class="math"&gt;$$t_1'\Sigma t_1 = t_1' (\lambda_1t_1) = \lambda_1$$&lt;/div&gt;
&lt;p&gt;到止为止，就可以看到。当 &lt;span class="math"&gt;\(y_1=t_1'x\)&lt;/span&gt; 时就有其 &lt;span class="math"&gt;\(V(y_1)\)&lt;/span&gt; 达到最大，为 &lt;span class="math"&gt;\(\lambda_1\)&lt;/span&gt;。那么此时 &lt;span class="math"&gt;\(y_1=t_1'x\)&lt;/span&gt; 就是该数据第一主成分。&lt;/p&gt;
&lt;p&gt;同理可以求解第二主成分直至最后。&lt;strong&gt;但是，在求解第二第三主成分的时候，需要注意一个新的问题：主成分之间不相关，即 &lt;span class="math"&gt;\(Cov(y_i,y_k)=0,i \neq k\)&lt;/span&gt;&lt;/strong&gt;，如何证明非常简单，我就不说了，自己动动手吧。&lt;/p&gt;
&lt;hr&gt;
&lt;h4&gt;三、具体实例&lt;/h4&gt;
&lt;hr&gt;
&lt;p&gt;我们使用R语言来做个小例子：&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="code-line"&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;# 构造一个数据集&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;span class="kp"&gt;set.seed&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="m"&gt;10&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;x1 &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="kp"&gt;seq&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="m"&gt;50&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="m"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; rnorm&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="m"&gt;25&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; mean&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; sd&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;x2 &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="m"&gt;2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;x1 &lt;span class="o"&gt;+&lt;/span&gt; rnorm&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="m"&gt;25&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; mean&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; sd&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;x3 &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; x1&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="m"&gt;2&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; x2 &lt;span class="o"&gt;+&lt;/span&gt; rnorm&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="m"&gt;25&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; mean&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; sd&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;x &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="kt"&gt;data.frame&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;x1&lt;span class="o"&gt;=&lt;/span&gt;x1&lt;span class="p"&gt;,&lt;/span&gt; x2&lt;span class="o"&gt;=&lt;/span&gt;x2&lt;span class="p"&gt;,&lt;/span&gt; x3&lt;span class="o"&gt;=&lt;/span&gt;x3&lt;span class="p"&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;span class="c1"&gt;# 计算协方差矩阵&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;Sig &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; cov&lt;span class="p"&gt;(&lt;/span&gt;x&lt;span class="p"&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;span class="c1"&gt;# 计算特征值和特征向量&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;span class="kp"&gt;eigen&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;Sig&lt;span class="p"&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;得到结果如下：&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="code-line"&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="o"&gt;$&lt;/span&gt;values&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="m"&gt;2381.3724526&lt;/span&gt;    &lt;span class="m"&gt;0.3681085&lt;/span&gt;    &lt;span class="m"&gt;0.1165201&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;span class="o"&gt;$&lt;/span&gt;vectors&lt;/span&gt;
&lt;span class="code-line"&gt;           &lt;span class="p"&gt;[,&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;       &lt;span class="p"&gt;[,&lt;/span&gt;&lt;span class="m"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;        &lt;span class="p"&gt;[,&lt;/span&gt;&lt;span class="m"&gt;3&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,]&lt;/span&gt; &lt;span class="m"&gt;-0.2982259&lt;/span&gt; &lt;span class="m"&gt;-0.4601189&lt;/span&gt;  &lt;span class="m"&gt;0.83627265&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="m"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,]&lt;/span&gt; &lt;span class="m"&gt;-0.6002191&lt;/span&gt; &lt;span class="m"&gt;-0.5908325&lt;/span&gt; &lt;span class="m"&gt;-0.53912331&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="m"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,]&lt;/span&gt; &lt;span class="m"&gt;-0.7421579&lt;/span&gt;  &lt;span class="m"&gt;0.6627273&lt;/span&gt;  &lt;span class="m"&gt;0.09997061&lt;/span&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;得到了特征值为：&lt;span class="math"&gt;\(\lambda_1=238.372, \lambda_2=0.368, \lambda_3=0.11652\)&lt;/span&gt;，可以看到第一主成分 &lt;span class="math"&gt;\(y_1=t_1'x=-0.298x_1-0.600x_2-0.742x_3\)&lt;/span&gt; 的特征值 &lt;span class="math"&gt;\(\lambda_1\)&lt;/span&gt; 的值远大于其余的(由于数据构造时就是以 &lt;span class="math"&gt;\(x_1\)&lt;/span&gt; 为底的)。说明第一主成分能够解释数据的大部分信息，那么如何衡量呢？&lt;/p&gt;
&lt;p&gt;这时候就需要使用到&lt;strong&gt;贡献率&lt;/strong&gt;这个概念，某一个主成分 &lt;span class="math"&gt;\(y_i\)&lt;/span&gt; 的贡献率定义为：&lt;span class="math"&gt;\(\frac{\lambda_i}{\sum_{i=1}^{p} \lambda_i}\)&lt;/span&gt;。&lt;/p&gt;
&lt;p&gt;贡献率越大说明这个主成分能够解释数据的信息就越多，在具体的问题中，还常常用到一个概念，就是&lt;strong&gt;累积贡献率&lt;/strong&gt;。前 &lt;span class="math"&gt;\(k\)&lt;/span&gt; 个主成分的累计贡献率就是：&lt;span class="math"&gt;\(\frac{\sum_{i=1}^{k} \lambda_i}{\sum_{i=1}^{p} \lambda_i}\)&lt;/span&gt;。实际中，当前 &lt;span class="math"&gt;\(k\)&lt;/span&gt; 个主成分的累积贡献率达到某个临界值，比如 &lt;span class="math"&gt;\(80\%\)&lt;/span&gt;，就选择前 &lt;span class="math"&gt;\(k\)&lt;/span&gt; 个主成分进行下一步操作(比如说聚类，回归或者单纯地做分析等等)&lt;/p&gt;
&lt;h4&gt;四、基于相关矩阵&lt;/h4&gt;
&lt;hr&gt;
&lt;p&gt;考虑这样两种情况：各个变量的单位不全相同，也就是数据的量纲不同；各变量之间的单位相同，但是变量的方差较大，也就是数值大小相差较大。那么这个时候，如果从协方差矩阵出发求解主成分，就显得不大合适了。&lt;/p&gt;
&lt;p&gt;在之前的文章中提到过，当所有的变量都进行了标准化之后，协方差矩阵 &lt;span class="math"&gt;\(\Sigma\)&lt;/span&gt; 就转换成了相关矩阵 &lt;span class="math"&gt;\(R\)&lt;/span&gt;！&lt;/p&gt;
&lt;p&gt;那么，剩下的求解过程就与上面相同了，这里不再叙述。需要指出的是，标准化与否，所得到的结果可能会有很大的不同，所以，判断一批数据是否需要标准化是很有必要的！&lt;/p&gt;
&lt;h4&gt;五、R语言实现&lt;/h4&gt;
&lt;hr&gt;
&lt;p&gt;主成分分析的R语言实现比较简单，可以直接使用&lt;code&gt;eigen()&lt;/code&gt;函数求出特征值特征向量。当然也有自带的函数：&lt;code&gt;princomp()&lt;/code&gt;以及&lt;code&gt;psych&lt;/code&gt;包中的&lt;code&gt;principal()&lt;/code&gt;函数，可以自己查找一下帮助文档，这里就不做介绍了。&lt;/p&gt;
&lt;script type="text/javascript"&gt;if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var align = "center",
        indent = "0em",
        linebreak = "false";

    if (false) {
        align = (screen.width &lt; 768) ? "left" : align;
        indent = (screen.width &lt; 768) ? "0em" : indent;
        linebreak = (screen.width &lt; 768) ? 'true' : linebreak;
    }

    var mathjaxscript = document.createElement('script');
    var location_protocol = (false) ? 'https' : document.location.protocol;
    if (location_protocol !== 'http' &amp;&amp; location_protocol !== 'https') location_protocol = 'https:';
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = location_protocol + '//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML';
    mathjaxscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: '"+ align +"'," +
        "    displayIndent: '"+ indent +"'," +
        "    showMathMenu: true," +
        "    messageStyle: 'normal'," +
        "    tex2jax: { " +
        "        inlineMath: [ ['\\\\(','\\\\)'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'inherit ! important'} }," +
        "        linebreaks: { automatic: "+ linebreak +", width: '90% container' }," +
        "    }, " +
        "}); " +
        "if ('default' !== 'default') {" +
            "MathJax.Hub.Register.StartupHook('HTML-CSS Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax['HTML-CSS'].FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
            "MathJax.Hub.Register.StartupHook('SVG Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax.SVG.FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
        "}";
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
&lt;/script&gt;</content><category term="data science"></category><category term="r"></category><category term="machine learning"></category></entry><entry><title>数据科学之机器学习14: 关联分析之apriori算法</title><link href="//jacky-sj/association-analysis-apriori.html" rel="alternate"></link><published>2014-05-07T17:00:00+08:00</published><updated>2017-03-29T20:30:00+08:00</updated><author><name>Jacky Gong</name></author><id>tag:jacky-sj,2014-05-07:/association-analysis-apriori.html</id><summary type="html">&lt;p&gt;Apriori 算法&lt;/p&gt;</summary><content type="html">&lt;p&gt;&lt;em&gt;“文章原创，转载请注明出处”&lt;/em&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;在上一篇中，我们介绍了关联分析相关的概念，这一节来看看如何使用Apriori算法去寻找满足条件的项集。&lt;/p&gt;
&lt;p&gt;首先回顾一个概念，&lt;strong&gt;一个项集的支持度&lt;/strong&gt;就是数据集中该项集所占的比例。Apriori算法就是用于寻找数据集中，支持度和可信度超过某一给定值的项集和关联规则。&lt;/p&gt;
&lt;hr&gt;
&lt;h4&gt;一、原理&lt;/h4&gt;
&lt;hr&gt;
&lt;p&gt;在介绍算法之前，首先了解一个集合论中的性质定理：集合的向下封闭性。&lt;/p&gt;
&lt;p&gt;我们通过一个例子来看看这个定理，见下图：&lt;/p&gt;
&lt;p&gt;&lt;img alt="apriori1" src="/images/article/31-apriori/apriori_1.jpg"&gt;&lt;/p&gt;
&lt;p&gt;集合的向下封闭性，在这边解释的话，也就是说，&lt;strong&gt;如果一个项集的支持度低于某一个值，那么该项集超集的支持度也必定低于这个值。如果一个项集的支持度高于某一个值，那么该项集子集的支持度也必定高于某一个值。&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;超集&lt;/strong&gt;：就是指包含这个集合中所以元素的集合（不包括自身），比如集合ABC就是集合AB的超集。&lt;/p&gt;
&lt;p&gt;那么这个定理放在上一个图当中，就有这样的含义：&lt;/p&gt;
&lt;p&gt;&lt;img alt="apriori2" src="/images/article/31-apriori/apriori_2.jpg"&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;h4&gt;二、算法构成&lt;/h4&gt;
&lt;hr&gt;
&lt;p&gt;有了上面这个原理，那么就可以利用这个原理去减少我们寻找频繁集的计算量。因为，只要我们找到一个项集，其支持度低于给定的值，那么这个项集的所有超集就可以直接忽略不计了。如上图，项集A的支持度低于指定的值，那么其超集就都不用再考虑了。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Apriori算法由两部分构成：&lt;/strong&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;找到满足最小支持度的项集；&lt;/li&gt;
&lt;li&gt;找到可信度超过最小可信度的关联规则。&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;下面，我们一个一个地解决：&lt;/p&gt;
&lt;hr&gt;
&lt;h5&gt;2.1. 寻找频繁项集&lt;/h5&gt;
&lt;hr&gt;
&lt;p&gt;利用上面所讲的原理，我们来整理一下这个步骤的流程：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;从数据集中构造集合C1，C1满足：大小为1的所有候选项集的集合，例如上图中的：C1 = {A, B, C};&lt;/li&gt;
&lt;li&gt;计算C1中所有项集（单元素项集）是否满足最小支持度，满足的项集构成集合L1，例如上图中的：L1 = {B, C};&lt;/li&gt;
&lt;li&gt;利用L1生成新的候选项集C2，C2满足：大小为2的所有候选项集的集合，例如上图中得：C2 = {BC};&lt;/li&gt;
&lt;li&gt;计算C2中所有项集（双元素项集）是否满足最小支持度，满足的项集构成集合L2；&lt;/li&gt;
&lt;li&gt;重复直到Lk中得元素个数为1。&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h5&gt;2.2. 寻找关联规则&lt;/h5&gt;
&lt;hr&gt;
&lt;p&gt;在得到频繁项集之后，要寻找关联规则就容易多了。可以直接从频繁项集中构造初始的关联规则，计算该关联规则的可信度，然后与给定的最小可信度作比较，若值大于最小可信度，则记录该关联规则。&lt;/p&gt;
&lt;p&gt;在实际编程时，需要注意使用&lt;strong&gt;集合的向下封闭性&lt;/strong&gt;！！！想想看，在关联规则中，这个性质应该怎样去实现？(可以到Machine Learning in Action中找答案！)&lt;/p&gt;
&lt;h4&gt;三、R语言实现&lt;/h4&gt;
&lt;h5&gt;1. 使用自带的程序&lt;/h5&gt;
&lt;p&gt;在R语言的&lt;code&gt;arules&lt;/code&gt;这个包里面，提供了一个实现Apriori算法的函数：&lt;code&gt;apriori()&lt;/code&gt;：&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="code-line"&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;# 构造数据集&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;dataSet &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="kt"&gt;matrix&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="m"&gt;5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="m"&gt;3&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;span class="kp"&gt;rownames&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;dataSet&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="kp"&gt;paste&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;item&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="m"&gt;5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; sep&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;span class="kp"&gt;colnames&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;dataSet&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="kt"&gt;c&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;A&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;B&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;C&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;dataSet&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,]&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="kt"&gt;c&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;dataSet&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="m"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,]&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="kt"&gt;c&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;dataSet&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="m"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,]&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="kt"&gt;c&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;dataSet&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="m"&gt;4&lt;/span&gt;&lt;span class="p"&gt;,]&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="kt"&gt;c&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;dataSet&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="m"&gt;5&lt;/span&gt;&lt;span class="p"&gt;,]&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="kt"&gt;c&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;dataSet&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;span class="c1"&gt;# 转换数据格式(可以?apriori查看数据格式)&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;dataSet_class &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; as&lt;span class="p"&gt;(&lt;/span&gt;dataSet&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;transactions&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;span class="c1"&gt;# 构造频繁项集&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;rules&lt;span class="o"&gt;&amp;lt;-&lt;/span&gt;apriori&lt;span class="p"&gt;(&lt;/span&gt;dataSet_class&lt;span class="p"&gt;,&lt;/span&gt;parameter&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kt"&gt;list&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;supp&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;0.5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;conf&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;0.6&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;target&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;rules&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;span class="c1"&gt;# 查看结果&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;span class="kp"&gt;summary&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;rules&lt;span class="p"&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;span class="c1"&gt;# 构造关联规则&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;inspect&lt;span class="p"&gt;(&lt;/span&gt;rules&lt;span class="p"&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h5&gt;2. 自定义函数解决&lt;/h5&gt;
&lt;p&gt;相对而言，Apriori算法的函数比较难以编写，原因可想而知，肯定是因为数据结构的问题！但是也只是比其他函数难编一点，毕竟其自带的数据结构功能还是非常强大的。我在&lt;a href="https://github.com/JackyCode/Data_Science"&gt;我的项目&lt;/a&gt;中给出的一种编写方式，是利用R语言的list来实现的。不过，我想，利用Matrix或者data.frame，当然如果你还懂&lt;code&gt;data.table&lt;/code&gt;的话，那么肯定也是可以编写的，而且我想应该会比用list简单！(没有亲手编写，只是猜想！)&lt;/p&gt;
&lt;p&gt;详见&lt;a href="https://github.com/JackyCode/Data_Science"&gt;我的项目&lt;/a&gt;&lt;/p&gt;</content><category term="data science"></category><category term="r"></category><category term="machine learning"></category><category term="association analysis"></category></entry><entry><title>数据科学之机器学习13: 关联分析</title><link href="//jacky-sj/association-analysis.html" rel="alternate"></link><published>2014-05-04T10:12:00+08:00</published><updated>2017-03-29T20:30:00+08:00</updated><author><name>Jacky Gong</name></author><id>tag:jacky-sj,2014-05-04:/association-analysis.html</id><summary type="html">&lt;p&gt;关联分析算法&lt;/p&gt;</summary><content type="html">&lt;p&gt;&lt;em&gt;“文章原创，转载请注明出处”&lt;/em&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;h4&gt;一、简介&lt;/h4&gt;
&lt;hr&gt;
&lt;p&gt;在统计学中，变量与变量之间的关系是统计结构的重要参数，统计的核心问题也就是研究变量与变量之间的关系。如果变量与变量之间不独立，那么这两个变量之间肯定存在一定的关联性，那么如何处理度量这个关联性，在统计中就称为关联分析。&lt;/p&gt;
&lt;p&gt;列联表是传统统计学中度量两个分类变量之间关系强弱的方法，但是这个方法是对于两个固定的变量进行的一种测量。在机器学习中，常常会遇到大规模的变量，这时候更倾向于从众多的变量中最快地找到关联性最强的两组或多组变量。那么使用列联表就显得不太合适了，此时应该使用什么方法呢？&lt;/p&gt;
&lt;hr&gt;
&lt;h4&gt;二、关联规则&lt;/h4&gt;
&lt;hr&gt;
&lt;p&gt;首先介绍2个定义：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;k项集：&lt;/strong&gt;设 &lt;span class="math"&gt;\(I = \{ i_1, i_2, \dots, i_m \}\)&lt;/span&gt; 是 &lt;span class="math"&gt;\(m\)&lt;/span&gt; 个待研究的项构成的有限项集，对于给定的事物数据表 &lt;span class="math"&gt;\(T = \{ T_1, T_2, \dots, T_n \}\)&lt;/span&gt;，其中任意的 &lt;span class="math"&gt;\(T_i\)&lt;/span&gt; 是 &lt;span class="math"&gt;\(I\)&lt;/span&gt; 中的 &lt;span class="math"&gt;\(k\)&lt;/span&gt; 项组成的集合，称之为&lt;strong&gt;k项集&lt;/strong&gt;。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;关联规则&lt;/strong&gt;：形如 &lt;span class="math"&gt;\( X \rightarrow Y\)&lt;/span&gt; 的形式，其中 &lt;span class="math"&gt;\( X \subseteq I\)&lt;/span&gt;, &lt;span class="math"&gt;\(Y \subseteq I\)&lt;/span&gt;，且有 &lt;span class="math"&gt;\( X \bigcap Y = \emptyset\)&lt;/span&gt;。&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h5&gt;度量方式&lt;/h5&gt;
&lt;hr&gt;
&lt;p&gt;对于一个项集，我们正常用支持度来度量它的频繁程度，其实就是其在数据集中出现的比例，这个很容易理解，就不多说了。&lt;/p&gt;
&lt;p&gt;那么下面要讨论的就是：&lt;strong&gt;如何度量一个关联规则&lt;/strong&gt;。一般使用下面两个概念：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;支持度S&lt;/strong&gt;：定义为X和Y同时出现在一个事务中得可能性，即：
    &lt;span class="math"&gt;\( S(X \Rightarrow Y) = \mid T(X \vee Y) \mid / \mid T \mid\)&lt;/span&gt;
    其中，&lt;span class="math"&gt;\(\mid T(X \vee Y) \mid\)&lt;/span&gt; 表示同时包含X和Y的事务数，&lt;span class="math"&gt;\(\mid T \mid\)&lt;/span&gt; 表示总事务数。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;支持度C&lt;/strong&gt;：定义为出现在关联规则前项中得事务中出现关联规则后项的比例，即：
    &lt;span class="math"&gt;\( C(X \Rightarrow Y) = \mid T(X \vee Y) \mid / \mid T(X) \mid\)&lt;/span&gt;
    其中，&lt;span class="math"&gt;\( \mid T(X) \mid\)&lt;/span&gt; 表示包含X的事务数。&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h5&gt;例子&lt;/h5&gt;
&lt;hr&gt;
&lt;p&gt;这边举个简单地例子，方便理解上面的概念。比如设计一个购物数据：&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th align="center"&gt;id&lt;/th&gt;
&lt;th align="center"&gt;items&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td align="center"&gt;1&lt;/td&gt;
&lt;td align="center"&gt;AB&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align="center"&gt;2&lt;/td&gt;
&lt;td align="center"&gt;AC&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align="center"&gt;3&lt;/td&gt;
&lt;td align="center"&gt;C&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align="center"&gt;4&lt;/td&gt;
&lt;td align="center"&gt;ABC&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align="center"&gt;5&lt;/td&gt;
&lt;td align="center"&gt;BC&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;上面数据的意思，比如第一行就表示，id为1的人购买了A和B两个物品，其他的意思类似。那么这个AB就是一个2项集，因为存在ABC三种物品，这边就有6种关联规则：&lt;span class="math"&gt;\(A \Rightarrow B\)&lt;/span&gt;, &lt;span class="math"&gt;\(A \Rightarrow C\)&lt;/span&gt;, &lt;span class="math"&gt;\( B \Rightarrow C\)&lt;/span&gt;, &lt;span class="math"&gt;\( B \Rightarrow A\)&lt;/span&gt;, &lt;span class="math"&gt;\( C \Rightarrow A\)&lt;/span&gt;, &lt;span class="math"&gt;\( C \Rightarrow B\)&lt;/span&gt;。&lt;/p&gt;
&lt;p&gt;那么如何计算一个关联规则的支持度与可信度呢？&lt;/p&gt;
&lt;p&gt;试试关联规则 &lt;span class="math"&gt;\(A \Rightarrow B\)&lt;/span&gt;：&lt;/p&gt;
&lt;div class="math"&gt;$$ S(A \Rightarrow B) =  \mid T(A \vee B) \mid / \mid T \mid = 2/5 $$&lt;/div&gt;
&lt;div class="math"&gt;$$ C(A \Rightarrow B) =  \mid T(A \vee B) \mid / \mid T(A) \mid = 2/3 $$&lt;/div&gt;
&lt;p&gt;是不是很简单呢。试试计算一下其他的关联规则，多算几次就能够很了解其中的含义了。&lt;/p&gt;
&lt;hr&gt;
&lt;h5&gt;关联规则的作用&lt;/h5&gt;
&lt;hr&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;关联规则的目的在于，找到变量之间支持度和可信度都比较高的那些关联规则。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;关联规则的支持度，用于度量关联规则在数据库中得普适程度，是对关联规则重要性(适用性)的一种度量。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;关联规则的可信度，这是一个相对指标，是对关联规则准确度的一个度量。值越高，代表这个关联规则的后项依赖前项的可能性比较高。&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h4&gt;小节&lt;/h4&gt;
&lt;hr&gt;
&lt;p&gt;这篇简单介绍了一下关联分析的一些概念问题，以及如何度量一个关联规则。但是，试想一想，要是 &lt;span class="math"&gt;\(I\)&lt;/span&gt; 中包含的项很多，事物数据表 &lt;span class="math"&gt;\(T\)&lt;/span&gt; 也很大，那么要计算所有关联规则的支持度和可信度，难度可想而知！这时候就需要使用一些算法去解决这个问题，现在比较流行的算法就是：处理静态关联规则的Apriori算法和处理动态关联规则的Carma算法。&lt;/p&gt;
&lt;script type="text/javascript"&gt;if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var align = "center",
        indent = "0em",
        linebreak = "false";

    if (false) {
        align = (screen.width &lt; 768) ? "left" : align;
        indent = (screen.width &lt; 768) ? "0em" : indent;
        linebreak = (screen.width &lt; 768) ? 'true' : linebreak;
    }

    var mathjaxscript = document.createElement('script');
    var location_protocol = (false) ? 'https' : document.location.protocol;
    if (location_protocol !== 'http' &amp;&amp; location_protocol !== 'https') location_protocol = 'https:';
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = location_protocol + '//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML';
    mathjaxscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: '"+ align +"'," +
        "    displayIndent: '"+ indent +"'," +
        "    showMathMenu: true," +
        "    messageStyle: 'normal'," +
        "    tex2jax: { " +
        "        inlineMath: [ ['\\\\(','\\\\)'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'inherit ! important'} }," +
        "        linebreaks: { automatic: "+ linebreak +", width: '90% container' }," +
        "    }, " +
        "}); " +
        "if ('default' !== 'default') {" +
            "MathJax.Hub.Register.StartupHook('HTML-CSS Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax['HTML-CSS'].FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
            "MathJax.Hub.Register.StartupHook('SVG Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax.SVG.FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
        "}";
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
&lt;/script&gt;</content><category term="data science"></category><category term="r"></category><category term="machine learning"></category><category term="association analysis"></category></entry><entry><title>数据科学之机器学习12: Logistic回归</title><link href="//jacky-sj/logistic-regression.html" rel="alternate"></link><published>2014-04-27T10:34:00+08:00</published><updated>2017-03-29T20:30:00+08:00</updated><author><name>Jacky Gong</name></author><id>tag:jacky-sj,2014-04-27:/logistic-regression.html</id><summary type="html">&lt;p&gt;Logistic 回归&lt;/p&gt;</summary><content type="html">&lt;p&gt;&lt;em&gt;“文章原创，转载请注明出处”&lt;/em&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;在数据科学系列的开头，花了三篇介绍了线性回归。线性回归模型应该是定量分析中最常用的一种统计分析方法。但是线性回归处理数据时，要求因变量是连续型变量。但是很多时候，需要处理的数据，其因变量并不是连续的。像性别、对错等等，这种离散的因变量，一般称为分类响应变量。&lt;/p&gt;
&lt;p&gt;在机器学习的&lt;a href="http://jackycode.github.io/blog/2014/03/30/data-science-an-introduction-to-machine-learning/"&gt;介绍篇&lt;/a&gt;中，已经介绍了监督学习与非监督学习。在监督学习中，最主要的两类问题，一个就是回归，另一个就是分类。而Logistic回归就是处理二元分类的一种方法，当然其也存在自身的问题，这个后面再讲。&lt;/p&gt;
&lt;h4&gt;Sigmoid函数&lt;/h4&gt;
&lt;hr&gt;
&lt;p&gt;要了解Logistic回归，首先需要了解一下Sigmoid函数。为什么呢？&lt;/p&gt;
&lt;p&gt;一般来说，我们会定义二元分类变量的输出为0和1，这种函数叫做单位阶跃函数，也称Heaviside step function。这个函数的特点就是其取值可以从0突变到1，反之也可。学过数分的话就知道，这种函数有时候会非常难以处理，因为带跳突变，导致了不可微不可导。在这里，就可以借助Sigmoid函数，因为这个函数可以近似地描述单位阶跃函数的特点。首先看看Sigmoid函数：&lt;/p&gt;
&lt;div class="math"&gt;$$ p = \frac{exp(y)}{1+exp(y)} = \frac{1}{1 + exp(-y)}$$&lt;/div&gt;
&lt;p&gt;简单看一下这个函数，当 &lt;span class="math"&gt;\(y=0\)&lt;/span&gt; 时，&lt;span class="math"&gt;\(p=0.5\)&lt;/span&gt;；当 &lt;span class="math"&gt;\(y\)&lt;/span&gt; 变大，趋近于无穷时，&lt;span class="math"&gt;\(y\)&lt;/span&gt; 趋近1；反之，&lt;span class="math"&gt;\(y\)&lt;/span&gt; 趋近0。而且，这种趋近的速度是非常快的。正是因为这个趋近速度非常快，我们可以使用Sigmoid函数来处理这边的单位阶跃函数。&lt;/p&gt;
&lt;h4&gt;Logistic回归&lt;/h4&gt;
&lt;hr&gt;
&lt;h5&gt;模型建立&lt;/h5&gt;
&lt;p&gt;利用Sigmoid函数可以将单位阶跃函数做个近似，而Sigmoid函数是连续的，那么就可以利用之前的线性回归来建立模型。&lt;/p&gt;
&lt;p&gt;令 &lt;span class="math"&gt;\(y = X\beta\)&lt;/span&gt;，又 &lt;span class="math"&gt;\( p = \frac{1}{1 + exp(-y)}\)&lt;/span&gt;，变形可得Logistic回归模型：&lt;/p&gt;
&lt;div class="math"&gt;$$ logit(p) = ln(\frac{p}{1-p}) = X\beta $$&lt;/div&gt;
&lt;p&gt;上述的 &lt;span class="math"&gt;\(logit(p)\)&lt;/span&gt; 称为 &lt;span class="math"&gt;\(logit\)&lt;/span&gt; 变换，此时 &lt;span class="math"&gt;\(p\)&lt;/span&gt; 就是响应变量，&lt;span class="math"&gt;\(X\)&lt;/span&gt; 就是自变量。到这，模型就建立好了，剩下就是如何对参数进行估计了。&lt;/p&gt;
&lt;h5&gt;参数估计&lt;/h5&gt;
&lt;p&gt;参数估计可以从两个方面来考虑，一个从最优化的方式，一个从统计角度！&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;最优化的方式&lt;/strong&gt;，是将模型转换成：&lt;span class="math"&gt;\( p = sigmod(X\beta)\)&lt;/span&gt;来考虑，对于估计值 &lt;span class="math"&gt;\(\hat{\beta}\)&lt;/span&gt;，应该使得其预测值 &lt;span class="math"&gt;\(\hat{p}\)&lt;/span&gt; 与实际值 &lt;span class="math"&gt;\(p\)&lt;/span&gt; 之间的差达到最小！即：&lt;/p&gt;
&lt;div class="math"&gt;$$ \hat{\beta} = \min_{\beta} \mid p - sigmod(X\beta) \mid$$&lt;/div&gt;
&lt;p&gt;有了这个，我们就可以使用最速下降法等等最优化的方法去求解参数的估计值了。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;统计角度&lt;/strong&gt;，那就需要考虑模型中 &lt;span class="math"&gt;\(p\)&lt;/span&gt; 的统计意义了，这个属于广义线性模型的范畴，现在不想多说，有兴趣的话可以翻翻资料！也可以根据下面说的&lt;strong&gt;统计中的解释&lt;/strong&gt;去试试，看看如何使用极大似然估计去估计参数。&lt;/p&gt;
&lt;h5&gt;统计中的解释&lt;/h5&gt;
&lt;hr&gt;
&lt;p&gt;这里面的 &lt;span class="math"&gt;\(p\)&lt;/span&gt; 除了利用Sigmoid函数来解释之外，还可以利用统计中的二项分布来解释，而且从某种角度来说，这个解释会更便于理解。试想，我们这边需要处理的二元分类变量就是0和1。我们考虑0就是“不发生”，1就是“发生”，那么我们可以将前面的 &lt;span class="math"&gt;\(p\)&lt;/span&gt; 理解成发生的概率。通过对已知数据建立模型，估计出参数，我们就可以利用模型去预测在不同的自变量条件下，“发生”的概率是多大，从而达到一个分类的目的。&lt;/p&gt;
&lt;p&gt;从这边的分析就可以看到，Logistic回归的缺点：那就是欠拟合，会导致分类的精度下降。&lt;/p&gt;
&lt;h5&gt;R语言实现&lt;/h5&gt;
&lt;hr&gt;
&lt;p&gt;因为Logistic回归是属于广义线性回归模型的，在R中有专门处理广义线性模型的函数&lt;code&gt;glm&lt;/code&gt;：&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="code-line"&gt;&lt;span&gt;&lt;/span&gt;model &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; glm&lt;span class="p"&gt;(&lt;/span&gt;formula&lt;span class="p"&gt;,&lt;/span&gt; family&lt;span class="o"&gt;=&lt;/span&gt;binominal&lt;span class="p"&gt;(&lt;/span&gt;link &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;logit&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; data&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kt"&gt;data.frame&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;这里处理的方式中，利用了连接函数(link=logit)，感兴趣的话可以找找广义线性模型的内容看看，当然，以后如果介绍统计模型的话，这个肯定也是必讲得内容。&lt;/p&gt;
&lt;script type="text/javascript"&gt;if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var align = "center",
        indent = "0em",
        linebreak = "false";

    if (false) {
        align = (screen.width &lt; 768) ? "left" : align;
        indent = (screen.width &lt; 768) ? "0em" : indent;
        linebreak = (screen.width &lt; 768) ? 'true' : linebreak;
    }

    var mathjaxscript = document.createElement('script');
    var location_protocol = (false) ? 'https' : document.location.protocol;
    if (location_protocol !== 'http' &amp;&amp; location_protocol !== 'https') location_protocol = 'https:';
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = location_protocol + '//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML';
    mathjaxscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: '"+ align +"'," +
        "    displayIndent: '"+ indent +"'," +
        "    showMathMenu: true," +
        "    messageStyle: 'normal'," +
        "    tex2jax: { " +
        "        inlineMath: [ ['\\\\(','\\\\)'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'inherit ! important'} }," +
        "        linebreaks: { automatic: "+ linebreak +", width: '90% container' }," +
        "    }, " +
        "}); " +
        "if ('default' !== 'default') {" +
            "MathJax.Hub.Register.StartupHook('HTML-CSS Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax['HTML-CSS'].FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
            "MathJax.Hub.Register.StartupHook('SVG Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax.SVG.FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
        "}";
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
&lt;/script&gt;</content><category term="data science"></category><category term="r"></category><category term="machine learning"></category><category term="classificaton"></category><category term="regression"></category></entry><entry><title>数据科学之机器学习11: 聚类分析2</title><link href="//jacky-sj/cluster-analysis2.html" rel="alternate"></link><published>2014-04-24T09:39:00+08:00</published><updated>2017-03-29T20:30:00+08:00</updated><author><name>Jacky Gong</name></author><id>tag:jacky-sj,2014-04-24:/cluster-analysis2.html</id><summary type="html">&lt;p&gt;聚类分析简介 2&lt;/p&gt;</summary><content type="html">&lt;p&gt;&lt;em&gt;“文章原创，转载请注明出处”&lt;/em&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;上一篇介绍了聚类分析的定义，给出了很多不同的相似性的度量方法。这一篇主要想介绍一下除了快速聚类之外的另外一种聚类方法：&lt;strong&gt;系统聚类法&lt;/strong&gt;。&lt;/p&gt;
&lt;h3&gt;二、系统聚类法&lt;/h3&gt;
&lt;hr&gt;
&lt;p&gt;系统聚类法，hierarchical clustering method，是聚类分析方法中用的较多的一种。其具体过程如下：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;对于n个样品，构造n个类，每个样品单独作为一类。计算每个类之间的距离；&lt;/li&gt;
&lt;li&gt;合并距离最近的两个类为一个新类；&lt;/li&gt;
&lt;li&gt;计算新类与其它类之间的距离，重复2直到所有类合并称为1个类为止。&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;那么类与类之间的距离如何定义呢？&lt;/p&gt;
&lt;p&gt;其实，类与类之间的距离有很多中定义方式常见的有：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;最短距离法，single linkage method，&lt;span class="math"&gt;\( D_{KL} = \min_{i \in G_K,j \in G_L} d_{ij}\)&lt;/span&gt;；&lt;/li&gt;
&lt;li&gt;最长距离法，complete linkage method，&lt;span class="math"&gt;\( D_{KL} = \max_{i \in G_K,j \in G_L} d_{ij}\)&lt;/span&gt;；&lt;/li&gt;
&lt;li&gt;中间距离法，median linkage method，即取最远距离与最近距离两者的中间距离；&lt;/li&gt;
&lt;li&gt;类平均法，average linkage method，&lt;span class="math"&gt;\( D_{KL} = \frac{1}{n_Kn_L} \sum_{i \in G_K,j \in G_L} d_{ij}\)&lt;/span&gt;；&lt;/li&gt;
&lt;li&gt;重心法，centroid hierarchical method，即取类重心之间的距离；&lt;/li&gt;
&lt;li&gt;离差平方和法，Ward's minimum variance method, 定义较为繁琐，可以自行Google；&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;strong&gt;注&lt;/strong&gt;：系统聚类的方法并不困难，但是实现时会存在计算量的问题。系统聚类法一般是在样品间距离矩阵的基础上进行的，它需要计算所有点到所有点之间的距离，当样品量很大时，这个计算量会变得非常的大。因而，很多时候人们会采用动态聚类的方法去处理数据，动态聚类法中一种最常用的方法就是之前已经介绍过的KMeans方法。&lt;/p&gt;
&lt;h4&gt;R语言实现&lt;/h4&gt;
&lt;p&gt;在R语言中，自带了一个函数可以实现系统聚类：&lt;code&gt;hclust&lt;/code&gt;。可以自己查阅help。&lt;/p&gt;
&lt;h3&gt;三、聚类的一些问题&lt;/h3&gt;
&lt;hr&gt;
&lt;ol&gt;
&lt;li&gt;量纲问题。实际问题中，由于数据采用的量纲不同，很多时候需要对数据进行一些变换，最常用的就是标准化。但也有一些其它方式：极差变换（数据除以极差）；主成分变换（用主成分代替本身数据）；对数变换等等。&lt;/li&gt;
&lt;li&gt;kmeans算法只有在类的平均值可以被定义的情况下使用，所以在一些特殊的场合，kmeans并不适用。比如分类数据等等!!&lt;/li&gt;
&lt;li&gt;kmeans算法使用平均值作为衡量，这就造成了一个新的问题。即kmeans不适用于含有异常值的数据，非凸面的数据以及大小值相差很大的数据。&lt;/li&gt;
&lt;li&gt;聚类的一个&lt;strong&gt;难点&lt;/strong&gt;在于：确定类的个数。通过上面介绍的算法来看，所有的方法都需要自己去定义类的个数。那么如何去定义类的个数呢？这是一个到现在还没有满意解决的问题。常用的方式就是观察样品散点图，查看变化率，以及使用一些假设检验的方式（感兴趣可以翻阅专业的书籍材料，比如上海财经出版社的应用多元分析中就有讲到这部分内容）。&lt;/li&gt;
&lt;/ol&gt;
&lt;script type="text/javascript"&gt;if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var align = "center",
        indent = "0em",
        linebreak = "false";

    if (false) {
        align = (screen.width &lt; 768) ? "left" : align;
        indent = (screen.width &lt; 768) ? "0em" : indent;
        linebreak = (screen.width &lt; 768) ? 'true' : linebreak;
    }

    var mathjaxscript = document.createElement('script');
    var location_protocol = (false) ? 'https' : document.location.protocol;
    if (location_protocol !== 'http' &amp;&amp; location_protocol !== 'https') location_protocol = 'https:';
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = location_protocol + '//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML';
    mathjaxscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: '"+ align +"'," +
        "    displayIndent: '"+ indent +"'," +
        "    showMathMenu: true," +
        "    messageStyle: 'normal'," +
        "    tex2jax: { " +
        "        inlineMath: [ ['\\\\(','\\\\)'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'inherit ! important'} }," +
        "        linebreaks: { automatic: "+ linebreak +", width: '90% container' }," +
        "    }, " +
        "}); " +
        "if ('default' !== 'default') {" +
            "MathJax.Hub.Register.StartupHook('HTML-CSS Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax['HTML-CSS'].FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
            "MathJax.Hub.Register.StartupHook('SVG Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax.SVG.FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
        "}";
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
&lt;/script&gt;</content><category term="data science"></category><category term="r"></category><category term="machine learning"></category><category term="clustering"></category></entry><entry><title>数据科学之机器学习10: 聚类分析1</title><link href="//jacky-sj/cluster-analysis1.html" rel="alternate"></link><published>2014-04-21T18:46:00+08:00</published><updated>2017-03-29T20:30:00+08:00</updated><author><name>Jacky Gong</name></author><id>tag:jacky-sj,2014-04-21:/cluster-analysis1.html</id><summary type="html">&lt;p&gt;聚类分析简介 1&lt;/p&gt;</summary><content type="html">&lt;p&gt;&lt;em&gt;“文章原创，转载请注明出处”&lt;/em&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;上一篇介绍了聚类分析中的KMeans算法，这一节就来具体地说说聚类分析。聚类分析，cluster analysis，是一种研究“物以类聚”现代统计学分析方法，其目的是要把分类对象按照一定的规则分成若干个类。这些类别并非事先给定的，而是根据数据的特征确定的。&lt;/p&gt;
&lt;hr&gt;
&lt;h5&gt;NOTE：聚类的划分：&lt;/h5&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;根据分类对象的不同，可以分为：&lt;strong&gt;Q型聚类分析&lt;/strong&gt;和&lt;strong&gt;R型聚类分析&lt;/strong&gt;。Q型是指对样品对象进行聚类；而R型则是对变量(属性)进行聚类。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;按照分析方法的不同，又可以分为：&lt;strong&gt;系统聚类法&lt;/strong&gt;、&lt;strong&gt;快速聚类法&lt;/strong&gt;和&lt;strong&gt;模糊聚类法&lt;/strong&gt;。上一篇介绍的KMeans法就是快速聚类法中的一种。&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h4&gt;一、相似性的度量&lt;/h4&gt;
&lt;hr&gt;
&lt;p&gt;在上一篇中，我们已经介绍过，聚类其实就是将相似度高的样品啊属性啊合并成一个类别。但是，上一篇我们仅仅给出了一种也是最简单的一种相似性的度量方式——欧式距离。这里我们详细看看相似性有哪些度量方式：&lt;/p&gt;
&lt;p&gt;除了使用&lt;strong&gt;有序尺度变量&lt;/strong&gt;（将属性划分为一级、二级等等的有次序关系的量来表示）和&lt;strong&gt;名义尺度变量&lt;/strong&gt;（使用既没有等级关系，又不存在数量关系的量来表示。比如男女）之外，一般采用的测量尺度的方式就是&lt;strong&gt;间隔尺度变量&lt;/strong&gt;。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;间隔尺度变量&lt;/strong&gt;即是使用连续的量来表示测量尺度，一般都是连续型的，比如欧式距离、重量等等。一般来讲，在应对Q型聚类时会使用&lt;strong&gt;距离&lt;/strong&gt;去度量；而对R型聚类来说，则会使用&lt;strong&gt;相似系数&lt;/strong&gt;这种方式去度量。下面来分别看一看：&lt;/p&gt;
&lt;hr&gt;
&lt;h5&gt;a. 距离&lt;/h5&gt;
&lt;hr&gt;
&lt;p&gt;上一篇中使用的欧氏距离即是这里的一种，在介绍各种不同的距离定义之前，首先看看距离的定义需要满足哪些条件：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;首先，距离必须是非负的。即：&lt;span class="math"&gt;\(d_{ij} \geqslant 0, \forall i,j\)&lt;/span&gt;;&lt;/li&gt;
&lt;li&gt;对于相同取值的样品，之间的距离必须为0。即：&lt;span class="math"&gt;\(d_{ij} = 0\)&lt;/span&gt;，当且仅当，第i个样品与第j个样品的各变量值相同；&lt;/li&gt;
&lt;li&gt;i样品到j样品的距离与j样品到i样品的距离相等。即：&lt;span class="math"&gt;\(d_{ij} = d_{ji}, \forall i, j\)&lt;/span&gt;；&lt;/li&gt;
&lt;li&gt;满足：&lt;span class="math"&gt;\(d_{ij} \leqslant d_{ik} + d_{kj}, \forall i,j,k\)&lt;/span&gt;。&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;下面就来看看常用的距离定义，首先看看最常用的Minkowski距离：&lt;/p&gt;
&lt;hr&gt;
&lt;h6&gt;(1). Minkowski距离&lt;/h6&gt;
&lt;div class="math"&gt;$$ d_{ij}(q) = [\sum_{k=1}^{p} {\mid x_{ik} - x_{jk} \mid ^ q}]^{1/q} $$&lt;/div&gt;
&lt;p&gt;观察这个距离可以看到，当&lt;span class="math"&gt;\(q=2\)&lt;/span&gt;时，上面定义的距离就是常用的欧氏距离。另外：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;span class="math"&gt;\(q=1\)&lt;/span&gt; 时，&lt;span class="math"&gt;\(d_{ij}=\sum_{k=1}^{p} {\mid x_{ik} - x_{jk} \mid}\)&lt;/span&gt; 称为&lt;strong&gt;绝对值距离&lt;/strong&gt;；&lt;/li&gt;
&lt;li&gt;&lt;span class="math"&gt;\(q=\infty\)&lt;/span&gt; 时，&lt;span class="math"&gt;\(d_{ij}=\max_{1 \leqslant k \leqslant p} {\mid x_{ik} - x_{jk} \mid}\)&lt;/span&gt; 称为&lt;strong&gt;切比雪夫距离&lt;/strong&gt;。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Minkowski距离存在一个问题，就是当变量的单位不同或者测量值范围相差很大时，直接使用Minkowski距离效果不佳。这个时候，应该先对数据进行&lt;strong&gt;标准化&lt;/strong&gt;（就是减去均值除上标准差）之后再计算距离(这个后面还会说到)。&lt;/p&gt;
&lt;hr&gt;
&lt;h6&gt;(2). Lance距离(Lance and Williams)&lt;/h6&gt;
&lt;p&gt;当&lt;span class="math"&gt;\(x_{ji} &amp;gt; 0\)&lt;/span&gt;时，定义第i个样品到第j个样品的距离为：&lt;/p&gt;
&lt;div class="math"&gt;$$ d_{ij} = \sum_{k=1}^{p} {\frac{\mid x_{ik} - x_{jk} \mid}{x_{ik} + x_{jk}}} $$&lt;/div&gt;
&lt;p&gt;从公式就可以看出来，这个距离与变量之间的单位没有什么关系；而且其对异常值也不敏感，因而适用于一些高度偏斜的数据。&lt;/p&gt;
&lt;hr&gt;
&lt;h6&gt;(3). Mahalanobis距离(马氏距离)&lt;/h6&gt;
&lt;p&gt;上面的两种距离都没有考虑变量之间的相关性问题，马氏距离就可以考虑到这个问题。但是由于马氏距离定义的问题，在聚类分析中使用马氏距离并不合适。但是这里也还是给出马氏距离的定义：&lt;/p&gt;
&lt;div class="math"&gt;$$ d_{ij} = \sqrt{(x_i - x_j)^TS^{-1}(x_i - x_j)} $$&lt;/div&gt;
&lt;p&gt;其中 &lt;span class="math"&gt;\(x_i = (x_{i1}, \dots, x_{ip})^T\)&lt;/span&gt;，&lt;span class="math"&gt;\(x_j = (x_{j1}, \dots, x_{jp})^T\)&lt;/span&gt;，&lt;span class="math"&gt;\(S\)&lt;/span&gt; 为样本协方差阵。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;&lt;em&gt;注：&lt;/em&gt;&lt;/strong&gt;为什么说马氏距离不适用与聚类分析呢？&lt;/p&gt;
&lt;p&gt;聚类分析是无监督算法中的一种，无监督算法是什么？无监督算法是没有先验信息的，所有的数据拿过来是没有什么目标信息啊什么的。没有不同类之间的先验信息，那么协方差阵&lt;/p&gt;
&lt;div class="math"&gt;$$S$$&lt;/div&gt;
&lt;p&gt;就无法计算。因而，在实际聚类分析中，马氏距离并不适用。&lt;/p&gt;
&lt;hr&gt;
&lt;h6&gt;(4). 斜交空间距离&lt;/h6&gt;
&lt;div class="math"&gt;$$ d_{ij} = [ \frac{1}{p^2} \sum_{k=1}^{p} \sum_{l=1}^{p} (x_{ik} -x_{jk})(x_{il} - x_{jl})r_{kl} ] ^ {1/2} $$&lt;/div&gt;
&lt;p&gt;其中 &lt;span class="math"&gt;\(r_{kl}\)&lt;/span&gt; 是变量 &lt;span class="math"&gt;\(x_k\)&lt;/span&gt; 与变量 &lt;span class="math"&gt;\(x_l\)&lt;/span&gt; 的相关系数。学过高等代数的应该可以很容易看明白这个定义。此外，当变量之间互不相关的时候，这里的 &lt;span class="math"&gt;\(d_{ij} = [d_{ij}(2)/p]_{Minkowski}\)&lt;/span&gt;，也就是退化到了欧氏距离（相差一个常数倍）。&lt;/p&gt;
&lt;hr&gt;
&lt;h5&gt;b. 相似系数&lt;/h5&gt;
&lt;hr&gt;
&lt;p&gt;对变量进行聚类时，通常使用相似系数来考量其间的相似度。那么相似系数的定义有需要满足哪些条件呢？&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;完全相关。即：&lt;span class="math"&gt;\(c_{ij} = \pm 1\)&lt;/span&gt;，当且仅当&lt;span class="math"&gt;\(x_i = ax_j + b;a(\neq 0),b\)&lt;/span&gt;是常数；&lt;/li&gt;
&lt;li&gt;&lt;span class="math"&gt;\(\mid c_{ij} \mid \leqslant 1, \forall i, j\)&lt;/span&gt;；&lt;/li&gt;
&lt;li&gt;&lt;span class="math"&gt;\(c_{ij} = c_{ji}, \forall i, j\)&lt;/span&gt;。&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;下面看看常用的两种相似系数：&lt;/p&gt;
&lt;hr&gt;
&lt;h6&gt;(1). 夹角余弦&lt;/h6&gt;
&lt;hr&gt;
&lt;p&gt;变量&lt;span class="math"&gt;\(x_i\)&lt;/span&gt;和&lt;span class="math"&gt;\(x_j\)&lt;/span&gt;的夹角余弦的定义为：&lt;/p&gt;
&lt;div class="math"&gt;$$ c_{ij} = \frac{\sum_{k=1}^{n} {x_{ki}x_{kj}} }{ [ (\sum_{k=1}^{n}{ x^2_{ki} })(\sum_{k=1}^{n} {x^2_{kj}} ) ]^{1/2} } $$&lt;/div&gt;
&lt;p&gt;学过解析几何应该很容易看出这个定义的含义所在，其实 &lt;span class="math"&gt;\(c_{ij} = \cos \theta_{ij}\)&lt;/span&gt;。&lt;/p&gt;
&lt;hr&gt;
&lt;h6&gt;(2). 相关系数&lt;/h6&gt;
&lt;hr&gt;
&lt;div class="math"&gt;$$ c_{ij} = \frac { \sum _{ k=1 }^{ n }{ ({ x }_{ ki }-\overline{x_i})({ x }_{ kj }-\overline{x_j}) }  }{ \{ [\sum_{k=1}^{n}({ x }_{ ki }-\overline{x_i})^2][\sum_{k=1}^{n}({ x }_{ kj }-\overline{x_j})^2] \}^{1/2} } $$&lt;/div&gt;
&lt;p&gt;这里的相关系数其实就是统计里面通常所说的相关系数。其实，如果变量都是标准化了的，那么夹角余弦就是相关系数，看出来了吗？&lt;/p&gt;
&lt;hr&gt;
&lt;h4&gt;小节&lt;/h4&gt;
&lt;hr&gt;
&lt;p&gt;到这边，就把统计中常用的用于度量相似性的定义讲了一些。这些定义，大都有其自身的数学背景。有些来自于几何学，有些来自于线性空间理论。对于使用者来说，搞明白什么时候选择什么样的度量方式更加重要！下一篇，我们讲一讲聚类分析中的一个常用方法：&lt;strong&gt;系统聚类法&lt;/strong&gt;。&lt;/p&gt;
&lt;script type="text/javascript"&gt;if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var align = "center",
        indent = "0em",
        linebreak = "false";

    if (false) {
        align = (screen.width &lt; 768) ? "left" : align;
        indent = (screen.width &lt; 768) ? "0em" : indent;
        linebreak = (screen.width &lt; 768) ? 'true' : linebreak;
    }

    var mathjaxscript = document.createElement('script');
    var location_protocol = (false) ? 'https' : document.location.protocol;
    if (location_protocol !== 'http' &amp;&amp; location_protocol !== 'https') location_protocol = 'https:';
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = location_protocol + '//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML';
    mathjaxscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: '"+ align +"'," +
        "    displayIndent: '"+ indent +"'," +
        "    showMathMenu: true," +
        "    messageStyle: 'normal'," +
        "    tex2jax: { " +
        "        inlineMath: [ ['\\\\(','\\\\)'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'inherit ! important'} }," +
        "        linebreaks: { automatic: "+ linebreak +", width: '90% container' }," +
        "    }, " +
        "}); " +
        "if ('default' !== 'default') {" +
            "MathJax.Hub.Register.StartupHook('HTML-CSS Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax['HTML-CSS'].FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
            "MathJax.Hub.Register.StartupHook('SVG Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax.SVG.FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
        "}";
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
&lt;/script&gt;</content><category term="data science"></category><category term="r"></category><category term="machine learning"></category><category term="clustering"></category></entry><entry><title>数据科学之机器学习9: 聚类算法之Kmeans</title><link href="//jacky-sj/clustering-kmeans.html" rel="alternate"></link><published>2014-04-19T13:01:00+08:00</published><updated>2017-03-29T20:30:00+08:00</updated><author><name>Jacky Gong</name></author><id>tag:jacky-sj,2014-04-19:/clustering-kmeans.html</id><summary type="html">&lt;p&gt;k-means 聚类算法&lt;/p&gt;</summary><content type="html">&lt;p&gt;&lt;em&gt;“文章原创，转载请注明出处”&lt;/em&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;h2&gt;The k-means algorithm&lt;/h2&gt;
&lt;hr&gt;
&lt;p&gt;前面写了很多监督学习的东西，除了回归就是分类，今儿有点想换换口味，写写无监督学习的算法。k-means算法是一种聚类算法，聚类就是无监督学习里面的内容。那么先来说说聚类：&lt;/p&gt;
&lt;h3&gt;一、聚类简介&lt;/h3&gt;
&lt;hr&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;聚类是一种无监督学习方法，它主要就是将相似的对象归并到一个类别中。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;聚类分析的目的是把分类对象按照一定的规则，分成若干个类。这些类并不是事先给定的，而是在处理数据时，根据数据的特征确定的。因而，在处理之前无需对类的数目、结构等等作出假定(理论如此，实际应用时并不完全这样，以后讲聚类分析时再具体说)。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;在同一类别中，对象具有某种意义下的相似性；不同的类别中，对象具有某种意义下的不相似。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;聚类与分类的最大不同&lt;/strong&gt;：分类的目标事先已知，而聚类未知。正因为聚类产生的结构与分类相同，只是类别没有预先定义，所以聚类也被称为“无监督分类”。&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3&gt;二、k-means法&lt;/h3&gt;
&lt;hr&gt;
&lt;p&gt;k-means法是由MacQueen提出并命名的一种聚类算法。其使用聚类中的均值进行聚类划分，这样说不大好理解，可以先看一下算法的基本步骤：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;从n个数据对象中任意取出k个样品对象作为初始聚类点（或者将所有数据分成k份，计算每一份中的重心（均值）作为初始聚类点）；&lt;/li&gt;
&lt;li&gt;对所有样品对象逐个归类，将每一个对象归入距离他最近的那个类（距离一般使用欧式距离），并将该类的凝聚点更新为这个类当前的均值；&lt;/li&gt;
&lt;li&gt;重复步骤2，直至所有对象都不能再分配为止。&lt;/li&gt;
&lt;/ol&gt;
&lt;h3&gt;三、R语言实现&lt;/h3&gt;
&lt;hr&gt;
&lt;h4&gt;1. 自定义函数&lt;/h4&gt;
&lt;hr&gt;
&lt;p&gt;自定义一个函数&lt;code&gt;se_kmeans&lt;/code&gt;，使用这个函数可以通过输入需要聚类的数据集以及类别数目k，即可得到每一个样品的类别以及各个类别的中心。该函数使用欧式距离作为相似性的度量（当然还有很多其它方式，之后的聚类分析中会讲到），具体的程序可以在&lt;a href="https://github.com/JackyCode/Data_Science"&gt;我的项目&lt;/a&gt;中找到，也可以直接到我的&lt;a href="https://github.com/JackyCode/Data_Science"&gt;github&lt;/a&gt;中查看源代码。这边给出测试代码以及结果：&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="code-line"&gt;&lt;span&gt;&lt;/span&gt;x1 &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="kt"&gt;matrix&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;rnorm&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="m"&gt;500&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="m"&gt;0.5&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="m"&gt;100&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="m"&gt;5&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;x2 &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="kt"&gt;matrix&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;rnorm&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="m"&gt;500&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="m"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="m"&gt;0.5&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="m"&gt;100&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="m"&gt;5&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;x &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="kp"&gt;rbind&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;x1&lt;span class="p"&gt;,&lt;/span&gt; x2&lt;span class="p"&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;clusters &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; se_kmeans&lt;span class="p"&gt;(&lt;/span&gt;x&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="m"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;clusters&lt;/span&gt;
&lt;span class="code-line"&gt;plot&lt;span class="p"&gt;(&lt;/span&gt;x&lt;span class="p"&gt;,&lt;/span&gt; col&lt;span class="o"&gt;=&lt;/span&gt;clusters&lt;span class="o"&gt;$&lt;/span&gt;cluster&lt;span class="p"&gt;,&lt;/span&gt; pch&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kp"&gt;as.character&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;clusters&lt;span class="o"&gt;$&lt;/span&gt;cluster&lt;span class="p"&gt;),&lt;/span&gt; cex&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;0.5&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;points&lt;span class="p"&gt;(&lt;/span&gt;clusters&lt;span class="o"&gt;$&lt;/span&gt;center&lt;span class="p"&gt;,&lt;/span&gt; col&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;green&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; pch&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;o&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; cex &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="m"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;得到如下的一张图&lt;/p&gt;
&lt;p&gt;&lt;img alt="kmeans1" src="\images\article\a24\kmeans1.jpg"&gt;&lt;/p&gt;
&lt;p&gt;可以看到，分类效果是很好的。&lt;/p&gt;
&lt;h4&gt;2. 使用&lt;code&gt;kmeans&lt;/code&gt;函数&lt;/h4&gt;
&lt;hr&gt;
&lt;p&gt;可以使用&lt;code&gt;stats&lt;/code&gt;包中的&lt;code&gt;kmeans&lt;/code&gt;函数来实现，示例如下：&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="code-line"&gt;&lt;span&gt;&lt;/span&gt;x1 &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="kt"&gt;matrix&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;rnorm&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="m"&gt;500&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="m"&gt;0.5&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="m"&gt;100&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="m"&gt;5&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;x2 &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="kt"&gt;matrix&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;rnorm&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="m"&gt;500&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="m"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="m"&gt;0.5&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="m"&gt;100&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="m"&gt;5&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;x &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="kp"&gt;rbind&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;x1&lt;span class="p"&gt;,&lt;/span&gt; x2&lt;span class="p"&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;clusters &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; kmeans&lt;span class="p"&gt;(&lt;/span&gt;x&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="m"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;clusters&lt;/span&gt;
&lt;span class="code-line"&gt;plot&lt;span class="p"&gt;(&lt;/span&gt;x&lt;span class="p"&gt;,&lt;/span&gt; col&lt;span class="o"&gt;=&lt;/span&gt;clusters&lt;span class="o"&gt;$&lt;/span&gt;cluster&lt;span class="p"&gt;,&lt;/span&gt; pch&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kp"&gt;as.character&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;clusters&lt;span class="o"&gt;$&lt;/span&gt;cluster&lt;span class="p"&gt;),&lt;/span&gt; cex&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;0.5&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;points&lt;span class="p"&gt;(&lt;/span&gt;clusters&lt;span class="o"&gt;$&lt;/span&gt;centers&lt;span class="p"&gt;,&lt;/span&gt; col&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;green&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; pch&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;o&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; cex &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="m"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;得到这样一张图&lt;/p&gt;
&lt;p&gt;&lt;img alt="kmeans2" src="\images\article\a24\kmeans2.jpg"&gt;&lt;/p&gt;
&lt;p&gt;从图中可以看出，kmeans的分类效果还是蛮不错的，当然我们可以计算一下误判，不过这显然是很小的。&lt;/p&gt;</content><category term="data science"></category><category term="r"></category><category term="machine learning"></category><category term="clustering"></category></entry><entry><title>数据科学之机器学习8: 决策树之ID3</title><link href="//jacky-sj/cls-decision-trees-id3.html" rel="alternate"></link><published>2014-04-14T16:02:00+08:00</published><updated>2017-03-29T20:30:00+08:00</updated><author><name>Jacky Gong</name></author><id>tag:jacky-sj,2014-04-14:/cls-decision-trees-id3.html</id><summary type="html">&lt;p&gt;决策树算法之 ID3&lt;/p&gt;</summary><content type="html">&lt;p&gt;&lt;em&gt;“文章原创，转载请注明出处”&lt;/em&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;ID3算法的核心问题就在于：如何选取在决策树的每个节点处要测试的属性。那么如何去选择呢？当然，我们要选取&lt;strong&gt;分类能力最好的属性&lt;/strong&gt;，那么怎么去确定哪个属性是分类能力最好的呢？ID3算法中，使用&lt;strong&gt;信息增益&lt;/strong&gt;作为评判标准。在看信息增益之前，我们先看看这个决策树的构造过程：&lt;/p&gt;
&lt;h3&gt;一、构造过程&lt;/h3&gt;
&lt;hr&gt;
&lt;ol&gt;
&lt;li&gt;选取&lt;strong&gt;分类能力最好的属性&lt;/strong&gt;作为决策树根部节点的测试；&lt;/li&gt;
&lt;li&gt;为根节点属性的每一个可能值产生一个分支；&lt;/li&gt;
&lt;li&gt;以各个分支节点为根节点，重复上述过程。&lt;/li&gt;
&lt;/ol&gt;
&lt;h3&gt;二、信息增益&lt;/h3&gt;
&lt;hr&gt;
&lt;h4&gt;1. 熵&lt;/h4&gt;
&lt;hr&gt;
&lt;p&gt;在看信息增益之前，首先需要介绍一个概念，那就是&lt;strong&gt;香农熵&lt;/strong&gt;，简称为&lt;strong&gt;熵&lt;/strong&gt;。相信学过物理的应该大都听过这个名词，在热力学中不就有个熵增原理嘛。其实，&lt;strong&gt;熵是信息论中广泛使用的一个度量标准，刻画了任意样例集合的纯度。&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;熵是信息的期望值&lt;/strong&gt;，所以可以用熵来刻画一个数据集的纯度。若用 &lt;span class="math"&gt;\(x_i,i=1,2,\dots,n\)&lt;/span&gt; 来表示数据集所包含的属性，那么这个数据集的熵为：&lt;/p&gt;
&lt;div class="math"&gt;$$ H = - \sum_{i=1}^{n}{p(x_i)l(x_i)} $$&lt;/div&gt;
&lt;p&gt;其中，&lt;span class="math"&gt;\(p(x_i)\)&lt;/span&gt; 表示选取 &lt;span class="math"&gt;\(x_i\)&lt;/span&gt; 作为分类的最终类别的概率；&lt;span class="math"&gt;\(l(x_i)\)&lt;/span&gt; 为 &lt;span class="math"&gt;\(x_i\)&lt;/span&gt; 的信息，定义为：&lt;span class="math"&gt;\( l(x_i) = - \log_2p(x_i)\)&lt;/span&gt;。&lt;/p&gt;
&lt;h4&gt;2. 信息增益&lt;/h4&gt;
&lt;hr&gt;
&lt;p&gt;有了熵之后就可以刻画一个数据集的纯度，也就是熵值。那么什么信息增益呢？&lt;/p&gt;
&lt;p&gt;简单来说，&lt;strong&gt;一个属性的信息增益就是：使用这个属性分割样例集合而导致的熵值降低&lt;/strong&gt;。那么要选取分类能力最好的属性，就是要选取使得信息增益最大的那个属性。&lt;/p&gt;
&lt;p&gt;一个属性A对样例集合S的信息增益定义为：&lt;/p&gt;
&lt;div class="math"&gt;$$ Gain(S, A) = H(S) - \sum_{v \in A} { \frac{\# S_v}{\# S} H(S_v) } $$&lt;/div&gt;
&lt;p&gt;其中，&lt;span class="math"&gt;\(S_v\)&lt;/span&gt; 表示集合S中，属性A取值为&lt;span class="math"&gt;\(v\)&lt;/span&gt;的那部分数据；&lt;span class="math"&gt;\(\# S_v\)&lt;/span&gt; 表示，集合S中，属性A取值为&lt;span class="math"&gt;\(v\)&lt;/span&gt;的个数；&lt;span class="math"&gt;\(\# S\)&lt;/span&gt; 表示集合S中观测的个数。&lt;/p&gt;
&lt;h4&gt;3. 简单的例子&lt;/h4&gt;
&lt;hr&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th align="center"&gt;序号&lt;/th&gt;
&lt;th align="center"&gt;age&lt;/th&gt;
&lt;th align="center"&gt;income&lt;/th&gt;
&lt;th align="center"&gt;buy_iphone&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td align="center"&gt;1&lt;/td&gt;
&lt;td align="center"&gt;senior&lt;/td&gt;
&lt;td align="center"&gt;high&lt;/td&gt;
&lt;td align="center"&gt;yes&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align="center"&gt;2&lt;/td&gt;
&lt;td align="center"&gt;senior&lt;/td&gt;
&lt;td align="center"&gt;low&lt;/td&gt;
&lt;td align="center"&gt;no&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align="center"&gt;3&lt;/td&gt;
&lt;td align="center"&gt;youth&lt;/td&gt;
&lt;td align="center"&gt;high&lt;/td&gt;
&lt;td align="center"&gt;yes&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align="center"&gt;4&lt;/td&gt;
&lt;td align="center"&gt;youth&lt;/td&gt;
&lt;td align="center"&gt;low&lt;/td&gt;
&lt;td align="center"&gt;no&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align="center"&gt;5&lt;/td&gt;
&lt;td align="center"&gt;senior&lt;/td&gt;
&lt;td align="center"&gt;high&lt;/td&gt;
&lt;td align="center"&gt;yes&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align="center"&gt;6&lt;/td&gt;
&lt;td align="center"&gt;youth&lt;/td&gt;
&lt;td align="center"&gt;high&lt;/td&gt;
&lt;td align="center"&gt;yes&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align="center"&gt;7&lt;/td&gt;
&lt;td align="center"&gt;senior&lt;/td&gt;
&lt;td align="center"&gt;high&lt;/td&gt;
&lt;td align="center"&gt;no&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;考虑上面这个问题，我们来计算一下各个属性的信息增益。&lt;/p&gt;
&lt;p&gt;首先，我们可以看到，这个数据集S最终分类buy_iphone有两种取值：&lt;span class="math"&gt;\(yes,no\)&lt;/span&gt;。则数据集S的熵值为：&lt;/p&gt;
&lt;div class="math"&gt;$$ H(S) = -\frac{4}{7} \log_2{\frac{4}{7} } - \frac{3}{7} \log_2{\frac{3}{7} }  \approx 0.985$$&lt;/div&gt;
&lt;p&gt;若按照age分类，age有两个属性：&lt;span class="math"&gt;\(senior, youth\)&lt;/span&gt;，分别有4个和3个。age = senior时，yes有2个，no有2个则有：&lt;/p&gt;
&lt;div class="math"&gt;$$ H_{age}(S_{senior}) = -\frac{2}{4} \log_2{\frac{2}{4}} - \frac{2}{4} \log_2{\frac{2}{4}} \approx 1 $$&lt;/div&gt;
&lt;div class="math"&gt;$$ H_{age}(S_{youth}) = -\frac{2}{3} \log_2 {\frac{2}{3}} - \frac{1}{3} \log_2 {\frac{1}{3}} \approx 0.918 $$&lt;/div&gt;
&lt;p&gt;则有：&lt;/p&gt;
&lt;div class="math"&gt;$$ H_{age}(S) = \frac{4}{7} \times 1 + \frac{3}{7} \times 0.918 = 0.965 $$&lt;/div&gt;
&lt;p&gt;则age属性的信息增益为：&lt;/p&gt;
&lt;div class="math"&gt;$$ H(S) - H_{age}(S) = 0.985 - 0.965 = 0.020 $$&lt;/div&gt;
&lt;p&gt;那么属性income的信息增益怎么去计算，可以动手试试。&lt;/p&gt;
&lt;h3&gt;三、ID3算法的伪代码&lt;/h3&gt;
&lt;hr&gt;
&lt;h5&gt;定义：&lt;/h5&gt;
&lt;ul&gt;
&lt;li&gt;data：为训练样本集&lt;/li&gt;
&lt;li&gt;label：为目标属性 （比如例子中的属性buy_iphone）&lt;/li&gt;
&lt;li&gt;attrs：出目标属性外，供算法学习测试使用的其它属性 （比如例子中的age和income属性）&lt;/li&gt;
&lt;/ul&gt;
&lt;h5&gt;伪代码：&lt;/h5&gt;
&lt;p&gt;ID3(data, label, attrs)：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;创建决策树的Root节点；&lt;/li&gt;
&lt;li&gt;若lable中取值单一，则返回 &lt;code&gt;label=label&lt;/code&gt; 的单节点树；&lt;/li&gt;
&lt;li&gt;若attrs为空，则返回 &lt;code&gt;label=（data中取值最多的那个label）&lt;/code&gt; 的单节点树；&lt;/li&gt;
&lt;li&gt;否则：&lt;ol&gt;
&lt;li&gt;选取attrs中分类能力最好的属性作为Root的决策属性，记为A；&lt;/li&gt;
&lt;li&gt;对A的每一个可能取值vi：&lt;ol&gt;
&lt;li&gt;在Root添加一个分支对应 &lt;code&gt;A = vi&lt;/code&gt;；&lt;/li&gt;
&lt;li&gt;data_vi = data中 &lt;code&gt;A = vi&lt;/code&gt; 的子集，label_vi 表示 data_vi 所对应的目标属性取值；&lt;/li&gt;
&lt;li&gt;若 data_vi 为空集：&lt;ol&gt;
&lt;li&gt;在新分支下加一个叶子节点，节点 &lt;code&gt;label =（data中取值最多的那个label）&lt;/code&gt; ;&lt;/li&gt;
&lt;li&gt;否则，加一个子树：ID3(data_vi, label_vi, attrs);&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;结束&lt;/li&gt;
&lt;li&gt;返回Root&lt;/li&gt;
&lt;/ol&gt;
&lt;h3&gt;四、R语言实现&lt;/h3&gt;
&lt;hr&gt;
&lt;p&gt;见&lt;a href="https://github.com/JackyCode/Data_Science"&gt;我的项目&lt;/a&gt;&lt;/p&gt;
&lt;script type="text/javascript"&gt;if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var align = "center",
        indent = "0em",
        linebreak = "false";

    if (false) {
        align = (screen.width &lt; 768) ? "left" : align;
        indent = (screen.width &lt; 768) ? "0em" : indent;
        linebreak = (screen.width &lt; 768) ? 'true' : linebreak;
    }

    var mathjaxscript = document.createElement('script');
    var location_protocol = (false) ? 'https' : document.location.protocol;
    if (location_protocol !== 'http' &amp;&amp; location_protocol !== 'https') location_protocol = 'https:';
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = location_protocol + '//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML';
    mathjaxscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: '"+ align +"'," +
        "    displayIndent: '"+ indent +"'," +
        "    showMathMenu: true," +
        "    messageStyle: 'normal'," +
        "    tex2jax: { " +
        "        inlineMath: [ ['\\\\(','\\\\)'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'inherit ! important'} }," +
        "        linebreaks: { automatic: "+ linebreak +", width: '90% container' }," +
        "    }, " +
        "}); " +
        "if ('default' !== 'default') {" +
            "MathJax.Hub.Register.StartupHook('HTML-CSS Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax['HTML-CSS'].FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
            "MathJax.Hub.Register.StartupHook('SVG Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax.SVG.FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
        "}";
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
&lt;/script&gt;</content><category term="data science"></category><category term="r"></category><category term="machine learning"></category><category term="classification"></category></entry><entry><title>数据科学之机器学习7: 决策树</title><link href="//jacky-sj/cls-decision-trees.html" rel="alternate"></link><published>2014-04-11T19:00:00+08:00</published><updated>2017-03-29T20:30:00+08:00</updated><author><name>Jacky Gong</name></author><id>tag:jacky-sj,2014-04-11:/cls-decision-trees.html</id><summary type="html">&lt;p&gt;决策树算法简介&lt;/p&gt;</summary><content type="html">&lt;p&gt;&lt;em&gt;“文章原创，转载请注明出处”&lt;/em&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;h3&gt;一、开始&lt;/h3&gt;
&lt;hr&gt;
&lt;p&gt;在介绍决策树的概念内容之前，先来初步了解一下决策树的流程。这是一个很简单的概念，通过一张简单的流程图就可以大致了解决策树是干什么的，怎么干的。&lt;/p&gt;
&lt;p&gt;&lt;img alt="decision trees" src="\images\article\a21\decisiontrees.jpg"&gt;&lt;/p&gt;
&lt;h3&gt;二、相关概念&lt;/h3&gt;
&lt;hr&gt;
&lt;h4&gt;1. 一些概念&lt;/h4&gt;
&lt;hr&gt;
&lt;ul&gt;
&lt;li&gt;决策树学习是一种逼近离散值目标函数的方法。&lt;/li&gt;
&lt;li&gt;决策树通过把实例从根节点排列到某个叶子节点来分类实例，叶子的节点即为实例所属的分类。&lt;/li&gt;
&lt;li&gt;决策树上的每一个节点，指定了对实例的某一个属性的测试，并且，该节点的每一个后续分支对应该属性的一个可能值。&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;2. 分类方法&lt;/h4&gt;
&lt;hr&gt;
&lt;p&gt;从树的根节点开始，测试这个节点指定的属性，然后按照给定实例的该属性值对应的分支向下移动。然后以新节点作为根节点重复上面的过程直至结束。&lt;/p&gt;
&lt;h3&gt;三、 评价&lt;/h3&gt;
&lt;hr&gt;
&lt;p&gt;通过决策树的流程，可以发现决策树的计算复杂度不高，而且其输出的结果易于理解，并且对缺失值不敏感。&lt;/p&gt;
&lt;p&gt;但是，正是由于其划分过于细致，可能会导致过度匹配问题(与回归中的overfitting类似)。&lt;/p&gt;
&lt;h3&gt;四、主要的决策树算法&lt;/h3&gt;
&lt;hr&gt;
&lt;p&gt;从决策树的流程可以看出，&lt;strong&gt;如何选择属性作为节点以测试实例&lt;/strong&gt;是最为关键的一步。不同的算法采取了不同的方法，主要的决策树算法有这样几个：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ID3&lt;/li&gt;
&lt;li&gt;C4.5 （数据挖掘十大算法之一，也是ID3算法的改进）&lt;/li&gt;
&lt;li&gt;C5.0 （C4.5的改进，适用于处理大数据集，采用Boosting方式提高模型准确率，因而又称BoostingTrees。）&lt;/li&gt;
&lt;li&gt;CART（数据挖掘十大算法之一）&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;下一篇就开始讲讲一些决策树的算法。&lt;/p&gt;</content><category term="data science"></category><category term="r"></category><category term="machine learning"></category><category term="classification"></category></entry><entry><title>数据科学之机器学习6: 分类之朴素贝叶斯</title><link href="//jacky-sj/cls-naive-bayes.html" rel="alternate"></link><published>2014-04-08T15:54:00+08:00</published><updated>2017-03-29T20:30:00+08:00</updated><author><name>Jacky Gong</name></author><id>tag:jacky-sj,2014-04-08:/cls-naive-bayes.html</id><summary type="html">&lt;p&gt;朴素贝叶斯算法&lt;/p&gt;</summary><content type="html">&lt;p&gt;&lt;em&gt;“文章原创，转载请注明出处”&lt;/em&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;h3&gt;0、kNN算法的优缺点&lt;/h3&gt;
&lt;p&gt;与kNN算法一样，朴素贝叶斯算法也是数据挖掘十大算法之一。我们介绍kNN算法时，并没有讨论kNN算法的优缺点，这边首先看看这个问题。&lt;/p&gt;
&lt;p&gt;从构造kNN算法的过程可以看到，这个分类算法的&lt;strong&gt;精度很高&lt;/strong&gt;。因为这个算法计算了所有点与待分类点之间的相似度，然后去确定带分类点的类别。由此可见，这个算法对&lt;strong&gt;异常值并不敏感&lt;/strong&gt;。但是正是因为它需要计算所有点之间的距离，所以其&lt;strong&gt;复杂度是很高的&lt;/strong&gt;，换句话就是，如果数据量大的话，这个算法会很费时，并不高效。&lt;/p&gt;
&lt;h3&gt;一、贝叶斯决策&lt;/h3&gt;
&lt;hr&gt;
&lt;p&gt;贝叶斯定理给出了条件概率之间的关系，是一个非常重要的定理。这里直接给出贝叶斯定理的结论：&lt;/p&gt;
&lt;div class="math"&gt;$$ P(B  \mid A) = \frac{P(A \mid B)P(B) }{P(A)} $$&lt;/div&gt;
&lt;p&gt;在贝叶斯决策理论里面，要判断点&lt;span class="math"&gt;\(x\)&lt;/span&gt;是否属于&lt;span class="math"&gt;\(C_i\)&lt;/span&gt;类，只要验证是否存在：&lt;/p&gt;
&lt;div class="math"&gt;$$ p(C_i \mid x) = \max_{j} \{ P(C_j \mid x) \} $$&lt;/div&gt;
&lt;p&gt;即是，使得 &lt;span class="math"&gt;\(p(C_i \mid x)\)&lt;/span&gt; 达到最大的那个 &lt;span class="math"&gt;\(C_i\)&lt;/span&gt; 就是 &lt;span class="math"&gt;\(x\)&lt;/span&gt; 所属的类别。&lt;/p&gt;
&lt;h3&gt;二、具体流程&lt;/h3&gt;
&lt;hr&gt;
&lt;p&gt;要计算 &lt;span class="math"&gt;\(P(C_i \mid x)\)&lt;/span&gt;，那么就需要计算 &lt;span class="math"&gt;\(\frac{P(x \mid C_i)P(C_i )}{P(x)}\)&lt;/span&gt;，我们知道对于每一个 &lt;span class="math"&gt;\(P(C_i \mid x)\)&lt;/span&gt;，其计算公式中的分母都是 &lt;span class="math"&gt;\(P(x)\)&lt;/span&gt;，所以有：&lt;/p&gt;
&lt;div class="math"&gt;$$ P(C_i \mid x) \propto P(x \mid C_i)P(C_i ) $$&lt;/div&gt;
&lt;p&gt;所以我们实际计算时，只需要考虑上式右侧的大小即可。首先我们来确定一些符号的意思：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;span class="math"&gt;\(x = [x_1, x_2, \dots, x_p]\)&lt;/span&gt; 为一个带分类的项，&lt;span class="math"&gt;\(x_i\)&lt;/span&gt; 为其特征；&lt;/li&gt;
&lt;li&gt;data表示一个已知分类的数据集(&lt;span class="math"&gt;\(n \times p\)&lt;/span&gt; 的矩阵)，其每一行代表一个观测，每一列代表一个特征；&lt;/li&gt;
&lt;li&gt;label表示data中每一个数据对应的类别标签(&lt;span class="math"&gt;\( n \times 1\)&lt;/span&gt; 的矩阵)，比如 data 的第一行观测的类别就是 label 中的第一个取值；&lt;/li&gt;
&lt;li&gt;&lt;span class="math"&gt;\(C = [ C_1, C_2, \dots, C_m ]\)&lt;/span&gt; 为一个类别集合，一般来说 &lt;span class="math"&gt;\(m &amp;lt; p\)&lt;/span&gt;。&lt;/li&gt;
&lt;/ul&gt;
&lt;h5&gt;步骤：&lt;/h5&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;在已知分类的数据集data中统计：&lt;/p&gt;
&lt;p&gt;
&lt;div class="math"&gt;$$P(C_i), i = 1, 2, \dots, m$$&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;
&lt;div class="math"&gt;$$P(x_j \mid C_i), i = 1, 2, \dots, m; j = 1, 2, \dots p$$&lt;/div&gt;
&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;计算&lt;/p&gt;
&lt;p&gt;
&lt;div class="math"&gt;$$P(x \mid C_i)P(C_i ) = P(C_i) \prod_{j=1}^{p} {P(x_j \mid C_i)}, i = 1, 2, \dots, m$$&lt;/div&gt;
&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;若&lt;/p&gt;
&lt;p&gt;
&lt;div class="math"&gt;$$P(x \mid C_k)P(C_k) = \max\{ P(x \mid C_i)P(C_i ) \}$$&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;则 &lt;span class="math"&gt;\(x \in C_k\)&lt;/span&gt;。&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3&gt;三、一些存在的问题&lt;/h3&gt;
&lt;hr&gt;
&lt;ol&gt;
&lt;li&gt;当步骤的第2步中，&lt;span class="math"&gt;\(P(x \mid C_i)P(C_i ) = P(C_i) \prod_{j=1}^{p} {P(x_j \mid C_i)}, i = 1, 2, \dots, m\)&lt;/span&gt;，中 &lt;span class="math"&gt;\(P(x_j \mid C_i)\)&lt;/span&gt; 可能在样本较小时取值出现0，那么就会影响乘积；&lt;/li&gt;
&lt;li&gt;计算机计算时会出现精度问题，比如，如果 &lt;span class="math"&gt;\(P(x_j \mid C_i)\)&lt;/span&gt; 的值有很多都是非常小的（像0.000001），那么计算机在计算是会将其四舍五入成0。&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;出现上面的情况应该怎么办呢？&lt;/p&gt;
&lt;p&gt;学数学的应该都清楚，遇到这种问题有一个很简单的处理方式，那就是取个对数。虽说取对数后会改变值的大小，但是取对数不会改变原本数据趋势，即原来大的数，取对数后还是大的。&lt;/p&gt;
&lt;p&gt;此外，对于 &lt;span class="math"&gt;\(P(x_j \mid C_i)\)&lt;/span&gt; 可能在样本较小时取值出现0的情况，处理也很简单，那就是将每一个 &lt;span class="math"&gt;\(x_j\)&lt;/span&gt; 的初值都设置成1，所有特征的基数都从1开始，不会影响结果。（这时需要注意，所有特征的初值都是1，对应的总数初值也会发生变化。）&lt;/p&gt;
&lt;h3&gt;四、R语言实现&lt;/h3&gt;
&lt;hr&gt;
&lt;p&gt;见&lt;a href="https://github.com/JackyCode/Data_Science"&gt;我的项目&lt;/a&gt;&lt;/p&gt;
&lt;script type="text/javascript"&gt;if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var align = "center",
        indent = "0em",
        linebreak = "false";

    if (false) {
        align = (screen.width &lt; 768) ? "left" : align;
        indent = (screen.width &lt; 768) ? "0em" : indent;
        linebreak = (screen.width &lt; 768) ? 'true' : linebreak;
    }

    var mathjaxscript = document.createElement('script');
    var location_protocol = (false) ? 'https' : document.location.protocol;
    if (location_protocol !== 'http' &amp;&amp; location_protocol !== 'https') location_protocol = 'https:';
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = location_protocol + '//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML';
    mathjaxscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: '"+ align +"'," +
        "    displayIndent: '"+ indent +"'," +
        "    showMathMenu: true," +
        "    messageStyle: 'normal'," +
        "    tex2jax: { " +
        "        inlineMath: [ ['\\\\(','\\\\)'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'inherit ! important'} }," +
        "        linebreaks: { automatic: "+ linebreak +", width: '90% container' }," +
        "    }, " +
        "}); " +
        "if ('default' !== 'default') {" +
            "MathJax.Hub.Register.StartupHook('HTML-CSS Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax['HTML-CSS'].FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
            "MathJax.Hub.Register.StartupHook('SVG Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax.SVG.FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
        "}";
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
&lt;/script&gt;</content><category term="data science"></category><category term="r"></category><category term="machine learning"></category><category term="classification"></category></entry><entry><title>数据科学之机器学习5：分类之k-近邻算法</title><link href="//jacky-sj/cls-knn.html" rel="alternate"></link><published>2014-04-05T19:59:00+08:00</published><updated>2017-03-29T20:30:00+08:00</updated><author><name>Jacky Gong</name></author><id>tag:jacky-sj,2014-04-05:/cls-knn.html</id><summary type="html">&lt;p&gt;kNN 算法介绍&lt;/p&gt;</summary><content type="html">&lt;p&gt;&lt;em&gt;“文章原创，转载请注明出处”&lt;/em&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;h4&gt;基本思想&lt;/h4&gt;
&lt;hr&gt;
&lt;p&gt;kNN，k-Nearest Neighbor algorithm，也就这边的k-近邻算法，是数据挖掘十大算法之一，是一个比较简单的分类方法。&lt;/p&gt;
&lt;p&gt;其基本的思想是：对于一个输入样本（未知分类的样本），考虑其与测试样本中与之距离最近（特征最相似）的k个样本，用这k个样本中出现最多的分类作为输入样本的分类。&lt;/p&gt;
&lt;h4&gt;具体流程&lt;/h4&gt;
&lt;hr&gt;
&lt;p&gt;对于输入样本中的每一个点，进行以下操作：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;计算点与测试样本中点的距离；&lt;/li&gt;
&lt;li&gt;取出与当前点距离最小的k个点；&lt;/li&gt;
&lt;li&gt;确定k个点的分类，计算各个分类的频数；&lt;/li&gt;
&lt;li&gt;返回频数最高的类别，作为该输入点的预测分类。&lt;/li&gt;
&lt;/ol&gt;
&lt;h4&gt;距离的计算&lt;/h4&gt;
&lt;hr&gt;
&lt;p&gt;上面一直在说，计算输入样本中点与测试样本中点之间的距离，那么这个距离应该怎么计算呢？这个距离一般就是使用欧式距离：&lt;/p&gt;
&lt;div class="math"&gt;$$ d = \sqrt{(x - y)^T(x - y)} $$&lt;/div&gt;
&lt;p&gt;其中 &lt;span class="math"&gt;\(x^T=[x_1, x_2,\dots,x_n], y^T=[y_1,y_2,\dots,y_n]\)&lt;/span&gt;。二维的表示就是：&lt;/p&gt;
&lt;div class="math"&gt;$$ d = \sqrt{(x - y)^T(x - y)} = \sqrt{(x_1 - y_1)^2 + (x_2 - y_2)^2} $$&lt;/div&gt;
&lt;h4&gt;R语言实现&lt;/h4&gt;
&lt;hr&gt;
&lt;p&gt;见&lt;a href="https://github.com/JackyCode/Data_Science/tree/master/kNN"&gt;我的github&lt;/a&gt;。&lt;/p&gt;
&lt;script type="text/javascript"&gt;if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var align = "center",
        indent = "0em",
        linebreak = "false";

    if (false) {
        align = (screen.width &lt; 768) ? "left" : align;
        indent = (screen.width &lt; 768) ? "0em" : indent;
        linebreak = (screen.width &lt; 768) ? 'true' : linebreak;
    }

    var mathjaxscript = document.createElement('script');
    var location_protocol = (false) ? 'https' : document.location.protocol;
    if (location_protocol !== 'http' &amp;&amp; location_protocol !== 'https') location_protocol = 'https:';
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = location_protocol + '//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML';
    mathjaxscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: '"+ align +"'," +
        "    displayIndent: '"+ indent +"'," +
        "    showMathMenu: true," +
        "    messageStyle: 'normal'," +
        "    tex2jax: { " +
        "        inlineMath: [ ['\\\\(','\\\\)'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'inherit ! important'} }," +
        "        linebreaks: { automatic: "+ linebreak +", width: '90% container' }," +
        "    }, " +
        "}); " +
        "if ('default' !== 'default') {" +
            "MathJax.Hub.Register.StartupHook('HTML-CSS Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax['HTML-CSS'].FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
            "MathJax.Hub.Register.StartupHook('SVG Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax.SVG.FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
        "}";
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
&lt;/script&gt;</content><category term="data science"></category><category term="r"></category><category term="machine learning"></category><category term="classification"></category></entry><entry><title>数据科学之机器学习4：线性回归3</title><link href="//jacky-sj/linear-regression3.html" rel="alternate"></link><published>2014-04-02T18:51:00+08:00</published><updated>2017-03-29T20:30:00+08:00</updated><author><name>Jacky Gong</name></author><id>tag:jacky-sj,2014-04-02:/linear-regression3.html</id><summary type="html">&lt;p&gt;线性回归 3&lt;/p&gt;</summary><content type="html">&lt;p&gt;&lt;em&gt;“文章原创，转载请注明出处”&lt;/em&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;这是介绍线性回归的最后一篇，首先回顾一下之前的两篇。第一篇主要就是介绍了如何去估计回归系数得到回归方程，以及在R语言中如何使用自带的函数去实现。第二篇主要介绍了对于回归方程和回归系数的显著性检验，以及给出了我自己写的一个处理线性回归的函数。&lt;/p&gt;
&lt;p&gt;这一篇介绍线性回归中回归诊断的一些问题，也就是估计出回归方程，检验了回归方程的显著性以及回归系数的显著性后，对这个模型所做的进一步的诊断分析。然后对存在的问题进行探讨，选择不同的方式去解决这些问题。这大致可以分成三块：残差分析，影响分析以及共线性问题。&lt;/p&gt;
&lt;hr&gt;
&lt;h4&gt;一、残差分析&lt;/h4&gt;
&lt;hr&gt;
&lt;h5&gt;1. 残差&lt;/h5&gt;
&lt;hr&gt;
&lt;p&gt;首先看一看残差的定义，常用的残差大致有三种：残差，标准化残差以及学生化残差：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;残差：&lt;span class="math"&gt;\(\hat{\varepsilon} = y - \hat{y} = (1-H)y\)&lt;/span&gt;,其中 &lt;span class="math"&gt;\(H=X(X^TX)^{-1}X\)&lt;/span&gt; 称作帽子矩阵；&lt;/li&gt;
&lt;li&gt;标准化残差：&lt;span class="math"&gt;\(ZRE = \hat{\varepsilon} / \hat{\sigma}\)&lt;/span&gt;&lt;/li&gt;
&lt;li&gt;学生化残差：&lt;span class="math"&gt;\(SRE_i = \hat{\varepsilon}_i / (\hat{\sigma}\sqrt{1-h_{ii}})\)&lt;/span&gt;，其中 &lt;span class="math"&gt;\(h_{ii}\)&lt;/span&gt; 为帽子矩阵对角线上第&lt;span class="math"&gt;\(i\)&lt;/span&gt;个元素。&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;p&gt;&lt;strong&gt;R语言中&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;使用&lt;code&gt;residuals(),rstandard(),rstudent()&lt;/code&gt;函数计算残差，标准化残差以及学生化残差。具体用法，请使用&lt;code&gt;help&lt;/code&gt;函数查看。&lt;/p&gt;
&lt;hr&gt;
&lt;h5&gt;2. 残差图&lt;/h5&gt;
&lt;hr&gt;
&lt;p&gt;以残差为纵坐标，观测值、预测值活则观测时间等等作为横坐标的散点图，称为&lt;strong&gt;残差图&lt;/strong&gt;。&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;&lt;strong&gt;R语言中&lt;/strong&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="code-line"&gt;&lt;span&gt;&lt;/span&gt;model &lt;span class="o"&gt;=&lt;/span&gt; lm&lt;span class="p"&gt;(&lt;/span&gt;y&lt;span class="o"&gt;~&lt;/span&gt;x1&lt;span class="o"&gt;+&lt;/span&gt;x2&lt;span class="p"&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;y_pred &lt;span class="o"&gt;=&lt;/span&gt; predict&lt;span class="p"&gt;(&lt;/span&gt;model&lt;span class="p"&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;y_res &lt;span class="o"&gt;=&lt;/span&gt; residuals&lt;span class="p"&gt;(&lt;/span&gt;model&lt;span class="p"&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;plot&lt;span class="p"&gt;(&lt;/span&gt;y_res &lt;span class="o"&gt;~&lt;/span&gt; y_pred&lt;span class="p"&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;hr&gt;
&lt;h5&gt;3. 异方差问题&lt;/h5&gt;
&lt;hr&gt;
&lt;h6&gt;a. 问题的提出&lt;/h6&gt;
&lt;hr&gt;
&lt;p&gt;在进行回归方程估计之前，一般都会假设误差的方差是齐性的。如果残差图出现类似下面的情况，则这批数据可能存在异方差问题，即方差非齐性。&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;随着横坐标的增大，纵坐标的值波动越来越大；&lt;/li&gt;
&lt;li&gt;随着横坐标的增大，纵坐标的值波动越来越小；&lt;/li&gt;
&lt;li&gt;随着横坐标的增大，纵坐标的值波动复杂多变，没有系统关系；&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;大部分时候，考虑前两种就可以了。那么具体如何数值化地检验异方差呢，一般使用的是等级相关系数法，这里不做介绍(可到线性回归的书籍中寻找)。&lt;/p&gt;
&lt;hr&gt;
&lt;h6&gt;b. 问题的解决&lt;/h6&gt;
&lt;hr&gt;
&lt;p&gt;一般有两种方式解决异方差问题，一种是加权最小二乘；另一种是对因变量作适当的变化。&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;加权最小二乘&lt;/p&gt;
&lt;p&gt;即是将回归系数的估计转化成：&lt;span class="math"&gt;\(\hat{\beta}=(X^TWX)^{-1}X^TWy\)&lt;/span&gt;，其中 &lt;span class="math"&gt;\(W\)&lt;/span&gt; 是一个对角矩阵，用于给每一个数据点加上一个权重。一般使用“核”来对附近的点赋予较高的权重，常用的核就是高斯核，其对应的权重为：&lt;/p&gt;
&lt;p&gt;
&lt;div class="math"&gt;$$w_{ii}=exp(\frac{\|x^{(i)}-x\|}{-2k^2})$$&lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;从上式可以看出，点&lt;span class="math"&gt;\(x\)&lt;/span&gt;离&lt;span class="math"&gt;\(x^{(i)}\)&lt;/span&gt;越近，所得到的权重越高。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;对因变量作适当变化&lt;/p&gt;
&lt;p&gt;常用的变换有：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;span class="math"&gt;\(z = \sqrt{y}\)&lt;/span&gt;&lt;/li&gt;
&lt;li&gt;&lt;span class="math"&gt;\(z = ln(y)\)&lt;/span&gt;（对数变换）&lt;/li&gt;
&lt;li&gt;&lt;span class="math"&gt;\(z = 1/y\)&lt;/span&gt;&lt;/li&gt;
&lt;li&gt;&lt;span class="math"&gt;\(z = \frac{x^{\lambda}-1}{\lambda}\)&lt;/span&gt;(Box-Cox变换)，其中&lt;span class="math"&gt;\(\lambda=0\)&lt;/span&gt;时，即是对数变换&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h5&gt;4. 异常点&lt;/h5&gt;
&lt;hr&gt;
&lt;h6&gt;a. 问题的提出&lt;/h6&gt;
&lt;hr&gt;
&lt;p&gt;一般将标准化残差的绝对值大于等于2的称为可疑点；将标准化残差的绝对值大于等于3的称为异常点。&lt;/p&gt;
&lt;hr&gt;
&lt;h6&gt;b. 问题的解决&lt;/h6&gt;
&lt;hr&gt;
&lt;p&gt;一般来说，剔除异常数据即可。&lt;/p&gt;
&lt;hr&gt;
&lt;h5&gt;5. 自相关问题&lt;/h5&gt;
&lt;hr&gt;
&lt;p&gt;在作回归之前，总是会假设 &lt;span class="math"&gt;\(cov(\varepsilon_i, \varepsilon_j)=0,\forall i \neq j\)&lt;/span&gt;。但是实际情况下，可能并不满足这个假设，这就是存在了自相关问题。对于自相关问题，一般使用残差图，自相关系数以及DW检验去进行检验；而处理的方式一般是：迭代法和差分法。这里不做详细介绍，感兴趣的可以去找找相关材料。&lt;/p&gt;
&lt;hr&gt;
&lt;h4&gt;二、影响分析&lt;/h4&gt;
&lt;hr&gt;
&lt;p&gt;分析观测值对回归结果的影响，从而找出对回归结果影响较大的观测点的分析方法叫做影响分析。一般使用Cook距离去度量第&lt;span class="math"&gt;\(i\)&lt;/span&gt;个观测值对回归影响大小，Cook距离的定义如下：&lt;/p&gt;
&lt;div class="math"&gt;$$D_i(M,MSE) = \frac{(\hat{\beta}_{(i)}-\hat{\beta})^TM(\hat{\beta}_{(i)}-\hat{\beta})}{MSE}$$&lt;/div&gt;
&lt;p&gt;其中，&lt;span class="math"&gt;\(M\)&lt;/span&gt;为观测数据的离差阵，&lt;span class="math"&gt;\(MSE\)&lt;/span&gt;为回归模型的均方误差。一般 &lt;span class="math"&gt;\(\|D_i\| \geqslant 4/n\)&lt;/span&gt; 时，称其为强影响点。&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;&lt;strong&gt;R语言中&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;使用&lt;code&gt;cooks.distance()&lt;/code&gt;函数计算Cook距离。&lt;/p&gt;
&lt;hr&gt;
&lt;h4&gt;三、共线性诊断&lt;/h4&gt;
&lt;hr&gt;
&lt;p&gt;共线性是指，在多元线性回归中，自变量之间存在线性关系或者近似线性关系。如果出现这种情况，那么在模型内部就会隐藏部分变量的显著性，也会导致参数估计的误差增大，影响模型的稳定性。&lt;/p&gt;
&lt;hr&gt;
&lt;h5&gt;a. 检验方法&lt;/h5&gt;
&lt;hr&gt;
&lt;p&gt;常用的检验方法有特征值法，条件数和方差膨胀因子（VIF）。&lt;/p&gt;
&lt;hr&gt;
&lt;h6&gt;特征值法&lt;/h6&gt;
&lt;hr&gt;
&lt;p&gt;首先介绍一个结论：当矩阵&lt;span class="math"&gt;\(X^TX\)&lt;/span&gt;至少有一个特征根为0时，&lt;span class="math"&gt;\(X\)&lt;/span&gt; 的列向量间必存在多重共线性。&lt;/p&gt;
&lt;p&gt;即可证：&lt;span class="math"&gt;\(X^TX\)&lt;/span&gt; 有多少个特征根接近于零，设计阵 &lt;span class="math"&gt;\(X\)&lt;/span&gt; 就有多少个多重共线性。&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;&lt;strong&gt;在R语言中&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;可以使用&lt;code&gt;eigen()&lt;/code&gt;函数去计算特征值和特征向量。&lt;/p&gt;
&lt;hr&gt;
&lt;h6&gt;条件数&lt;/h6&gt;
&lt;hr&gt;
&lt;p&gt;上述的特征值法中，特征根近似为0，这个标准好想并不明确。那么这边就给出一个条件数的定义：&lt;/p&gt;
&lt;div class="math"&gt;$$k_i = \frac{\lambda_m}{\lambda_i}$$&lt;/div&gt;
&lt;p&gt;其中，&lt;span class="math"&gt;\(\lambda_m\)&lt;/span&gt; 为最大的那个特征根。一般认为，若&lt;span class="math"&gt;\(k_i\)&lt;/span&gt;介于10到30之间为弱相关；在30到100之间为中等相关；超过100为强相关。&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;&lt;strong&gt;在R语言中&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;可以使用&lt;code&gt;kappa()&lt;/code&gt;函数计算条件数。&lt;/p&gt;
&lt;hr&gt;
&lt;h6&gt;VIF&lt;/h6&gt;
&lt;hr&gt;
&lt;p&gt;定义VIF为：&lt;/p&gt;
&lt;div class="math"&gt;$$VIF_i = \frac{\text{第i个回归系数的方差}}{\text{自变量不相关时第i个回归系数的方差}} = \frac{1}{1-R^2_i} = \frac{1}{TOL_i}$$&lt;/div&gt;
&lt;p&gt;其中 &lt;span class="math"&gt;\(TOL_i\)&lt;/span&gt; 称为容忍度；&lt;span class="math"&gt;\(R^2_i\)&lt;/span&gt; 为自变量 &lt;span class="math"&gt;\(x_i\)&lt;/span&gt; 对其余自变量的复决定系数。一般认为，VIF超过10，模型就存在共线性问题。&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;&lt;strong&gt;在R语言中&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;可以使用&lt;code&gt;vif()&lt;/code&gt;函数计算VIF的值。&lt;/p&gt;
&lt;hr&gt;
&lt;h5&gt;b. 多重共线性的处理&lt;/h5&gt;
&lt;hr&gt;
&lt;p&gt;一般有这样几种处理方式：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;剔除一些不重要的解释变量&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;使用变量选择的方式剔除部分变量，作回归；&lt;/li&gt;
&lt;li&gt;检验VIF，若存在共线性，删除VIF值最大的变量，作回归；&lt;/li&gt;
&lt;li&gt;再次检验VIF，若还存在共线性，再删除其中VIF值最大的那个；&lt;/li&gt;
&lt;li&gt;重复直至消除共线性。&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;增大样本容量&lt;/p&gt;
&lt;p&gt;当变量的个数接近样本容量的数值时，自变量间容易产生多重共线性。所以增大样本容量是解决多重共线性的一种方式，但是在现实中，这种做法基本不可能。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;主成分回归&lt;/p&gt;
&lt;p&gt;这是一个比较大的主题，这里不做介绍。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;有偏估计等等。&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3&gt;最后&lt;/h3&gt;
&lt;hr&gt;
&lt;p&gt;到这里，除了变量选择问题，线性回归的内容基本上就已经梳理了一遍。变量选择问题，方法简单的非常简单，难的非常难（像lasso），所以暂时还不想写这些内容。&lt;/p&gt;
&lt;script type="text/javascript"&gt;if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var align = "center",
        indent = "0em",
        linebreak = "false";

    if (false) {
        align = (screen.width &lt; 768) ? "left" : align;
        indent = (screen.width &lt; 768) ? "0em" : indent;
        linebreak = (screen.width &lt; 768) ? 'true' : linebreak;
    }

    var mathjaxscript = document.createElement('script');
    var location_protocol = (false) ? 'https' : document.location.protocol;
    if (location_protocol !== 'http' &amp;&amp; location_protocol !== 'https') location_protocol = 'https:';
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = location_protocol + '//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML';
    mathjaxscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: '"+ align +"'," +
        "    displayIndent: '"+ indent +"'," +
        "    showMathMenu: true," +
        "    messageStyle: 'normal'," +
        "    tex2jax: { " +
        "        inlineMath: [ ['\\\\(','\\\\)'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'inherit ! important'} }," +
        "        linebreaks: { automatic: "+ linebreak +", width: '90% container' }," +
        "    }, " +
        "}); " +
        "if ('default' !== 'default') {" +
            "MathJax.Hub.Register.StartupHook('HTML-CSS Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax['HTML-CSS'].FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
            "MathJax.Hub.Register.StartupHook('SVG Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax.SVG.FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
        "}";
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
&lt;/script&gt;</content><category term="data science"></category><category term="r"></category><category term="machine learning"></category><category term="regression"></category></entry><entry><title>数据科学之机器学习3：线性回归2</title><link href="//jacky-sj/linear-regression2.html" rel="alternate"></link><published>2014-04-01T16:56:00+08:00</published><updated>2017-03-29T20:30:00+08:00</updated><author><name>Jacky Gong</name></author><id>tag:jacky-sj,2014-04-01:/linear-regression2.html</id><summary type="html">&lt;p&gt;线性回归 2&lt;/p&gt;</summary><content type="html">&lt;p&gt;&lt;em&gt;“文章原创，转载请注明出处”&lt;/em&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;上一篇简单介绍了线性回归中系数估计的问题，给出了一元以及多元情况下，系数估计值的表达式！此外，还给出了在R语言中如何使用自带的函数计算系数估计值。&lt;/p&gt;
&lt;p&gt;这一篇，打算介绍一下线性回归中的一些显著性检验问题。这个就是完全属于统计学中的理论内容，不过依旧有着很强的实际意义。简单来说，显著性检验不能通过，说明你的线性回归的效果不好，可能你就需要选择其它的方式去处理你手头的数据，而不是选择线性回归了。&lt;/p&gt;
&lt;hr&gt;
&lt;h4&gt;一、回归方程的显著性检验&lt;/h4&gt;
&lt;hr&gt;
&lt;p&gt;考虑回归方程是否显著，意思就是查看自变量 &lt;span class="math"&gt;\(x_1,x_2,\dots,x_p\)&lt;/span&gt; 从整体上是否对因变量 &lt;span class="math"&gt;\(y\)&lt;/span&gt; 有显著的影响。则，我们可以考虑这样的假设检验问题：&lt;/p&gt;
&lt;div class="math"&gt;$$ H_0:\beta_0=\beta_1=\dots=\beta_p=0;~H_1:\beta_0,\beta_1,\dots,\beta_p\text{不全为0}$$&lt;/div&gt;
&lt;p&gt;显然，如果原假设成立的话，自变量对因变量的影响不大，也就是用线性回归模型来解释就显得不合适了。&lt;/p&gt;
&lt;p&gt;在正态假设下，原假设 &lt;span class="math"&gt;\(H_0\)&lt;/span&gt; 成立时，有 &lt;span class="math"&gt;\(F\)&lt;/span&gt; 检验统计量：&lt;/p&gt;
&lt;div class="math"&gt;$$ F = \frac{SSR/p}{SSE/(n-p-1)} \sim F(p,n-p-1) $$&lt;/div&gt;
&lt;p&gt;其中 &lt;span class="math"&gt;\(SSR=\sum_{i=1}^{n}{(\hat{y}_i-\overline{y})^2}\)&lt;/span&gt; 为回归平方和，&lt;span class="math"&gt;\(SSE=\sum_{i=1}^{n}{(y_i-\hat{y}_i)^2}\)&lt;/span&gt; 为残差平方和。对于给定的显著性水平 &lt;span class="math"&gt;\(\alpha\)&lt;/span&gt;，拒绝域为：&lt;span class="math"&gt;\(\{F \geqslant F_{1-\alpha}(p,n-p-1)\}\)&lt;/span&gt;。&lt;/p&gt;
&lt;hr&gt;
&lt;h4&gt;二、回归系数的显著性检验&lt;/h4&gt;
&lt;hr&gt;
&lt;p&gt;显然，线性回归中很有可能就存在某个自变量对因变量的影响很小，那么它的回归系数就会接近0.因此有如下的假设检验问题：&lt;/p&gt;
&lt;div class="math"&gt;$$H_{0j}:\beta_j = 0; ~ H_{1j}:\beta_j \neq 0, ~ j=0,1,\dots,p$$&lt;/div&gt;
&lt;p&gt;在原假设成立的条件下，&lt;span class="math"&gt;\(t\)&lt;/span&gt;统计量有：&lt;/p&gt;
&lt;div class="math"&gt;$$t_j = \frac{\hat{\beta}_j}{\sqrt{c_{jj}}\hat{\sigma}} \sim t(n-p-1)$$&lt;/div&gt;
&lt;p&gt;其中，&lt;/p&gt;
&lt;div class="math"&gt;$$(c_{ij})=(X^TX)^{-1},i,j=0,1,\dots,p;~\hat{\sigma}=\sqrt{\frac{1}{n-p-1}\sum_{i=1}^{n}{(y_i-\hat{y}_i)^2}}$$&lt;/div&gt;
&lt;p&gt;。对于给定的显著性水平&lt;span class="math"&gt;\(\alpha\)&lt;/span&gt;，拒绝域为：&lt;span class="math"&gt;\(\{\|t_j\| \geqslant t_{\alpha/2}\}\)&lt;/span&gt;。&lt;/p&gt;
&lt;hr&gt;
&lt;h4&gt;三、R语言中的实现&lt;/h4&gt;
&lt;hr&gt;
&lt;p&gt;在上一篇中可以看到，&lt;code&gt;lm&lt;/code&gt;函数加上&lt;code&gt;summary&lt;/code&gt;函数会有很多的输出内容。其实，那些输出中就含有上述的假设检验的结果，很容易就可以找到，这里不做阐述！&lt;/p&gt;
&lt;p&gt;我自己也写了一个关于线性回归的R语言函数，托管在&lt;a href="https://github.com/JackyCode/Data_Science/tree/master/Linear_Regression"&gt;我的github&lt;/a&gt;上面，函数内部对于线性回归的过程大都涉及到了，有兴趣可以看看。&lt;/p&gt;
&lt;script type="text/javascript"&gt;if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var align = "center",
        indent = "0em",
        linebreak = "false";

    if (false) {
        align = (screen.width &lt; 768) ? "left" : align;
        indent = (screen.width &lt; 768) ? "0em" : indent;
        linebreak = (screen.width &lt; 768) ? 'true' : linebreak;
    }

    var mathjaxscript = document.createElement('script');
    var location_protocol = (false) ? 'https' : document.location.protocol;
    if (location_protocol !== 'http' &amp;&amp; location_protocol !== 'https') location_protocol = 'https:';
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = location_protocol + '//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML';
    mathjaxscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: '"+ align +"'," +
        "    displayIndent: '"+ indent +"'," +
        "    showMathMenu: true," +
        "    messageStyle: 'normal'," +
        "    tex2jax: { " +
        "        inlineMath: [ ['\\\\(','\\\\)'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'inherit ! important'} }," +
        "        linebreaks: { automatic: "+ linebreak +", width: '90% container' }," +
        "    }, " +
        "}); " +
        "if ('default' !== 'default') {" +
            "MathJax.Hub.Register.StartupHook('HTML-CSS Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax['HTML-CSS'].FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
            "MathJax.Hub.Register.StartupHook('SVG Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax.SVG.FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
        "}";
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
&lt;/script&gt;</content><category term="data science"></category><category term="r"></category><category term="machine learning"></category><category term="regression"></category></entry><entry><title>数据科学之机器学习2：线性回归1</title><link href="//jacky-sj/linear-regression1.html" rel="alternate"></link><published>2014-03-30T19:02:00+08:00</published><updated>2017-03-29T20:30:00+08:00</updated><author><name>Jacky Gong</name></author><id>tag:jacky-sj,2014-03-30:/linear-regression1.html</id><summary type="html">&lt;p&gt;线性回归 1&lt;/p&gt;</summary><content type="html">&lt;p&gt;&lt;em&gt;“文章原创，转载请注明出处”&lt;/em&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;h4&gt;一、回归分析&lt;/h4&gt;
&lt;hr&gt;
&lt;p&gt;在统计分析中，最大的两支应该算是相关分析和回归分析。而回归分析应该是统计学的核心。回归分析，就是研究因变量 &lt;span class="math"&gt;\(y\)&lt;/span&gt; 与自变量 &lt;span class="math"&gt;\(x\)&lt;/span&gt; 之间的关系，存在条件数学期望：&lt;span class="math"&gt;\(f(x)=E(y\|x)\)&lt;/span&gt;。此时有：&lt;span class="math"&gt;\(y=f(x)+\varepsilon\)&lt;/span&gt;，一般假设&lt;span class="math"&gt;\(\varepsilon \sim N(0,\sigma^2)\)&lt;/span&gt;。&lt;/p&gt;
&lt;p&gt;回归分析有很多变种：简单线性回归；多项式回归；Logistic回归；非参数回归；非线性回归等等。本篇就介绍最简单的线性回归，首先来看看一元线性回归。&lt;/p&gt;
&lt;hr&gt;
&lt;h4&gt;二、一元线性回归&lt;/h4&gt;
&lt;hr&gt;
&lt;p&gt;对于一元线性回归来说，&lt;span class="math"&gt;\(f(x)\)&lt;/span&gt; 就是线性的，则有：&lt;span class="math"&gt;\(f(x)=E(y\|x)=\beta_0 + \beta_1 x\)&lt;/span&gt;。通过已知的数据，可以估计出 &lt;span class="math"&gt;\(\beta_0,\beta_1\)&lt;/span&gt; 的估计值：&lt;span class="math"&gt;\(\hat{\beta}_0,\hat{\beta}_1\)&lt;/span&gt;。那么就有 &lt;span class="math"&gt;\(y\)&lt;/span&gt; 的预测值：&lt;span class="math"&gt;\(\hat{y} = \hat{\beta}_0 + \hat{\beta}_1 x\)&lt;/span&gt;。&lt;/p&gt;
&lt;hr&gt;
&lt;h5&gt;1. 如何计算 &lt;span class="math"&gt;\(\beta_0,\beta_1\)&lt;/span&gt; 的估计值 &lt;span class="math"&gt;\(\hat{\beta}_0,\hat{\beta}_1\)&lt;/span&gt; 呢？&lt;/h5&gt;
&lt;hr&gt;
&lt;p&gt;定义离差平方和：&lt;/p&gt;
&lt;div class="math"&gt;$$Q(\beta_0,\beta_1) = \sum_{i=1}^{n}(y_i-f(x_i))^2$$&lt;/div&gt;
&lt;p&gt;显然，我们希望 &lt;span class="math"&gt;\(f(x_i)\)&lt;/span&gt; 的值与真实值 &lt;span class="math"&gt;\(y_i\)&lt;/span&gt; 越接近越好。那么就是需要离差平方和越小越好。则得到目标：&lt;/p&gt;
&lt;div class="math"&gt;$$ \min_{\beta_0,\beta_1}{\sum_{i=1}^{n}(y_i-f(x_i))^2} $$&lt;/div&gt;
&lt;p&gt;如何寻找 &lt;span class="math"&gt;\(\hat{\beta}_0,\hat{\beta}_1\)&lt;/span&gt; 使得上面方程达到最小呢？这个就需要对其对 &lt;span class="math"&gt;\(\hat{\beta}_0,\hat{\beta}_1\)&lt;/span&gt; 求偏导，得到：&lt;/p&gt;
&lt;div class="math"&gt;$$\frac{\partial Q}{\partial \beta_0}=-2\sum_{i=1}^{n}{(y_i-\beta_0-\beta_1x_i)}$$&lt;/div&gt;
&lt;div class="math"&gt;$$\frac{\partial Q}{\partial \beta_1}=-2\sum_{i=1}^{n}{(y_i-\beta_0-\beta_1x_i)x_i}$$&lt;/div&gt;
&lt;p&gt;令上述两式都等于0，计算得到：&lt;/p&gt;
&lt;div class="math"&gt;$$\hat{\beta}_0=\overline{y}-\hat{\beta}_1\overline{x}$$&lt;/div&gt;
&lt;div class="math"&gt;$$\hat{\beta}_1=\frac{\sum_{i=1}^{n}{(x_i-\overline{x})(y_i-\overline{x})}}{\sum_{i=1}^{n}{(x-\overline{x})^2}}$$&lt;/div&gt;
&lt;p&gt;这样就得到 &lt;span class="math"&gt;\(\beta_0,\beta_1\)&lt;/span&gt; 的估计值 &lt;span class="math"&gt;\(\hat{\beta}_0,\hat{\beta}_1\)&lt;/span&gt;。这个方法就叫做OLS，即普通最小二乘(ordinary least squares)。&lt;/p&gt;
&lt;hr&gt;
&lt;h5&gt;2. R语言实现&lt;/h5&gt;
&lt;hr&gt;
&lt;p&gt;在R语言中有自带的函数可以处理线性回归，那就是&lt;code&gt;lm&lt;/code&gt;函数。这里使用自带的数据&lt;code&gt;cars&lt;/code&gt;做演示：&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="code-line"&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="kn"&gt;attach&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;cars&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="c1"&gt;# 使用数据集cars，与with函数类似&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; lingre &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; lm&lt;span class="p"&gt;(&lt;/span&gt;dist &lt;span class="o"&gt;~&lt;/span&gt; speed&lt;span class="p"&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="kp"&gt;summary&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;lingre&lt;span class="p"&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;Call&lt;span class="o"&gt;:&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;lm&lt;span class="p"&gt;(&lt;/span&gt;formula &lt;span class="o"&gt;=&lt;/span&gt; dist &lt;span class="o"&gt;~&lt;/span&gt; speed&lt;span class="p"&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;Residuals&lt;span class="o"&gt;:&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;    Min      &lt;span class="m"&gt;1&lt;/span&gt;Q  Median      &lt;span class="m"&gt;3&lt;/span&gt;Q     Max&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;span class="m"&gt;-29.069&lt;/span&gt;  &lt;span class="m"&gt;-9.525&lt;/span&gt;  &lt;span class="m"&gt;-2.272&lt;/span&gt;   &lt;span class="m"&gt;9.215&lt;/span&gt;  &lt;span class="m"&gt;43.201&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;Coefficients&lt;span class="o"&gt;:&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;            Estimate Std. Error t value Pr&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;|&lt;/span&gt;&lt;span class="kp"&gt;t&lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;span class="p"&gt;(&lt;/span&gt;Intercept&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="m"&gt;-17.5791&lt;/span&gt;     &lt;span class="m"&gt;6.7584&lt;/span&gt;  &lt;span class="m"&gt;-2.601&lt;/span&gt;   &lt;span class="m"&gt;0.0123&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;speed         &lt;span class="m"&gt;3.9324&lt;/span&gt;     &lt;span class="m"&gt;0.4155&lt;/span&gt;   &lt;span class="m"&gt;9.464&lt;/span&gt; &lt;span class="m"&gt;1.49e-12&lt;/span&gt; &lt;span class="o"&gt;***&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;span class="o"&gt;---&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;Signif. codes&lt;span class="o"&gt;:&lt;/span&gt;  &lt;span class="m"&gt;0&lt;/span&gt; ‘&lt;span class="o"&gt;***&lt;/span&gt;’ &lt;span class="m"&gt;0.001&lt;/span&gt; ‘&lt;span class="o"&gt;**&lt;/span&gt;’ &lt;span class="m"&gt;0.01&lt;/span&gt; ‘&lt;span class="o"&gt;*&lt;/span&gt;’ &lt;span class="m"&gt;0.05&lt;/span&gt; ‘&lt;span class="m"&gt;.&lt;/span&gt;’ &lt;span class="m"&gt;0.1&lt;/span&gt; ‘ ’ &lt;span class="m"&gt;1&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;Residual standard error&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="m"&gt;15.38&lt;/span&gt; on &lt;span class="m"&gt;48&lt;/span&gt; degrees of freedom&lt;/span&gt;
&lt;span class="code-line"&gt;Multiple R&lt;span class="o"&gt;-&lt;/span&gt;squared&lt;span class="o"&gt;:&lt;/span&gt;  &lt;span class="m"&gt;0.6511&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;    Adjusted R&lt;span class="o"&gt;-&lt;/span&gt;squared&lt;span class="o"&gt;:&lt;/span&gt;  &lt;span class="m"&gt;0.6438&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;span class="bp"&gt;F&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;statistic&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="m"&gt;89.57&lt;/span&gt; on &lt;span class="m"&gt;1&lt;/span&gt; and &lt;span class="m"&gt;48&lt;/span&gt; DF&lt;span class="p"&gt;,&lt;/span&gt;  p&lt;span class="o"&gt;-&lt;/span&gt;value&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="m"&gt;1.49e-12&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; plot&lt;span class="p"&gt;(&lt;/span&gt;dist &lt;span class="o"&gt;~&lt;/span&gt; speed&lt;span class="p"&gt;,&lt;/span&gt; pch&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;4&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="c1"&gt;# 画出散点图&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; abline&lt;span class="p"&gt;(&lt;/span&gt;lingre&lt;span class="p"&gt;,&lt;/span&gt; col&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;red&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="c1"&gt;# 添加拟合直线&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="kn"&gt;detach&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;cars&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="c1"&gt;# 使用完记得释放&lt;/span&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;从这里可以得到回归方程：&lt;span class="math"&gt;\(\hat{dist} = -17.5791 + 3.9324 \times speed\)&lt;/span&gt;。（对于其它的结果是什么意思，可以去查看线性回归的相关书籍）&lt;/p&gt;
&lt;p&gt;另外，得到拟合直线的图像：&lt;/p&gt;
&lt;p&gt;&lt;img alt="lingre_one" src="\images\article\a16\lingre_one.jpg"&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;h4&gt;三、多元线性回归&lt;/h4&gt;
&lt;hr&gt;
&lt;p&gt;对于多元线性回归来说，其计算方式与一元线性回归类似，区别在于，多元的时候需要利用矩阵来处理。首先看一下回归模型：&lt;/p&gt;
&lt;div class="math"&gt;$$ y = \beta_0 + \beta_1 x_1 + \beta_2 x_2 + \dots + \beta_p x_p + \varepsilon $$&lt;/div&gt;
&lt;p&gt;其中 &lt;span class="math"&gt;\(p\)&lt;/span&gt; 代表自变量的个数。&lt;/p&gt;
&lt;p&gt;若取 &lt;span class="math"&gt;\(x^T_0=[1, 1, \dots, 1]_{1 \times n}\)&lt;/span&gt;，则可将上述模型改写成：&lt;span class="math"&gt;\(y=X\beta+\varepsilon\)&lt;/span&gt;。其中：&lt;/p&gt;
&lt;div class="math"&gt;$$y^T=[y_1,y_2,\dots,y_n], X=[x_0,x_1,\dots,x_p], \beta^T=[\beta_0,\beta_1,\dots,\beta_p], \varepsilon^T=[\varepsilon_1,\varepsilon_2,\dots,\varepsilon_n]$$&lt;/div&gt;
&lt;p&gt;其中 &lt;span class="math"&gt;\(x^T_i=[x_{1i},x_{2i},\dots,x_{ni}]\)&lt;/span&gt;。&lt;/p&gt;
&lt;p&gt;这样我们就可以将离差平方和 &lt;span class="math"&gt;\(\sum_{i=1}^{n}{(y_i-\beta_0 + \beta_1 x_1 + \beta_2 x_2 + \dots + \beta_p x_p)^2}\)&lt;/span&gt; 写成矩阵形式：&lt;/p&gt;
&lt;div class="math"&gt;$$(y-X\beta)^T(y-X\beta)$$&lt;/div&gt;
&lt;p&gt;求导可得：&lt;span class="math"&gt;\(-2X^T(y-X\beta)\)&lt;/span&gt; (这里用到矩阵求导的知识，一般介绍&lt;strong&gt;线性模型&lt;/strong&gt;的书籍中会讲到；当然也可以直接对上面不是矩阵形式的离差平和求导)。令其等于0，可得：&lt;/p&gt;
&lt;div class="math"&gt;$$\hat{\beta} = (X^TX)^{-1}X^Ty$$&lt;/div&gt;
&lt;hr&gt;
&lt;h5&gt;R语言实现&lt;/h5&gt;
&lt;hr&gt;
&lt;p&gt;对于R语言的实现，依旧使用&lt;code&gt;lm&lt;/code&gt;函数：&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="code-line"&gt;&lt;span&gt;&lt;/span&gt;lingre_mul &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; lm&lt;span class="p"&gt;(&lt;/span&gt;y &lt;span class="o"&gt;~&lt;/span&gt; x1 &lt;span class="o"&gt;+&lt;/span&gt; x2&lt;span class="p"&gt;,&lt;/span&gt; data&lt;span class="o"&gt;=&lt;/span&gt;datasets&lt;span class="p"&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span class="code-line"&gt;&lt;span class="kp"&gt;summary&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;lingre_mul&lt;span class="p"&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;这里就不再用实际数据去演示了。&lt;/p&gt;
&lt;hr&gt;
&lt;h4&gt;四、最后&lt;/h4&gt;
&lt;hr&gt;
&lt;p&gt;至此，就把线性回归的基础内容介绍完了。但其实线性回归还存在很多其它的问题。比如说回归诊断（就是检查回归的效果），变量选择等等等等。感兴趣的话，可以找本讲线性回归的书看看，有很多！&lt;/p&gt;
&lt;script type="text/javascript"&gt;if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var align = "center",
        indent = "0em",
        linebreak = "false";

    if (false) {
        align = (screen.width &lt; 768) ? "left" : align;
        indent = (screen.width &lt; 768) ? "0em" : indent;
        linebreak = (screen.width &lt; 768) ? 'true' : linebreak;
    }

    var mathjaxscript = document.createElement('script');
    var location_protocol = (false) ? 'https' : document.location.protocol;
    if (location_protocol !== 'http' &amp;&amp; location_protocol !== 'https') location_protocol = 'https:';
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = location_protocol + '//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML';
    mathjaxscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: '"+ align +"'," +
        "    displayIndent: '"+ indent +"'," +
        "    showMathMenu: true," +
        "    messageStyle: 'normal'," +
        "    tex2jax: { " +
        "        inlineMath: [ ['\\\\(','\\\\)'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'inherit ! important'} }," +
        "        linebreaks: { automatic: "+ linebreak +", width: '90% container' }," +
        "    }, " +
        "}); " +
        "if ('default' !== 'default') {" +
            "MathJax.Hub.Register.StartupHook('HTML-CSS Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax['HTML-CSS'].FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
            "MathJax.Hub.Register.StartupHook('SVG Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax.SVG.FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
        "}";
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
&lt;/script&gt;</content><category term="data science"></category><category term="r"></category><category term="machine learning"></category><category term="regression"></category></entry><entry><title>数据科学之机器学习1：简介</title><link href="//jacky-sj/data-science-introduction-to-machine-learning.html" rel="alternate"></link><published>2014-03-30T16:39:00+08:00</published><updated>2017-03-29T20:30:00+08:00</updated><author><name>Jacky Gong</name></author><id>tag:jacky-sj,2014-03-30:/data-science-introduction-to-machine-learning.html</id><summary type="html">&lt;p&gt;简单说说机器学习&lt;/p&gt;</summary><content type="html">&lt;p&gt;&lt;em&gt;“文章原创，转载请注明出处”&lt;/em&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;上一篇“&lt;a href="http://jackycode.github.io/blog/2014/03/27/an-introduction-to-data-science/"&gt;数据科学简介&lt;/a&gt;”简单地说了一下数据科学是什么，以及它包罗的东西。这一篇打算简单介绍一下&lt;strong&gt;机器学习&lt;/strong&gt;，并理一理机器学习中涉及的内容。&lt;/p&gt;
&lt;hr&gt;
&lt;h4&gt;机器学习的定义&lt;/h4&gt;
&lt;hr&gt;
&lt;p&gt;一般来说，教科书介绍一样东西，首先会给它下一个确切的定义。不过，对于机器学习的定义，我还真不知道该怎么去下。有太多的版本，太多的述说方式，不知道用哪个好。这里就列举一些我觉得有代表性的，讲的容易懂的那些定义。对于机器学习是什么，看看这些定义，应该就能够有个大致的了解了。&lt;/p&gt;
&lt;p&gt;首先，在“&lt;a href="http://www.amazon.cn/Machine-Learning-The-Art-and-Science-of-Algorithms-That-Make-Sense-of-Data-Flach-Peter/dp/1107422221/ref=tmm_pap_title_0"&gt;Machine Learning: the art and science of algorithms that make sense of data&lt;/a&gt;”一书中，有这样一个定义：&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Machine Learning is the systematic study of algorithms and systems that improve their knowledge or performance with experience.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;这个定义说的比较简单直白，就是说，机器学习就是研究如何通过经验(其实就是数据)去改进性能的算法(这个翻译学得不好，见谅！)。我们可以简单这样理解，机器学习就是研究这么一类算法，通过这类算法呢，系统可以从数据中获取信息来提升自己的性能。最简单的说法就是将数据转换成有用的信息。&lt;/p&gt;
&lt;p&gt;在“&lt;a href="http://www.amazon.cn/Machine-Learning-The-Art-and-Science-of-Algorithms-That-Make-Sense-of-Data-Flach-Peter/dp/1107422221/ref=tmm_pap_title_0"&gt;Machine Learning: the art and science of algorithms that make sense of data&lt;/a&gt;”书中，还有这么一句话，将机器学习的流程说的很清楚：&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Machine learning is concerned with using the right features to build the right models that achieve the right task.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;这句话就是说，机器学习关心的就是：如何通过对特征(数据)建立模型去完成一些任务。在Andrew Ng的机器学习视频中，还列出了Tom Mitchell给出的定义，与上面的说法有些相近：&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;A computer program is said to learn from experience E with respect to some task T and some performance measure P, if its performance on T, as measured by P, improves with experience E.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;strong&gt;&lt;em&gt;上一篇博文里曾说，数据科学是统计、计算机科学以及专业知识的结合。而其实，机器学习就是统计与计算机科学的结合。正因如此，机器学习是数据科学的核心。&lt;/em&gt;&lt;/strong&gt;简单来说，机器学习就是：研究让机器通过学习过去的经验，达到提高处理相同任务能力的算法。&lt;/p&gt;
&lt;hr&gt;
&lt;h4&gt;机器学习的类别&lt;/h4&gt;
&lt;hr&gt;
&lt;p&gt;机器学习大致可以分为两类：监督学习(supervised learning)和无监督学习(unsupervised learning)。&lt;/p&gt;
&lt;p&gt;如何区分呢？&lt;strong&gt;区别就在于，测试数据有没有给出确切的类别或者结果。若给出了就是监督学习，若没有则是无监督学习&lt;/strong&gt;。&lt;/p&gt;
&lt;p&gt;比如说回归：其给定的测试样本中，一组自变量的值肯定对应一个确定的因变量的值；再说分类：对于给出的测试样本中的每一个数据，其都会有自己所属的类别。所以回归与分类就属于监督学习的范畴，也就是可以通过既定的数据去做预测。&lt;/p&gt;
&lt;p&gt;而无监督学习不同，其给出的数据不存在任何其它信息，比方说聚类，给你一批数据，没有任何信息，让你把数据分成几个类别。一般来说，这时候就需要计算数据之间的相似度(距离)，然后把距离近的归位一类。&lt;/p&gt;
&lt;hr&gt;
&lt;h4&gt;最后&lt;/h4&gt;
&lt;hr&gt;
&lt;p&gt;到这里，基本上来说，机器学习是干什么的应该有了一些了解了。至于机器学习的分类，监督学习和无监督学习还不明白也不要紧。等弄明白了回归，分类以及聚类等等的是干什么的，自然就明白这两者之间的区别了。&lt;/p&gt;</content><category term="data science"></category><category term="r"></category><category term="machine learning"></category></entry><entry><title>数据科学简介</title><link href="//jacky-sj/an-introduction-to-data-science.html" rel="alternate"></link><published>2014-03-27T14:39:00+08:00</published><updated>2017-03-29T20:30:00+08:00</updated><author><name>Jacky Gong</name></author><id>tag:jacky-sj,2014-03-27:/an-introduction-to-data-science.html</id><summary type="html">&lt;p&gt;数据科学简介&lt;/p&gt;</summary><content type="html">&lt;p&gt;&lt;em&gt;“文章原创，转载请注明出处”&lt;/em&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;对于这两年渐渐兴起的大数据，云计算之类的技术，相信没有人会陌生。即便不知道这个东西是什么，但也是应该听得耳朵起茧子了。归结原因呢，出现这些技术实在是因为现在的数据越来越多，以前的很多数据分析技术越来越不合适。即便是简单的最小二乘线性回归，直接放到大数据上用，跑起来也是够累的。这时候，各种处理大数据的技术就纷纷崛起了，和之前的云计算相同的就是，大数据也改变了计算机原本的使用方式。&lt;/p&gt;
&lt;p&gt;OK，说说数据科学吧。数据科学，Data Science，这个玩意儿最早有一本书，叫做“What is Data Science”，O'Reilly出版的（不得不说其出版了太多太牛太厉害的书籍材料，牛得不需要解释）。数据科学就像是一个综合体，包罗的东西非常多，大致有三个方面。&lt;/p&gt;
&lt;h5&gt;第一，概率统计（数学）&lt;/h5&gt;
&lt;p&gt;这个提供了大数据的很多理论基础。大数据的处理技术，需要用到非常之多的概率统计学知识。而要想学好概率统计，那你数学得先学学好才行。简单罗列一下：概率论基础，统计学基础，高等概率论，测度论，高等参数统计，随机过程等等等等。这些内容都是理论基础，要是理论学的不咋样，估计折腾大数据也就是玩玩工具，弄点儿结果出来。话说，如果真没学好理论，能不能把结果解释清楚还需要质疑，更何况自己去设计改进一个技术算法呢。&lt;/p&gt;
&lt;p&gt;嗯，说到这，回过头去看看泛函分析吧~&lt;/p&gt;
&lt;h5&gt;第二，计算机科学&lt;/h5&gt;
&lt;p&gt;这个就提供了大数据处理的工具平台了。那么多的数据，你就是理论学得再牛，没有计算机，你自己手算试试！你说你要处理数据，OK，计算机提供了工具平台，那么你就得学习如何运用这些系统环境吧，那么就得学习&lt;strong&gt;分布式计算机系统环境&lt;/strong&gt;，这个主流的有：Hadoop(鼎鼎大名吧); Spark(也听说过吧); Cassandra等等。&lt;/p&gt;
&lt;p&gt;好了，环境搞明白了，下面你就得发号施令，让计算机去处理数据了。计算可不是人类，你可以跟他讲普通话，讲英文让他帮你干活。你要想它听你的，你得先学会点它能懂的、能听明白的话。OK，编程语言就降临了。一般来说，用于数据处理的语言有R，Python，Octave（与Matlab类似，只是这个开源免费），Matlab等等。为了使用各个平台，说不得你也得学点Java，C，C++。&lt;/p&gt;
&lt;p&gt;写到这边，估计已经头大了，这么多东西，这数据科学是不是恐怖了点，谁能受得了啊！！！是的，包含的东西的确多了点，但是学习起来还是很好玩的，我保证(当然，前提你得跟我一样，看见数学不会头晕)！&lt;/p&gt;
&lt;p&gt;当然除了上面提到的，数据科学包含的计算机知识还有很多，像数据结构啊，数据库啊，Mahout这样的架构啊等等。&lt;/p&gt;
&lt;h5&gt;第三，专业&lt;/h5&gt;
&lt;p&gt;这个也就是应用啦。练就了一身绝世内功（理论基础），找到了一把趁手的绝世神兵（计算机科学），现在需要决定的就是出山之后是想做个武林盟主呢，还是独创一个门派，也就是想把这些东西用到哪些地方去。像生物学，跟统计一结合就成了生物统计，要是再加上点计算机科学，那就成了生物学数据科学。OK，这么说应该是很明白的了。&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;数据科学家Drew Conway绘制过一幅图，很好地描述了我上面所说的东西：&lt;/p&gt;
&lt;p&gt;&lt;img alt="Venn diagram" src="/images/article/drew-conway-data-science-venn-diagram.jpg"&gt;&lt;/p&gt;
&lt;p&gt;前几天图灵上出了一本书，叫做“&lt;a href="http://www.ituring.com.cn/book/1268"&gt;Software Design 中文版 01&lt;/a&gt;”。里面介绍了数据科学的很多基础内容，也给出了很多的学习材料，大部分都是网上的视频教程。此外书中还介绍了一些如何使用Excel，R以及Mahout这些工具的基础知识，有兴趣倒是可以入手一本，作为学习数据科学的开始。&lt;/p&gt;</content><category term="data science"></category><category term="r"></category><category term="machine learning"></category></entry></feed>